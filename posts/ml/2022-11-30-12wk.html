<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.527">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2022-11-30">

<title>Seoyeon’s Blog for classes - RNN (12주차)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Seoyeon’s Blog for classes</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://seoyeonc.github.io/sy_hub/"> 
<span class="menu-text">Main_Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc/md/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/ml_basic/index.html">Posts</a></li><li class="breadcrumb-item"><a href="../../posts/ml/index.html">Special Topics in Machine Learning</a></li><li class="breadcrumb-item"><a href="../../posts/ml/2022-11-30-12wk.html">RNN (12주차)</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../posts/ml_basic/index.html">Posts</a></li><li class="breadcrumb-item"><a href="../../posts/ml/index.html">Special Topics in Machine Learning</a></li><li class="breadcrumb-item"><a href="../../posts/ml/2022-11-30-12wk.html">RNN (12주차)</a></li></ol></nav>
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">RNN (12주차)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Special Topics in Machine Learning</div>
                <div class="quarto-category">순환신경망</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 30, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Posts</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ml_basic/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Machine Learning basic</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-03-23-Support Vector Machine.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Support Vector Machine</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-03-28-Linear Regression, Logistic Regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-03-28-Principal Component Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal Component Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-03-29-Lasso and Ridge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lasso and Ridge</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-03-31-Ridge Regression_note3_0331.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ridge Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-04-02-Ensemble and Random Forest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ensemble and Random Forest</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-04-09-Clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-05-09-EM_algorithm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expectation Maximization(EM algorithm)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-05-20-Manifold learning Embedding.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Manifold learning Embedding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-05-28-Attention Mechanism.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Attention Mechanism</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-05-28-Sequence-to-Sequence, seq2seq.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Sequence-to-Sequence, seq2seq</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-05-28-Transformer Chatbot Tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformer Chatbot Tutorial</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-05-28-Transformers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Transformers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml_basic/2023-06-15-Laplace.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Laplace Distribution</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/rl/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Regression Analysis</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-09-21-rl_CH03, CH04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">고급회귀분석 실습 CH03, CH04</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-09-21-rl_HW1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression HW 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-10-23-rl-HW2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression HW 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-14-rl_CH06, CH07.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">고급회귀분석 실습 CH06, CH07</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-21-rl-HW3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression HW 3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-23-rl-CH10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">고급회귀분석 실습 CH10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-28-rl-CH13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">고급회귀분석 실습 CH13</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-12-05-rl-CH11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">고급회귀분석 실습 CH11</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-12-08-rl-HW4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression HW 4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-12-11-rl-Ch10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">고급회귀분석 CH10</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2023-02-22-rl-mid_term.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Regression Analysis Mid Term</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2023-02-23-rl-final_term.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Regression Analysis Final Term</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2023-03-02-graduation_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Regression Analysis GT</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ml/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Special Topics in Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-07-ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-07-ml_1w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNN (1주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-14-ml_2w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNN (2주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-19-Assignment-1-Copy1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-21-ml_3w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNN (3주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-29-ml_4w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNN (4주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-05-ml-5w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNN (5주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-05-ml-HW.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Homework</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-12-ml-6w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DNN (6주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-19-ml_7w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CNN (7주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-26-ml_8w_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CNN (8주차) 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-26-ml_8w_2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CNN (8주차) 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-02-ml_9w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN (9주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-02-ml-midterm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Midterm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-09-ml-10w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN (10주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-21-ml-11w.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN (11주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-29-13wk-2-final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep Learning final example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-30-12wk.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">RNN (12주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-07-13wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A1: 깊은복사와 얕은복사 (12주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-08-13wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RNN (13주차)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-13-final_seoyeon.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Finalterm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-14-study.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">study</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-21-Extra-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra-1: 추천시스템</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-21-Extra-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra-2: 생성모형(GAN)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-23-Extra-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra-3: 딥러닝의 기초 (5)</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ap/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced Probability Theory</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-07-1wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01wk-2: 강의소개</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-07-ap_1wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1주차: 측도론</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-09-2wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02wk-1: 측도론 intro (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-14-2wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02wk-2: 측도론 intro (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-14-ap-02wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02wk: 측도론 intro (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-16-3wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03wk-1: 측도론 intro (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-21-3wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03wk-2: 측도론 intro (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-21-ap-03wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03wk: 측도론 intro (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-23-4wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04wk-1: 측도론 intro (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-28-4wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04wk-2: 측도론 intro (6)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-28-ap-04wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04wk: 측도론 intro (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-29-5wk-2-hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05wk-2: HW1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-30-5wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05wk-1: 마코프체인 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-05-ap-05wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05wk: 측도론 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-10-6wk-2-mid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06wk-2: 중간고사</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-11-ap-06wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06wk: 측도론 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-13-7wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07wk-1: 마코프체인 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-13-7wk-2.out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07wk-2: 마코프체인 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-18-ap-07wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7wk: 측도론 (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-20-8wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08wk-1: 마코프체인 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-25-8wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08wk-2: 마코프체인 (5)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-25-ap-08wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08wk: 측도론 (4)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-04-27-9wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09wk-1: 마코프체인 (6)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-02-ap-09wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09wk: 확률변수</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-09-10wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10wk-2: 마코프체인 (7)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-09-ap-10wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10wk: 분포, 분포함수</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-11-11wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11wk-1: 마코프체인 (8)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-16-11wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11wk-2: 마코프체인 (9)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-16-ap-11wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11wk: 적분 (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-18-12wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12wk-1: 마코프체인 (10)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-23-12wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12wk-2: 마코프체인 (11)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-23-ap-12wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12wk: 적분 (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-25-13wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13wk-1: 마코프체인 (12)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-30-13wk-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13wk-2: MCMC (1)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-05-30-ap-13wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13wk: 밀도함수</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-06-01-14wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14wk-1,2: MCMC (2)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-06-06-ap-14wk.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14wk: 이산형과 연속형의 통합</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-06-08-15wk-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15wk-1: MCMC (3)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-06-13-fin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15wk: 기말고사</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-06-20-15wk-2-fin.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15wk-2: 기말고사</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/anything/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Anything</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-04-17-Survival_Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-04-20-hazard_ratio,odds_ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hazard ratio, Odds ratio</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-04-27-Clinical Trial Data and Survival Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clinical Trial Data and Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-05-04-questions of pytorch geometric temporal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Questions of PyTorch Geometric Temporal</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-06-01-Survival_R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Survival Analysis Tutorial with R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-06-12-post_hoc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Post Hoc Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-06-12-Steady State.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Steady State</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-06-15-PK Analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pharmacokinetic Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-11-15-DV2023-09wk-1-mid.out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">STBDA2023 09wk-1: 중간고사_sy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/2023-12-07_any_tip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">정리</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/A1.out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A1: 강화학습 (1) – bandit</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/A2.out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A2: 강화학습 (2) – 4x4 grid</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/anything/A3.out.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">A3: 강화학습 (3) – LunarLander</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/as/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Special Topics in Applied Statistics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/as/2023-07-30-multicollinearity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multicollinearity</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ct/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coding Test</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-01-Coding_Test_Greedy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 03 Greedy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-15-Coding_Test_Algorithm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-15-Coding_Test_interfunction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">내장함수</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-21-Coding_Test_Q1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">성격 유형 검사하기(Done)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-23-Coding_Test_Q2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">두 큐 합 같게 만들기(Done)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-30-Coding_Test_Q3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">코딩 테스트 공부(Done)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-02-12-Coding_Test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ArrayList &amp; LinkedList</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-03-05-Coding_Test_Stack.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stack</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-03-12-Coding_Test_Queue.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Queue</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-03-22-Coding_Test_Tree.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tree</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-08-26-Coding_Test_pp_hw.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>[Coding Test]</strong>Python Programming HW review</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ts/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2022-12-31-ts_1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">확률변수와 확률분포</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-05-ts_HW1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-05-ts_HW2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-05-ts_HW3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-09-ts_HW4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW4</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-12-ts_HW5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-14-ts_HW6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW6</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-14-ts_Mid term.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics Mid term</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-18-ts_HW7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW7</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-18-ts-HW8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW8</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-21-ts-HW9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics HW9</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-25-ts-final term.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics Final term</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-03-03-graduation_test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics GT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-03-03-ts-final_qanda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theoritical Statistics Final term 6 Explanation</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imports" id="toc-imports" class="nav-link active" data-scroll-target="#imports">imports</a></li>
  <li><a href="#define-some-funtions" id="toc-define-some-funtions" class="nav-link" data-scroll-target="#define-some-funtions">Define some funtions</a></li>
  <li><a href="#순환신경망-표현력-비교실험-1" id="toc-순환신경망-표현력-비교실험-1" class="nav-link" data-scroll-target="#순환신경망-표현력-비교실험-1">순환신경망 표현력 비교실험 (1)</a>
  <ul class="collapse">
  <li><a href="#data-abcabc" id="toc-data-abcabc" class="nav-link" data-scroll-target="#data-abcabc">data: abcabC</a></li>
  <li><a href="#실험" id="toc-실험" class="nav-link" data-scroll-target="#실험">실험</a></li>
  <li><a href="#결론" id="toc-결론" class="nav-link" data-scroll-target="#결론">결론</a></li>
  </ul></li>
  <li><a href="#순환신경망-표현력-비교실험-2" id="toc-순환신경망-표현력-비교실험-2" class="nav-link" data-scroll-target="#순환신경망-표현력-비교실험-2">순환신경망 표현력 비교실험 (2)</a>
  <ul class="collapse">
  <li><a href="#data-abcc" id="toc-data-abcc" class="nav-link" data-scroll-target="#data-abcc">data: ab(c,C)</a></li>
  <li><a href="#실험-1" id="toc-실험-1" class="nav-link" data-scroll-target="#실험-1">실험</a></li>
  <li><a href="#결론-1" id="toc-결론-1" class="nav-link" data-scroll-target="#결론-1">결론</a></li>
  </ul></li>
  <li><a href="#문자열에서-단어로" id="toc-문자열에서-단어로" class="nav-link" data-scroll-target="#문자열에서-단어로">문자열에서 단어로</a>
  <ul class="collapse">
  <li><a href="#data-human-numbers-5" id="toc-data-human-numbers-5" class="nav-link" data-scroll-target="#data-human-numbers-5">data: human numbers 5</a></li>
  <li><a href="#torch를-이용한-learn" id="toc-torch를-이용한-learn" class="nav-link" data-scroll-target="#torch를-이용한-learn">torch를 이용한 learn</a></li>
  <li><a href="#fastai-이용한-learn" id="toc-fastai-이용한-learn" class="nav-link" data-scroll-target="#fastai-이용한-learn">fastai 이용한 learn</a></li>
  </ul></li>
  <li><a href="#똑같은-코드들-torch.nn.lstm" id="toc-똑같은-코드들-torch.nn.lstm" class="nav-link" data-scroll-target="#똑같은-코드들-torch.nn.lstm">똑같은 코드들: <code>torch.nn.LSTM</code></a>
  <ul class="collapse">
  <li><a href="#data-hihello" id="toc-data-hihello" class="nav-link" data-scroll-target="#data-hihello">data: hi?hello!!</a></li>
  <li><a href="#세트1-_water의-생략" id="toc-세트1-_water의-생략" class="nav-link" data-scroll-target="#세트1-_water의-생략">세트1: _water의 생략</a></li>
  <li><a href="#세트2-x.shape-l-h_in-or-lnh_in" id="toc-세트2-x.shape-l-h_in-or-lnh_in" class="nav-link" data-scroll-target="#세트2-x.shape-l-h_in-or-lnh_in">세트2: x.shape = (<span class="math inline">\(L\)</span>, <span class="math inline">\(H_{in}\)</span>) or (<span class="math inline">\(L\)</span>,<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>)</a></li>
  <li><a href="#세트3-hidden.shape-dtimes-num_layers-h_out-or-dtimes-num_layers-n-h_out" id="toc-세트3-hidden.shape-dtimes-num_layers-h_out-or-dtimes-num_layers-n-h_out" class="nav-link" data-scroll-target="#세트3-hidden.shape-dtimes-num_layers-h_out-or-dtimes-num_layers-n-h_out">세트3: hidden.shape = (<span class="math inline">\(D\times\)</span> <code>num_layers</code>, <span class="math inline">\(H_{out}\)</span>) or (<span class="math inline">\(D\times\)</span> <code>num_layers</code>, <span class="math inline">\(N\)</span>, <span class="math inline">\(H_{out}\)</span>)</a></li>
  </ul></li>
  <li><a href="#똑같은-코드들-torch.nn.lstmcell" id="toc-똑같은-코드들-torch.nn.lstmcell" class="nav-link" data-scroll-target="#똑같은-코드들-torch.nn.lstmcell">똑같은 코드들: <code>torch.nn.LSTMCell</code></a>
  <ul class="collapse">
  <li><a href="#data-hihello-1" id="toc-data-hihello-1" class="nav-link" data-scroll-target="#data-hihello-1">data: hi?hello!!</a></li>
  <li><a href="#세트1-_water의-생략-1" id="toc-세트1-_water의-생략-1" class="nav-link" data-scroll-target="#세트1-_water의-생략-1">세트1: _water의 생략</a></li>
  <li><a href="#세트2-xt.shape-nh_in-or-h_in" id="toc-세트2-xt.shape-nh_in-or-h_in" class="nav-link" data-scroll-target="#세트2-xt.shape-nh_in-or-h_in">세트2: xt.shape = (<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>) or (<span class="math inline">\(H_{in}\)</span>)</a></li>
  <li><a href="#세트3-hidden.shape-nh_out-or-h_out" id="toc-세트3-hidden.shape-nh_out-or-h_out" class="nav-link" data-scroll-target="#세트3-hidden.shape-nh_out-or-h_out">세트3: hidden.shape = (<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{out}\)</span>) or (<span class="math inline">\(H_{out}\)</span>)</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a>
  <ul class="collapse">
  <li><a href="#똑같은-코드들-정리" id="toc-똑같은-코드들-정리" class="nav-link" data-scroll-target="#똑같은-코드들-정리">똑같은 코드들 정리</a></li>
  <li><a href="#실제구현시-기억할-것" id="toc-실제구현시-기억할-것" class="nav-link" data-scroll-target="#실제구현시-기억할-것">실제구현시 기억할 것</a></li>
  </ul></li>
  <li><a href="#조각난-시계열로-학습" id="toc-조각난-시계열로-학습" class="nav-link" data-scroll-target="#조각난-시계열로-학습">조각난 시계열로 학습</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data">data</a></li>
  <li><a href="#조각내지-않은-시계열" id="toc-조각내지-않은-시계열" class="nav-link" data-scroll-target="#조각내지-않은-시계열">조각내지 않은 시계열</a></li>
  <li><a href="#조각난-시계열" id="toc-조각난-시계열" class="nav-link" data-scroll-target="#조각난-시계열">조각난 시계열</a></li>
  <li><a href="#재미있는-실험" id="toc-재미있는-실험" class="nav-link" data-scroll-target="#재미있는-실험">재미있는 실험</a></li>
  </ul></li>
  <li><a href="#똑같은-코드들-fastai-pytorch" id="toc-똑같은-코드들-fastai-pytorch" class="nav-link" data-scroll-target="#똑같은-코드들-fastai-pytorch">똑같은 코드들 fastai, pytorch</a>
  <ul class="collapse">
  <li><a href="#data-human-numbers-5-1" id="toc-data-human-numbers-5-1" class="nav-link" data-scroll-target="#data-human-numbers-5-1">data: human numbers 5</a></li>
  <li><a href="#fastai-이용한-learn-1" id="toc-fastai-이용한-learn-1" class="nav-link" data-scroll-target="#fastai-이용한-learn-1">fastai 이용한 learn</a></li>
  <li><a href="#torch를-이용한-learn-1" id="toc-torch를-이용한-learn-1" class="nav-link" data-scroll-target="#torch를-이용한-learn-1">torch를 이용한 learn</a></li>
  </ul></li>
  <li><a href="#human-numbers-100" id="toc-human-numbers-100" class="nav-link" data-scroll-target="#human-numbers-100">human numbers 100</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="2022-11-30-12wk.out.ipynb" download="2022-11-30-12wk.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<blockquote class="blockquote">
<p>순환신경망 minor topics</p>
</blockquote>
<section id="imports" class="level1">
<h1>imports</h1>
<div id="9969a523-ecdb-4c98-b350-ddb7eaa59275" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> torch</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.text.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pytorch_lightning <span class="im">as</span> pl </span></code></pre></div>
</div>
</section>
<section id="define-some-funtions" class="level1">
<h1>Define some funtions</h1>
<div id="4119bcda-f466-40ea-bfec-4dda98f067a5" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(txt,mapping):</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [mapping[key] <span class="cf">for</span> key <span class="kw">in</span> txt] </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>sig <span class="op">=</span> torch.nn.Sigmoid()</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>soft <span class="op">=</span> torch.nn.Softmax(dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>tanh <span class="op">=</span> torch.nn.Tanh()</span></code></pre></div>
</div>
</section>
<section id="순환신경망-표현력-비교실험-1" class="level1">
<h1>순환신경망 표현력 비교실험 (1)</h1>
<section id="data-abcabc" class="level2">
<h2 class="anchored" data-anchor-id="data-abcabc">data: abcabC</h2>
<div id="89e22504-8cb9-4d99-84a0-2403d5f8bf45" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> <span class="bu">list</span>(<span class="st">'abcabC'</span>)<span class="op">*</span><span class="dv">100</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>txt[:<span class="dv">8</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:]</span></code></pre></div>
</div>
<div id="8ec07eed-9ee0-4f5d-b82c-d3b1f221cc6d" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'a'</span>:<span class="dv">0</span>,<span class="st">'b'</span>:<span class="dv">1</span>,<span class="st">'c'</span>:<span class="dv">2</span>,<span class="st">'C'</span>:<span class="dv">3</span>} </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>()</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>()</span></code></pre></div>
</div>
<div id="6f37b080-7950-4a8c-9337-91a55a2fbcc2" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x.to(<span class="st">"cuda:0"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y.to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
<div id="5f86ca66-c7d4-427c-9ee8-c777cde934f3" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>torch.Size([599, 4])</code></pre>
</div>
</div>
</section>
<section id="실험" class="level2">
<h2 class="anchored" data-anchor-id="실험">실험</h2>
<p><code>-</code> 실험1</p>
<div id="6484537f-a7be-4fa7-8022-a539fb36ffb4" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>HIDDEN <span class="op">=</span> <span class="dv">3</span></span></code></pre></div>
</div>
<div id="03515c3e-e7c9-4d3c-98ab-7ef38705d054" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">5</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        rnn <span class="op">=</span> torch.nn.RNN(<span class="dv">4</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        linr <span class="op">=</span> torch.nn.Linear(HIDDEN,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>        optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(rnn.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 1</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>            hidden, hT <span class="op">=</span> rnn(x,_water)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> linr(hidden)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 2</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output,y)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 3</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 4 </span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            optimizr.step()</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>            optimizr.zero_grad()</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        yhat<span class="op">=</span>soft(output)    </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        combind <span class="op">=</span> torch.concat([hidden,yhat],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        ax[i][j].matshow(combind.to(<span class="st">"cpu"</span>).data[<span class="op">-</span><span class="dv">6</span>:],cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"experiment1: RNN with </span><span class="sc">{}</span><span class="st"> hidden nodes"</span>.<span class="bu">format</span>(HIDDEN),size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> 실험2</p>
<div id="2159b454-bc27-4ca1-b22b-eb02fff1af10" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>HIDDEN <span class="op">=</span> <span class="dv">4</span></span></code></pre></div>
</div>
<div id="2a222286-59e7-45d8-8db0-ba4df9bb37f2" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">5</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>        rnn <span class="op">=</span> torch.nn.RNN(<span class="dv">4</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>        linr <span class="op">=</span> torch.nn.Linear(HIDDEN,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(rnn.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 1</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>            hidden, hT <span class="op">=</span> rnn(x,_water)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> linr(hidden)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 2</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output,y)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 3</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 4 </span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>            optimizr.step()</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>            optimizr.zero_grad()</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>        yhat<span class="op">=</span>soft(output)    </span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>        combind <span class="op">=</span> torch.concat([hidden,yhat],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>        ax[i][j].matshow(combind.to(<span class="st">"cpu"</span>).data[<span class="op">-</span><span class="dv">6</span>:],cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"experiment2: RNN with </span><span class="sc">{}</span><span class="st"> hidden nodes"</span>.<span class="bu">format</span>(HIDDEN),size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> 실험3</p>
<div id="d92218bf-42d6-46ea-afe4-37c60569f54a" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>HIDDEN <span class="op">=</span> <span class="dv">8</span></span></code></pre></div>
</div>
<div id="d5780dfa-acc2-47af-91a7-a234ee005487" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">5</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>        rnn <span class="op">=</span> torch.nn.RNN(<span class="dv">4</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>        linr <span class="op">=</span> torch.nn.Linear(HIDDEN,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(rnn.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 1</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>            hidden, hT <span class="op">=</span> rnn(x,_water)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> linr(hidden)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 2</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output,y)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 3</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 4 </span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>            optimizr.step()</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>            optimizr.zero_grad()</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>        yhat<span class="op">=</span>soft(output)    </span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>        combind <span class="op">=</span> torch.concat([hidden,yhat],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>        ax[i][j].matshow(combind.to(<span class="st">"cpu"</span>).data[<span class="op">-</span><span class="dv">6</span>:],cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"experiment3: RNN with </span><span class="sc">{}</span><span class="st"> hidden nodes"</span>.<span class="bu">format</span>(HIDDEN),size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="결론" class="level2">
<h2 class="anchored" data-anchor-id="결론">결론</h2>
<p><code>-</code> 노드수가 많으면 학습에 유리함</p>
<p>(서연 필기) c/C를 맞추는 것(error)보다 확실한 규칙을 맞추는 것(underline)이 중요<span class="math inline">\(\to\)</span>오히려 맞추면 과적합으로 볼 수 있다 - 그래서 학습이 잘 되었으면 - 첫 칸 - 둘째 칸 - 셋쨰, 넷째 칸 - 이 순으로 predict 되었을 것</p>
</section>
</section>
<section id="순환신경망-표현력-비교실험-2" class="level1">
<h1>순환신경망 표현력 비교실험 (2)</h1>
<section id="data-abcc" class="level2">
<h2 class="anchored" data-anchor-id="data-abcc">data: ab(c,C)</h2>
<div id="d2bbe623-0fa1-429a-a100-00a9a4445216" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># torch.manual_seed(43052)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># txta = 'a'*50</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># txtb = 'b'*50</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># prob_upper = torch.bernoulli(torch.zeros(50)+0.5) </span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># txtc = list(map(lambda x: 'c' if x==1 else 'C', prob_upper))</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># txt = ''.join([txta[i]+','+txtb[i]+','+txtc[i]+',' for i in range(50)]).split(',')[:-1]</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># txt_x = txt[:-1] </span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># txt_y = txt[1:]</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="co"># pd.DataFrame({'txt_x':txt_x,'txt_y':txt_y}).to_csv("2022-11-25-ab(c,C).csv",index=False)</span></span></code></pre></div>
</div>
<div id="dad38eb6-ecc4-4a2f-b105-a54e790a4ff4" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span> pd.read_csv(<span class="st">"https://raw.githubusercontent.com/guebin/DL2022/main/posts/IV.%20RNN/2022-11-25-ab(c%2CC).csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">txt_x</th>
<th data-quarto-table-cell-role="th">txt_y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>b</td>
<td>c</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>c</td>
<td>a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>a</td>
<td>b</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>b</td>
<td>c</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">144</td>
<td>a</td>
<td>b</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">145</td>
<td>b</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">146</td>
<td>C</td>
<td>a</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">147</td>
<td>a</td>
<td>b</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">148</td>
<td>b</td>
<td>c</td>
</tr>
</tbody>
</table>

<p>149 rows × 2 columns</p>
</div>
</div>
</div>
<div id="5e47b82a-13b5-4ac6-a81b-399cc40d0b69" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'a'</span>:<span class="dv">0</span>,<span class="st">'b'</span>:<span class="dv">1</span>,<span class="st">'c'</span>:<span class="dv">2</span>,<span class="st">'C'</span>:<span class="dv">3</span>} </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(df.txt_x,mapping))).<span class="bu">float</span>()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(df.txt_y,mapping))).<span class="bu">float</span>()</span></code></pre></div>
</div>
<div id="0fa77ca9-cd88-4300-8e5c-9d512abf0ca8" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x.to(<span class="st">"cuda:0"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> y.to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
</section>
<section id="실험-1" class="level2">
<h2 class="anchored" data-anchor-id="실험-1">실험</h2>
<p><code>-</code> 실험1</p>
<div id="eef9d7c2-d8b1-41f6-981d-2d884c3bb249" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>HIDDEN <span class="op">=</span> <span class="dv">3</span></span></code></pre></div>
</div>
<div id="38cf3429-8be3-4bbb-9451-5926366044f5" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">5</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>        lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>        linr <span class="op">=</span> torch.nn.Linear(HIDDEN,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>        loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>        optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 1</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            hidden, (hT,cT) <span class="op">=</span> lstm(x,(_water,_water))</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> linr(hidden)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 2</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output,y)</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 3</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 4 </span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            optimizr.step()</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>            optimizr.zero_grad()</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>        yhat<span class="op">=</span>soft(output)    </span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>        combinded <span class="op">=</span> torch.concat([yhat,y],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>        ax[i][j].matshow(combinded.to(<span class="st">"cpu"</span>).data[<span class="op">-</span><span class="dv">6</span>:],cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"experiment1: LSTM with </span><span class="sc">{}</span><span class="st"> hidden nodes"</span>.<span class="bu">format</span>(HIDDEN),size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-19-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> 실험2</p>
<div id="5e9619a9-b5de-4a54-914d-adc19903c1d2" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>HIDDEN <span class="op">=</span> <span class="dv">16</span></span></code></pre></div>
</div>
<div id="3ef2ef52-5450-425a-93c4-4f97e6534dbb" class="cell" data-tags="[]" data-execution_count="95">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">5</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">10</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        linr <span class="op">=</span> torch.nn.Linear(HIDDEN,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,HIDDEN).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 1</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>            hidden, (hT,cT) <span class="op">=</span> lstm(x,(_water,_water))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            output <span class="op">=</span> linr(hidden)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 2</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>            loss <span class="op">=</span> loss_fn(output,y)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 3</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            loss.backward()</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>            <span class="co">## 4 </span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>            optimizr.step()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>            optimizr.zero_grad()</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        yhat<span class="op">=</span>soft(output)    </span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        combinded <span class="op">=</span> torch.concat([yhat,y],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>        ax[i][j].matshow(combinded.to(<span class="st">"cpu"</span>).data[<span class="op">-</span><span class="dv">6</span>:],cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">"experiment2: LSTM with </span><span class="sc">{}</span><span class="st"> hidden nodes"</span>.<span class="bu">format</span>(HIDDEN),size<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="결론-1" class="level2">
<h2 class="anchored" data-anchor-id="결론-1">결론</h2>
<p><code>-</code> 노드수가 너무 많으면 오버피팅 경향도 있음</p>
</section>
</section>
<section id="문자열에서-단어로" class="level1">
<h1>문자열에서 단어로</h1>
<section id="data-human-numbers-5" class="level2">
<h2 class="anchored" data-anchor-id="data-human-numbers-5">data: human numbers 5</h2>
<div id="975afdbd-b316-4d57-9687-06d3f7862944" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ([<span class="st">'one'</span>,<span class="st">','</span>,<span class="st">'two'</span>,<span class="st">','</span>,<span class="st">'three'</span>,<span class="st">','</span>,<span class="st">'four'</span>,<span class="st">','</span>,<span class="st">'five'</span>,<span class="st">','</span>]<span class="op">*</span><span class="dv">100</span>)[:<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
</div>
<div id="349dc2e3-cfcb-4646-a058-7a349489e026" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">','</span>:<span class="dv">0</span>, <span class="st">'one'</span>:<span class="dv">1</span>, <span class="st">'two'</span>:<span class="dv">2</span>, <span class="st">'three'</span>:<span class="dv">3</span>, <span class="st">'four'</span>:<span class="dv">4</span>, <span class="st">'five'</span>:<span class="dv">5</span>} </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mapping</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>{',': 0, 'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5}</code></pre>
</div>
</div>
<div id="188c0571-b8fe-428d-adf8-0ad3d85f959d" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:] </span></code></pre></div>
</div>
<div id="edd93e42-881e-4aa7-8767-1fc3f86838ac" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>txt_x[<span class="dv">0</span>:<span class="dv">5</span>], txt_y[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>(['one', ',', 'two', ',', 'three'], [',', 'two', ',', 'three', ','])</code></pre>
</div>
</div>
<div id="dea37e1c-d622-42ee-8c32-0dcfbadc9431" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
</section>
<section id="torch를-이용한-learn" class="level2">
<h2 class="anchored" data-anchor-id="torch를-이용한-learn">torch를 이용한 learn</h2>
<div id="03031aa1-e93d-4ef2-b9a1-56d41026c904" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">6</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">20</span>,<span class="dv">6</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="899fa92b-8e37-40c1-b8b7-2ab90e8eec15" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>_water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>):</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 1 </span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    hidden, (hT,cT) <span class="op">=</span>lstm(x,(_water,_water))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 2 </span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output,y) </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 3 </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    loss.backward()</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 4 </span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    optimizr.step()</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    optimizr.zero_grad()     </span></code></pre></div>
</div>
<div id="25930fac-28f5-4e33-95e4-13ee7f7f97c3" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(output).data[<span class="op">-</span><span class="dv">10</span>:].to(<span class="st">"cpu"</span>),cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="fastai-이용한-learn" class="level2">
<h2 class="anchored" data-anchor-id="fastai-이용한-learn">fastai 이용한 learn</h2>
<div id="71addc87-3ce3-46a1-8c9c-453e0c97bc4c" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>ds1 <span class="op">=</span> torch.utils.data.TensorDataset(x,y)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ds2 <span class="op">=</span> torch.utils.data.TensorDataset(x,y) <span class="co"># dummy </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>dl1 <span class="op">=</span> torch.utils.data.DataLoader(ds1,batch_size<span class="op">=</span><span class="dv">998</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>dl2 <span class="op">=</span> torch.utils.data.DataLoader(ds2,batch_size<span class="op">=</span><span class="dv">998</span>) <span class="co"># dummy </span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataLoaders(dl1,dl2) </span></code></pre></div>
</div>
<p>fastai 를 이용하여 class를 사용하기 위한 목차</p>
<div id="163c6887-7acc-4277-a8b1-552301ac60c8" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyLSTM(torch.nn.Module):</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">6</span>,<span class="dv">20</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.linr <span class="op">=</span> torch.nn.Linear(<span class="dv">20</span>,<span class="dv">6</span>) </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>,x):</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>        hidden, (hT,cT) <span class="op">=</span><span class="va">self</span>.lstm(x,(_water,_water))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="va">self</span>.linr(hidden)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output         </span></code></pre></div>
</div>
<div id="ed4a1806-eafa-430c-ad11-9acb2f49209e" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> MyLSTM().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span></code></pre></div>
</div>
<div id="c8536f0d-3859-434d-9ec5-1bfd3f2f4bc2" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> Learner(dls,net,loss_fn,lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="7b05d3f2-33bf-4598-a733-82f8b8c27e8f" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">50</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.722138</td>
<td>1.502271</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.611093</td>
<td>1.973368</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.734299</td>
<td>1.481888</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.669271</td>
<td>1.377668</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.608570</td>
<td>1.368541</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.566517</td>
<td>1.267919</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>1.521232</td>
<td>1.106543</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>1.465657</td>
<td>0.959904</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>1.404815</td>
<td>0.856123</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>1.344825</td>
<td>0.802936</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>10</td>
<td>1.290437</td>
<td>0.794831</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>11</td>
<td>1.244395</td>
<td>0.771966</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>12</td>
<td>1.203488</td>
<td>0.735865</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>13</td>
<td>1.165525</td>
<td>0.690032</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>14</td>
<td>1.129149</td>
<td>0.621654</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>15</td>
<td>1.092401</td>
<td>0.555875</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>16</td>
<td>1.055485</td>
<td>0.493046</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>17</td>
<td>1.018588</td>
<td>0.423167</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>18</td>
<td>0.981230</td>
<td>0.349703</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>19</td>
<td>0.943231</td>
<td>0.279531</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>20</td>
<td>0.904838</td>
<td>0.216544</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>21</td>
<td>0.866475</td>
<td>0.166756</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>22</td>
<td>0.828821</td>
<td>0.125583</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>23</td>
<td>0.792214</td>
<td>0.094763</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>24</td>
<td>0.757037</td>
<td>0.072662</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>25</td>
<td>0.723539</td>
<td>0.055544</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>26</td>
<td>0.691763</td>
<td>0.042442</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>27</td>
<td>0.661703</td>
<td>0.032804</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>28</td>
<td>0.633335</td>
<td>0.025908</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>29</td>
<td>0.606606</td>
<td>0.020872</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>30</td>
<td>0.581437</td>
<td>0.017020</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>31</td>
<td>0.557727</td>
<td>0.014002</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>32</td>
<td>0.535379</td>
<td>0.011625</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>33</td>
<td>0.514297</td>
<td>0.009755</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>34</td>
<td>0.494391</td>
<td>0.008293</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>35</td>
<td>0.475579</td>
<td>0.007180</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>36</td>
<td>0.457784</td>
<td>0.006386</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>37</td>
<td>0.440938</td>
<td>0.005807</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>38</td>
<td>0.424976</td>
<td>0.005199</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>39</td>
<td>0.409830</td>
<td>0.004525</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>40</td>
<td>0.395437</td>
<td>0.003926</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>41</td>
<td>0.381747</td>
<td>0.003398</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>42</td>
<td>0.368712</td>
<td>0.002977</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>43</td>
<td>0.356291</td>
<td>0.002673</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>44</td>
<td>0.344447</td>
<td>0.002432</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>45</td>
<td>0.333144</td>
<td>0.002230</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>46</td>
<td>0.322349</td>
<td>0.002058</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>47</td>
<td>0.312030</td>
<td>0.001911</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>48</td>
<td>0.302160</td>
<td>0.001785</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>49</td>
<td>0.292712</td>
<td>0.001678</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="b35af888-c949-4d1a-85f3-7c840f2b2e5d" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(lrnr.model(x)[<span class="op">-</span><span class="dv">10</span>:]).data.to(<span class="st">"cpu"</span>),cmap <span class="op">=</span> <span class="st">'bwr'</span>, vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-35-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="똑같은-코드들-torch.nn.lstm" class="level1">
<h1>똑같은 코드들: <code>torch.nn.LSTM</code></h1>
<section id="data-hihello" class="level2">
<h2 class="anchored" data-anchor-id="data-hihello">data: hi?hello!!</h2>
<div id="0564ff2e-e120-4152-9a2e-847f852cd3a7" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> <span class="bu">list</span>(<span class="st">'hi?hello!!'</span>)<span class="op">*</span><span class="dv">100</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:]</span></code></pre></div>
</div>
<div id="5b017371-5deb-4f0f-9d57-596a7bde41c4" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'!'</span>:<span class="dv">0</span>, <span class="st">'?'</span>:<span class="dv">1</span>,<span class="st">'h'</span>:<span class="dv">2</span>,<span class="st">'i'</span>:<span class="dv">3</span>,<span class="st">'e'</span>:<span class="dv">4</span>,<span class="st">'l'</span>:<span class="dv">5</span>,<span class="st">'o'</span>:<span class="dv">6</span>} </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
</section>
<section id="세트1-_water의-생략" class="level2">
<h2 class="anchored" data-anchor-id="세트1-_water의-생략">세트1: _water의 생략</h2>
<p><code>-</code> 코드1: 정석코드</p>
<div id="54221eb4-786e-47ad-94a2-6ff21efad7a6" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="207be544-fd98-465f-9d09-a09f5ac98b6e" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>_water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>lstm(x, (_water,_water))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>(tensor([[-0.1547,  0.0673,  0.0695,  0.1563],
         [-0.0786, -0.1430, -0.0250,  0.1189],
         [-0.0300, -0.2256, -0.1324,  0.1439],
         ...,
         [-0.0723,  0.0620,  0.1913,  0.2015],
         [-0.1155,  0.0746,  0.1747,  0.2938],
         [-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 (tensor([[-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;),
  tensor([[-0.4451, -0.2456, -0.1900,  0.6232]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 코드2: _water 는 사실 없어도 괜찮았어..</p>
<div id="472161c7-186f-4c99-a2c5-5c483e2366e9" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="99a4282c-e61f-405b-be82-16868281b15c" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>lstm(x)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>(tensor([[-0.1547,  0.0673,  0.0695,  0.1563],
         [-0.0786, -0.1430, -0.0250,  0.1189],
         [-0.0300, -0.2256, -0.1324,  0.1439],
         ...,
         [-0.0723,  0.0620,  0.1913,  0.2015],
         [-0.1155,  0.0746,  0.1747,  0.2938],
         [-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 (tensor([[-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;),
  tensor([[-0.4451, -0.2456, -0.1900,  0.6232]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;)))</code></pre>
</div>
</div>
<div id="cca55719-edd7-452b-804a-28766ce26b9c" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>x.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>torch.Size([999, 7])</code></pre>
</div>
</div>
<p>999개, 구별되는 문자 7개</p>
</section>
<section id="세트2-x.shape-l-h_in-or-lnh_in" class="level2">
<h2 class="anchored" data-anchor-id="세트2-x.shape-l-h_in-or-lnh_in">세트2: x.shape = (<span class="math inline">\(L\)</span>, <span class="math inline">\(H_{in}\)</span>) or (<span class="math inline">\(L\)</span>,<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>)</h2>
<p><code>-</code> 파라메터 설명</p>
<ul>
<li><span class="math inline">\(L\)</span> = sequece length = 시계열의 길이 = 간장을 몇 년 전통으로 이어갈지</li>
<li><span class="math inline">\(N\)</span> = batch size = 전체데이터는 몇 개의 시계열이 있는지 = 전체 데이터를 몇개의 시계열로 쪼갤지 &lt;– 왜 이걸 해야해?</li>
<li><span class="math inline">\(H_{in}\)</span> = input_size = 시점을 고정하였을 경우 입력자료의 차원 = 입력시계열이 시점별로 몇개의 변수로 나타내어 지는지? = 만약에 원핫인코딩으로 단어를 정리하면 단어수를 의미함</li>
</ul>
<p>우리가 실습했던 거 모두 N이 1이었다 그래서 안 썼음 - 1일 때만 아래와 같이 여러 버전 가능</p>
<p><code>-</code> 코드2: _water 는 사실 없어도 괜찮았어..</p>
<div id="b39a8173-d72f-4be7-9dcf-37049d3effc9" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="ec0c0a9a-77ef-4c2b-b191-22de833938e6" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>lstm(x)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>(tensor([[-0.1547,  0.0673,  0.0695,  0.1563],
         [-0.0786, -0.1430, -0.0250,  0.1189],
         [-0.0300, -0.2256, -0.1324,  0.1439],
         ...,
         [-0.0723,  0.0620,  0.1913,  0.2015],
         [-0.1155,  0.0746,  0.1747,  0.2938],
         [-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 (tensor([[-0.2350, -0.1559, -0.1093,  0.2682]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;),
  tensor([[-0.4451, -0.2456, -0.1900,  0.6232]], device='cuda:0',
         grad_fn=&lt;SqueezeBackward1&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 코드3: x의 차원은 사실 엄밀하게는 (<span class="math inline">\(L\)</span>,<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>) 와 같다…</p>
<div id="aa4059bb-3a78-439a-b91a-6ca58388bdf6" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="58d7266d-c6a0-4e5d-a8ba-c57014639694" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>lstm(x.reshape(<span class="dv">999</span>,<span class="dv">1</span>,<span class="dv">7</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>(tensor([[[-0.1547,  0.0673,  0.0695,  0.1563]],
 
         [[-0.0786, -0.1430, -0.0250,  0.1189]],
 
         [[-0.0300, -0.2256, -0.1324,  0.1439]],
 
         ...,
 
         [[-0.0723,  0.0620,  0.1913,  0.2015]],
 
         [[-0.1155,  0.0746,  0.1747,  0.2938]],
 
         [[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
        grad_fn=&lt;CudnnRnnBackward0&gt;),
 (tensor([[[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;),
  tensor([[[-0.4451, -0.2456, -0.1900,  0.6232]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 코드4: <code>batch_first=True</code>옵션을 사용하여 lstm을 만든경우</p>
<div id="a049e5af-148f-4174-a251-a779b1223750" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>,batch_first<span class="op">=</span><span class="va">True</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="917704b7-72e6-4f64-9c60-537c67ccbf54" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>lstm(x.reshape(<span class="dv">1</span>,<span class="dv">999</span>,<span class="dv">7</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>(tensor([[[-0.1547,  0.0673,  0.0695,  0.1563],
          [-0.0786, -0.1430, -0.0250,  0.1189],
          [-0.0300, -0.2256, -0.1324,  0.1439],
          ...,
          [-0.0723,  0.0620,  0.1913,  0.2015],
          [-0.1155,  0.0746,  0.1747,  0.2938],
          [-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
        grad_fn=&lt;CudnnRnnBackward0&gt;),
 (tensor([[[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;),
  tensor([[[-0.4451, -0.2456, -0.1900,  0.6232]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;)))</code></pre>
</div>
</div>
</section>
<section id="세트3-hidden.shape-dtimes-num_layers-h_out-or-dtimes-num_layers-n-h_out" class="level2">
<h2 class="anchored" data-anchor-id="세트3-hidden.shape-dtimes-num_layers-h_out-or-dtimes-num_layers-n-h_out">세트3: hidden.shape = (<span class="math inline">\(D\times\)</span> <code>num_layers</code>, <span class="math inline">\(H_{out}\)</span>) or (<span class="math inline">\(D\times\)</span> <code>num_layers</code>, <span class="math inline">\(N\)</span>, <span class="math inline">\(H_{out}\)</span>)</h2>
<p><code>-</code> 파라메터 설명</p>
<ul>
<li><span class="math inline">\(D\)</span> = 2 if bidirectional=True otherwise 1 = 양방향이면 2, 단방향이면 1 (우리는 단방향만 배움)</li>
<li><code>num_layres</code> = 중첩된 RNN일 경우 (우리는 중첩을 안시켰음)</li>
<li><span class="math inline">\(N\)</span> = batch size = 전체데이터는 몇 개의 시계열이 있는지 = 전체 데이터를 몇개의 시계열로 쪼갤지 &lt;– 왜 이걸 해야해?</li>
<li><span class="math inline">\(H_{out}\)</span> = 히든노드의 수</li>
</ul>
<p><code>-</code> 코드5: x.shape = (<span class="math inline">\(L\)</span>,<span class="math inline">\(1\)</span>,<span class="math inline">\(H_{in}\)</span>) <span class="math inline">\(\to\)</span> hidden.shape = (<span class="math inline">\(1\)</span>,<span class="math inline">\(1\)</span>,<span class="math inline">\(H_{out}\)</span>)</p>
<div id="3df8ff0e-fc10-4835-8d13-33302228e2de" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="cd3bbc31-1b83-4e0a-9837-3aaa6ad2caa4" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>_water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>lstm(x.reshape(<span class="dv">999</span>,<span class="dv">1</span>,<span class="dv">7</span>),(_water,_water))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>(tensor([[[-0.1547,  0.0673,  0.0695,  0.1563]],
 
         [[-0.0786, -0.1430, -0.0250,  0.1189]],
 
         [[-0.0300, -0.2256, -0.1324,  0.1439]],
 
         ...,
 
         [[-0.0723,  0.0620,  0.1913,  0.2015]],
 
         [[-0.1155,  0.0746,  0.1747,  0.2938]],
 
         [[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
        grad_fn=&lt;CudnnRnnBackward0&gt;),
 (tensor([[[-0.2350, -0.1559, -0.1093,  0.2682]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;),
  tensor([[[-0.4451, -0.2456, -0.1900,  0.6232]]], device='cuda:0',
         grad_fn=&lt;CudnnRnnBackward0&gt;)))</code></pre>
</div>
</div>
<p><code>-</code> 사실 _water.shape = (1,<span class="math inline">\(H_{out}\)</span>) 에서 1은 observation의 차원을 의미하는게 아님 (그런데 대충 그렇게 생각해도 무방함)</p>
<ul>
<li>한 시점의 콩물에 대하여 양방향으로 간장을 만들면 _water.shape = (2,h)</li>
<li>한 시점의 콩물에 대하여 3중첩으로 간장을 만들면 _water.shape = (3,h)</li>
<li>한 시점의 콩물에 대하여 3중첩간장을 양방향으로 만들면 _water.shape = (6,h)</li>
</ul>
</section>
</section>
<section id="똑같은-코드들-torch.nn.lstmcell" class="level1">
<h1>똑같은 코드들: <code>torch.nn.LSTMCell</code></h1>
<section id="data-hihello-1" class="level2">
<h2 class="anchored" data-anchor-id="data-hihello-1">data: hi?hello!!</h2>
<div id="b43b7377-8aa5-404a-9bea-b150739e102b" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> <span class="bu">list</span>(<span class="st">'hi?hello!!'</span>)<span class="op">*</span><span class="dv">100</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:]</span></code></pre></div>
</div>
<div id="30e58cc6-4070-48f8-8a51-5272d715b42d" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'!'</span>:<span class="dv">0</span>, <span class="st">'?'</span>:<span class="dv">1</span>,<span class="st">'h'</span>:<span class="dv">2</span>,<span class="st">'i'</span>:<span class="dv">3</span>,<span class="st">'e'</span>:<span class="dv">4</span>,<span class="st">'l'</span>:<span class="dv">5</span>,<span class="st">'o'</span>:<span class="dv">6</span>} </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
</section>
<section id="세트1-_water의-생략-1" class="level2">
<h2 class="anchored" data-anchor-id="세트1-_water의-생략-1">세트1: _water의 생략</h2>
<p><code>-</code> 코드1: 정석코드</p>
<div id="339925c6-9e38-4d41-bbc1-9397807bfb35" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
<div id="e153f33f-f9ff-40e6-95db-6fab98eae5ba" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> x[[<span class="dv">1</span>]]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>_water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>xt.shape, _water.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>(torch.Size([1, 7]), torch.Size([1, 4]))</code></pre>
</div>
</div>
<div id="baaa4cab-d155-4711-b820-60d5d61872f5" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>lstmcell(xt,(_water,_water))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>(tensor([[-0.0290, -0.1758, -0.0537,  0.0598]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;),
 tensor([[-0.0582, -0.4566, -0.1256,  0.1922]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;))</code></pre>
</div>
</div>
<p><code>-</code> 코드2: _water의 생략</p>
<div id="a6ca0b05-824b-4fd8-b537-0754c79bbcc3" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
<div id="23cb76fe-b6a8-44c2-917a-6bded94471ca" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> x[[<span class="dv">1</span>]]</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>xt.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>torch.Size([1, 7])</code></pre>
</div>
</div>
<div id="43a570b9-b011-472c-b691-3b3c65338dda" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>lstmcell(xt)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>(tensor([[-0.0290, -0.1758, -0.0537,  0.0598]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;),
 tensor([[-0.0582, -0.4566, -0.1256,  0.1922]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;))</code></pre>
</div>
</div>
</section>
<section id="세트2-xt.shape-nh_in-or-h_in" class="level2">
<h2 class="anchored" data-anchor-id="세트2-xt.shape-nh_in-or-h_in">세트2: xt.shape = (<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{in}\)</span>) or (<span class="math inline">\(H_{in}\)</span>)</h2>
<p>n: timeserie 개수, 1일 경우 생략 가능</p>
<p><code>-</code> 코드2: _water의 생략</p>
<div id="528462b4-1335-4493-adbd-69c6218542c4" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
<div id="1c4c93b7-eabe-4de2-9ebb-86b0cbde1f11" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> x[[<span class="dv">1</span>]]</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>xt.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="134">
<pre><code>torch.Size([1, 7])</code></pre>
</div>
</div>
<div id="b90606e3-48a2-4dff-b805-d66ecbf90242" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>lstmcell(xt)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>(tensor([[-0.0290, -0.1758, -0.0537,  0.0598]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;),
 tensor([[-0.0582, -0.4566, -0.1256,  0.1922]], device='cuda:0',
        grad_fn=&lt;ThnnFusedLstmCellBackward0&gt;))</code></pre>
</div>
</div>
<p><code>-</code> 코드3:</p>
<div id="bf01bb43-02c6-45a5-aa13-e1d78d45fb2e" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
<div id="2daf013e-ad1b-40ea-b950-937380c1d69f" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> x[<span class="dv">1</span>]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>xt.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>torch.Size([7])</code></pre>
</div>
</div>
<div id="59e11088-3a67-47bd-badb-40afe742b873" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>lstmcell(xt)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>(tensor([-0.0290, -0.1758, -0.0537,  0.0598], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 tensor([-0.0582, -0.4566, -0.1256,  0.1922], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;))</code></pre>
</div>
</div>
<p>(1,n)의 형태라면 괄호 하나 빼도 가능</p>
</section>
<section id="세트3-hidden.shape-nh_out-or-h_out" class="level2">
<h2 class="anchored" data-anchor-id="세트3-hidden.shape-nh_out-or-h_out">세트3: hidden.shape = (<span class="math inline">\(N\)</span>,<span class="math inline">\(H_{out}\)</span>) or (<span class="math inline">\(H_{out}\)</span>)</h2>
<p><code>-</code> 코드4: xt.shape = (<span class="math inline">\(H_{out}\)</span>) <span class="math inline">\(\to\)</span> _water.shape = <span class="math inline">\((H_{out})\)</span></p>
<div id="0895be40-f114-4144-ae72-187caa3b4187" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>lstmcell <span class="op">=</span> torch.nn.LSTMCell(<span class="dv">7</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>) </span></code></pre></div>
</div>
<div id="a352c0a8-8168-499d-8257-fd1d9c9870a4" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>xt <span class="op">=</span> x[<span class="dv">1</span>]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>_water <span class="op">=</span> torch.zeros(<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>xt.shape,_water.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>(torch.Size([7]), torch.Size([4]))</code></pre>
</div>
</div>
<div id="98c1ac02-08f4-49a5-9fe7-5157736448e3" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>lstmcell(xt, (_water,_water))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>(tensor([-0.0290, -0.1758, -0.0537,  0.0598], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;),
 tensor([-0.0582, -0.4566, -0.1256,  0.1922], device='cuda:0',
        grad_fn=&lt;SqueezeBackward1&gt;))</code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<section id="똑같은-코드들-정리" class="level2">
<h2 class="anchored" data-anchor-id="똑같은-코드들-정리">똑같은 코드들 정리</h2>
<p><code>-</code> 원래 1은 단순히 observation의 차원이 아니다. 즉 <span class="math inline">\({\bf X}_{n \times p}\)</span>에서 <span class="math inline">\(n\)</span>에 대응하는 차원으로 생각할 수 없다.</p>
<p><code>-</code> 그런데 (1) 단방향 (2) 조각내지 않은 시계열 (3) 중첩하지 않은 순환망에 한정하여서는 observation 처럼 생각해도 무방하다. &lt;– 엄밀하게는 이게 위험한 생각임. 하지만 정식으로 모두 따지려면 너무 헷갈림</p>
</section>
<section id="실제구현시-기억할-것" class="level2">
<h2 class="anchored" data-anchor-id="실제구현시-기억할-것">실제구현시 기억할 것</h2>
<p><code>-</code> 현실적으로 (1)-(3)이 아닌 조건에서는 Cell 단위로 연산을 이용할 일이 없다. (느리거든요) // 그냥 이해용으로 구현</p>
<p><code>-</code> torch.nn.RNN 혹은 torch.nn.LSTM 으로 네트워크를 구성할시 _water의 dim을 명시할 일도 없다.</p>
<p><code>-</code> 오로지 고려해야 할 것은 입력시계열을 조각낼지 조각내지 않을지</p>
</section>
</section>
<section id="조각난-시계열로-학습" class="level1">
<h1>조각난 시계열로 학습</h1>
<p>시계열이 무조건 연속으로서 데이터가 존재하지 않는다면? - 댓글 1의 길이는 400 - 댓글 2 의 길이는 100 이럴수도</p>
<section id="data" class="level2">
<h2 class="anchored" data-anchor-id="data">data</h2>
<div id="69f3340e-0ad5-462c-9754-437b0cfe054a" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> <span class="bu">list</span>(<span class="st">'hi!'</span>)<span class="op">*</span><span class="dv">3</span> <span class="op">+</span> <span class="bu">list</span>(<span class="st">'hi?'</span>)<span class="op">*</span><span class="dv">3</span> </span></code></pre></div>
</div>
</section>
<section id="조각내지-않은-시계열" class="level2">
<h2 class="anchored" data-anchor-id="조각내지-않은-시계열">조각내지 않은 시계열</h2>
<div id="7e3d9708-ee69-4530-881f-f85cab397ccf" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:] </span></code></pre></div>
</div>
<div id="37e94fc8-3e62-4243-a8d6-ab97baf094e0" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'!'</span>:<span class="dv">0</span>, <span class="st">'?'</span>:<span class="dv">1</span>, <span class="st">'h'</span>:<span class="dv">2</span>, <span class="st">'i'</span>:<span class="dv">3</span>} </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="26493f49-7dbc-43c6-a9e6-e7cd41095ccd" class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="9bf0440d-d6f1-41e3-8afa-e354caaffff3" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss() </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="40ab0906-f1ef-4dd6-ade4-dbd608676bc3" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 1 </span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>    hidden, _ <span class="op">=</span> lstm(x) </span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 2 </span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output,y) </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 3 </span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    loss.backward() </span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 4 </span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>    optimizr.step()</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    optimizr.zero_grad()</span></code></pre></div>
</div>
<div id="0887b8b0-5ed8-4770-b48e-48a5dcaf6145" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-74-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>첫번째 stack은 hi!로 학습 두번째 stack은 hi?로 학습하여 결과가 이럼</p>
</section>
<section id="조각난-시계열" class="level2">
<h2 class="anchored" data-anchor-id="조각난-시계열">조각난 시계열</h2>
<div id="fa353819-d174-4574-9b1f-d69fdd273c9f" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>txt1<span class="op">=</span> txt[:<span class="dv">9</span>]</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>txt2<span class="op">=</span> txt[<span class="dv">9</span>:]</span></code></pre></div>
</div>
<div id="984c5f53-8830-4b1d-b367-25b3ef5cdfb6" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>txt1,txt2</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>(['h', 'i', '!', 'h', 'i', '!', 'h', 'i', '!'],
 ['h', 'i', '?', 'h', 'i', '?', 'h', 'i', '?'])</code></pre>
</div>
</div>
<div id="cd613ad1-40f8-406b-8088-65819afcf694" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>txt1_x <span class="op">=</span> txt1[:<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>txt1_y <span class="op">=</span> txt1[<span class="dv">1</span>:] </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>txt2_x <span class="op">=</span> txt2[:<span class="op">-</span><span class="dv">1</span>] </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>txt2_y <span class="op">=</span> txt2[<span class="dv">1</span>:] </span></code></pre></div>
</div>
<div id="703115d8-4cda-40fe-9af9-a49fc1157fae" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">'!'</span>:<span class="dv">0</span>, <span class="st">'?'</span>:<span class="dv">1</span>, <span class="st">'h'</span>:<span class="dv">2</span>, <span class="st">'i'</span>:<span class="dv">3</span>} </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>x1 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt1_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt1_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>x2 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt2_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt2_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<p>9에서 하나씩 빼서 x,y 만들었으니까 8</p>
<div id="7f91f222-84f3-45fe-bb64-5bdc4e52ebef" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>x1.shape, y1.shape, x2.shape, y2.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>(torch.Size([8, 4]),
 torch.Size([8, 4]),
 torch.Size([8, 4]),
 torch.Size([8, 4]))</code></pre>
</div>
</div>
<div id="338d1a7b-0bc4-4a4f-945f-f1845febc5bf" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> torch.stack([x1,x2],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> torch.stack([y1,y2],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>xx.shape, yy.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>(torch.Size([8, 2, 4]), torch.Size([8, 2, 4]))</code></pre>
</div>
</div>
<div id="4ddd96fb-29c5-4198-b1fb-dae5ed71084f" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="c597f035-46cc-4dee-b27a-4ff9b0878a8b" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss() </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="bf810a3b-76ad-4b71-b541-85b7948bd07c" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 1 </span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    hidden, _ <span class="op">=</span> lstm(xx) </span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 2 </span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output[:,<span class="dv">0</span>,:],yy[:,<span class="dv">0</span>,:]) <span class="op">+</span> loss_fn(output[:,<span class="dv">1</span>,:],yy[:,<span class="dv">1</span>,:])</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 3 </span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    loss.backward() </span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 4 </span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    optimizr.step()</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    optimizr.zero_grad()</span></code></pre></div>
</div>
<p>첫번째 stzck 과 두번째 stack의 합</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>  loss <span class="op">=</span> loss_fn(output[:,<span class="dv">0</span>,:],yy[:,<span class="dv">0</span>,:]) <span class="op">+</span> loss_fn(output[:,<span class="dv">1</span>,:],yy[:,<span class="dv">1</span>,:])</span></code></pre></div>
<div id="1121e44c-653f-4807-b649-888dc655a40c" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>fig , ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>) </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].matshow(soft(output[:,<span class="dv">0</span>,:]).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].matshow(soft(output[:,<span class="dv">1</span>,:]).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-84-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>xx로 학습한 것들인데 만약 x를 넣는다면?</p>
<div id="566cca1b-c4a6-422d-8e80-46a96c467cbe" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-85-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="2deb19a5-6c24-4c7e-b307-f16578256825" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x1)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-86-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="596286ac-001a-4ec6-bde4-1155957f16c5" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x2)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-87-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f8c62ac2-1f6a-4b36-aaf3-05374fb76d36" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>hidden.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>torch.Size([17, 10])</code></pre>
</div>
</div>
<div id="85fa442c-8ab5-411c-96d4-abc98c1abd03" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>linr(hidden).shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>torch.Size([17, 4])</code></pre>
</div>
</div>
<p><code>-</code> 조각난 시계열로 학습한 경우는 hi!에서 hi?로 바뀔 수 없다. 왜냐햐면 그러한 연결정보가 끊어져 있으니까</p>
</section>
<section id="재미있는-실험" class="level2">
<h2 class="anchored" data-anchor-id="재미있는-실험">재미있는 실험</h2>
<p><code>-</code> x1만 배운다면?</p>
<div id="b7967176-dd2d-4d8b-a446-34e0a7e84da9" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="1d6848ed-b700-4c56-8ff9-4b08b07374aa" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss() </span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="dbe5d5b5-6529-4688-b108-94d6f418770f" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 1 </span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    hidden, _ <span class="op">=</span> lstm(x1) </span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 2 </span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output,y1)</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 3 </span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>    loss.backward() </span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 4 </span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>    optimizr.step()</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>    optimizr.zero_grad()</span></code></pre></div>
</div>
<div id="203579c4-9b22-48fe-92b0-950903491d83" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x2)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-93-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> x2만 배운다면?</p>
<div id="5c58f665-acca-46e4-9f10-3bf577f4b44c" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">4</span>,<span class="dv">10</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">10</span>,<span class="dv">4</span>).to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
<div id="5e69f783-b085-4c17-b0d4-be1746cba99a" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss() </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>optimizr <span class="op">=</span> torch.optim.Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="a46f173c-99fe-41f0-8b29-01db3b56d097" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 1 </span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>    hidden, _ <span class="op">=</span> lstm(x2) </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 2 </span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output,y2)</span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 3 </span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>    loss.backward() </span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 4 </span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a>    optimizr.step()</span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>    optimizr.zero_grad()</span></code></pre></div>
</div>
<div id="1cc133d6-4e02-4650-976f-9bbb82bfea38" class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x1)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(soft(linr(hidden)).to(<span class="st">"cpu"</span>).data,cmap<span class="op">=</span><span class="st">'bwr'</span>,vmin<span class="op">=-</span><span class="dv">1</span>,vmax<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="2022-11-30-12wk_files/figure-html/cell-97-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="똑같은-코드들-fastai-pytorch" class="level1">
<h1>똑같은 코드들 fastai, pytorch</h1>
<section id="data-human-numbers-5-1" class="level2">
<h2 class="anchored" data-anchor-id="data-human-numbers-5-1">data: human numbers 5</h2>
<div id="799b5b27-2003-48b5-8917-4ef4ae55eef7" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>txt <span class="op">=</span> ([<span class="st">'one'</span>,<span class="st">','</span>,<span class="st">'two'</span>,<span class="st">','</span>,<span class="st">'three'</span>,<span class="st">','</span>,<span class="st">'four'</span>,<span class="st">','</span>,<span class="st">'five'</span>,<span class="st">','</span>]<span class="op">*</span><span class="dv">100</span>)[:<span class="op">-</span><span class="dv">1</span>]</span></code></pre></div>
</div>
<div id="a454c3b8-ab67-4232-918c-25712c6beef8" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>mapping <span class="op">=</span> {<span class="st">','</span>:<span class="dv">0</span>, <span class="st">'one'</span>:<span class="dv">1</span>, <span class="st">'two'</span>:<span class="dv">2</span>, <span class="st">'three'</span>:<span class="dv">3</span>, <span class="st">'four'</span>:<span class="dv">4</span>, <span class="st">'five'</span>:<span class="dv">5</span>} </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>mapping</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>{',': 0, 'one': 1, 'two': 2, 'three': 3, 'four': 4, 'five': 5}</code></pre>
</div>
</div>
<div id="c4969d76-09e8-4adc-a9bf-dd7ccf20402b" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>txt_x <span class="op">=</span> txt[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>txt_y <span class="op">=</span> txt[<span class="dv">1</span>:] </span></code></pre></div>
</div>
<div id="420e48e2-3a46-481b-be94-cdddce2568d7" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>txt_x[<span class="dv">0</span>:<span class="dv">5</span>], txt_y[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>(['one', ',', 'two', ',', 'three'], [',', 'two', ',', 'three', ','])</code></pre>
</div>
</div>
<div id="f84f932c-3c60-4181-981d-134351002968" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_x,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> torch.nn.functional.one_hot(torch.tensor(f(txt_y,mapping))).<span class="bu">float</span>().to(<span class="st">"cuda:0"</span>)</span></code></pre></div>
</div>
</section>
<section id="fastai-이용한-learn-1" class="level2">
<h2 class="anchored" data-anchor-id="fastai-이용한-learn-1">fastai 이용한 learn</h2>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>dl1 <span class="op">=</span> torch.utils.data.DataLoader(ds1,batch_size<span class="op">=</span><span class="dv">998</span>)</span></code></pre></div>
<p>한 뭉치에 몇 개 있는지</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>torch.nn.LSTM(batxh_size)</span></code></pre></div>
<p>몇 개로 나눠져 있는지</p>
<div id="d2a5be73-1306-4354-aa93-5b1ef073f8a9" class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>ds1 <span class="op">=</span> torch.utils.data.TensorDataset(x,y)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>ds2 <span class="op">=</span> torch.utils.data.TensorDataset(x,y) <span class="co"># dummy </span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>dl1 <span class="op">=</span> torch.utils.data.DataLoader(ds1,batch_size<span class="op">=</span><span class="dv">998</span>)</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>dl2 <span class="op">=</span> torch.utils.data.DataLoader(ds2,batch_size<span class="op">=</span><span class="dv">998</span>) <span class="co"># dummy </span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> DataLoaders(dl1,dl2) </span></code></pre></div>
</div>
<div id="74e09147-2c21-4603-a6a9-ddb77c493473" class="cell" data-execution_count="216">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> MyLSTM(torch.nn.Module):</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>        <span class="bu">super</span>().<span class="fu">__init__</span>()</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>        torch.manual_seed(<span class="dv">43052</span>)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">6</span>,<span class="dv">20</span>)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.linr <span class="op">=</span> torch.nn.Linear(<span class="dv">20</span>,<span class="dv">6</span>) </span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> forward(<span class="va">self</span>,x):</span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>        _water <span class="op">=</span> torch.zeros(<span class="dv">1</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>        hidden, (hT,cT) <span class="op">=</span><span class="va">self</span>.lstm(x,(_water,_water))</span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>        output <span class="op">=</span> <span class="va">self</span>.linr(hidden)</span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> output         </span></code></pre></div>
</div>
<div id="4ebde9ca-4b46-48fb-907e-e3080c273fd7" class="cell" data-execution_count="217">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>net <span class="op">=</span> MyLSTM().to(<span class="st">"cuda:0"</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span></code></pre></div>
</div>
<div id="db69b84b-830e-448b-b6b0-d31d32cab381" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> Learner(dls,net,loss_fn,lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="87368618-3ccc-4952-a1ca-d0c5fc74b047" class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1.762846</td>
<td>1.502211</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>1</td>
<td>1.631212</td>
<td>1.620583</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>2</td>
<td>1.627597</td>
<td>1.443686</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>3</td>
<td>1.580216</td>
<td>1.368762</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>4</td>
<td>1.536200</td>
<td>1.307310</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>5</td>
<td>1.496099</td>
<td>1.216339</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>6</td>
<td>1.453670</td>
<td>1.113821</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>7</td>
<td>1.408125</td>
<td>1.019931</td>
<td>00:00</td>
</tr>
<tr class="odd">
<td>8</td>
<td>1.361426</td>
<td>0.941434</td>
<td>00:00</td>
</tr>
<tr class="even">
<td>9</td>
<td>1.315507</td>
<td>0.884034</td>
<td>00:00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="db3ce353-7f46-4480-b17a-a8ea07d54808" class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>soft(lrnr.model(x)).data.to(<span class="st">"cpu"</span>).numpy().<span class="bu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">
<pre><code>array([[0.935, 0.009, 0.015, 0.011, 0.016, 0.014],
       [0.133, 0.164, 0.242, 0.172, 0.141, 0.147],
       [0.982, 0.003, 0.004, 0.003, 0.004, 0.003],
       ...,
       [0.122, 0.171, 0.242, 0.174, 0.146, 0.144],
       [0.984, 0.003, 0.004, 0.002, 0.004, 0.003],
       [0.119, 0.172, 0.244, 0.175, 0.144, 0.145]], dtype=float32)</code></pre>
</div>
</div>
</section>
<section id="torch를-이용한-learn-1" class="level2">
<h2 class="anchored" data-anchor-id="torch를-이용한-learn-1">torch를 이용한 learn</h2>
<div id="bb2fe5e3-10d7-4e86-9fb0-888af83459cb" class="cell" data-execution_count="230">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>torch.manual_seed(<span class="dv">43052</span>) </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>lstm <span class="op">=</span> torch.nn.LSTM(<span class="dv">6</span>,<span class="dv">20</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>linr <span class="op">=</span> torch.nn.Linear(<span class="dv">20</span>,<span class="dv">6</span>).to(<span class="st">"cuda:0"</span>) </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>loss_fn <span class="op">=</span> torch.nn.CrossEntropyLoss()</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>optimizr <span class="op">=</span> Adam(<span class="bu">list</span>(lstm.parameters())<span class="op">+</span><span class="bu">list</span>(linr.parameters()),lr<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<p>optim으로 adam 사용</p>
<div id="7f47e3f7-aa14-427f-b577-ac94ea538d2e" class="cell" data-tags="[]" data-execution_count="231">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> epoc <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 1 </span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    hidden, _ <span class="op">=</span> lstm(x)</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    output <span class="op">=</span> linr(hidden) </span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 2 </span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    loss <span class="op">=</span> loss_fn(output,y) </span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 3 </span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    loss.backward()</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">## 4 </span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    optimizr.step()</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    optimizr.zero_grad()     </span></code></pre></div>
</div>
<div id="b8b4b79b-60d2-452d-85c4-3951d84a47e2" class="cell" data-execution_count="232">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>hidden, _ <span class="op">=</span> lstm(x)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>output <span class="op">=</span> linr(hidden) </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>soft(output).data.to(<span class="st">"cpu"</span>).numpy().<span class="bu">round</span>(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="232">
<pre><code>array([[0.935, 0.009, 0.015, 0.011, 0.016, 0.014],
       [0.133, 0.164, 0.242, 0.172, 0.141, 0.147],
       [0.982, 0.003, 0.004, 0.003, 0.004, 0.003],
       ...,
       [0.122, 0.171, 0.242, 0.174, 0.146, 0.144],
       [0.984, 0.003, 0.004, 0.002, 0.004, 0.003],
       [0.119, 0.172, 0.244, 0.175, 0.145, 0.145]], dtype=float32)</code></pre>
</div>
</div>
</section>
</section>
<section id="human-numbers-100" class="level1">
<h1>human numbers 100</h1>
<div id="06972181-8dda-4ea4-a9ae-0f6550b2960a" class="cell" data-execution_count="789">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/DL2022/main/posts/IV.%20RNN/2022-11-25-human_numbers_100.csv'</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="789">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">text</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1995</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1996</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1997</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1998</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1999</td>
<td>one, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve, thirteen, fourteen, fifteen, sixteen, seventeen, eighteen, nineteen, twenty, twenty one, twenty two, twenty three, twenty four, twenty five, twenty six, twenty seven, twenty eight, twenty nine, thirty, thirty one, thirty two, thirty three, thirty four, thirty five, thirty six, thirty seven, thirty eight, thirty nine, forty, forty one, forty two, forty three, forty four, forty five, forty six, forty seven, forty eight, forty nine, fifty, fifty one, fifty two, fifty three, fifty four, fifty five, fifty six, fifty seve...</td>
</tr>
</tbody>
</table>

<p>2000 rows × 1 columns</p>
</div>
</div>
</div>
<p><code>(1)</code> TextDataLoaders.from_df을 이용하여 dls오브젝트를 만들어라. - is_lm = True 로 설정할 것 - seq_len = 5 로 설정할 것</p>
<p>(풀이)</p>
<div id="91dea40d-2200-43a3-bfce-4d361a4626fe" class="cell" data-execution_count="791">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> TextDataLoaders.from_df(df,is_lm<span class="op">=</span><span class="va">True</span>,seq_len<span class="op">=</span><span class="dv">5</span>,text_col<span class="op">=</span><span class="st">'text'</span>)</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">text_</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>xxbos one , two ,</td>
<td>one , two , three</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>hundred xxbos one , two</td>
<td>xxbos one , two ,</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>one hundred xxbos one ,</td>
<td>hundred xxbos one , two</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>, one hundred xxbos one</td>
<td>one hundred xxbos one ,</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>nine , one hundred xxbos</td>
<td>, one hundred xxbos one</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>ninety nine , one hundred</td>
<td>nine , one hundred xxbos</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>, ninety nine , one</td>
<td>ninety nine , one hundred</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7</td>
<td>eight , ninety nine ,</td>
<td>, ninety nine , one</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>ninety eight , ninety nine</td>
<td>eight , ninety nine ,</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><code>(2)</code> lrnr 오브젝트를 만들어라. - arch = AWD_LSTM 이용 - metrics = accuracy 이용</p>
<p>(풀이)</p>
<div id="42341152-d37a-46af-9fbd-ab6a56d8e6c5" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> language_model_learner(dls, arch<span class="op">=</span> AWD_LSTM, metrics<span class="op">=</span>accuracy)</span></code></pre></div>
</div>
<p><code>(3)</code> lrnr오브젝트에서 fine_tune(3) 메소드를 이용하여 모형을 학습하라.</p>
<p>(풀이)</p>
<div id="b9e467c1-b545-4f03-b16a-d88e302481de" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>lrnr.fine_tune(<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.534681</td>
<td>0.168856</td>
<td>0.977650</td>
<td>00:49</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">
<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">epoch</th>
<th data-quarto-table-cell-role="th">train_loss</th>
<th data-quarto-table-cell-role="th">valid_loss</th>
<th data-quarto-table-cell-role="th">accuracy</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0.018749</td>
<td>0.003256</td>
<td>0.999205</td>
<td>00:54</td>
</tr>
<tr class="even">
<td>1</td>
<td>0.001580</td>
<td>0.002430</td>
<td>0.999324</td>
<td>00:54</td>
</tr>
<tr class="odd">
<td>2</td>
<td>0.000651</td>
<td>0.002244</td>
<td>0.999315</td>
<td>00:54</td>
</tr>
</tbody>
</table>
</div>
</div>
<p><code>(4)</code> ‘one , two ,’ 이후에 이어질 50개의 단어를 생성하라.</p>
<p>(풀이)</p>
<div id="50315363-3d14-413b-86ea-ba10222b0bef" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>lrnr.predict(<span class="st">'one, two,'</span>, n_words<span class="op">=</span><span class="dv">50</span>) </span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>'one , two , three , four , five , six , seven , eight , nine , ten , eleven , twelve , thirteen , fourteen , fifteen , sixteen , seventeen , eighteen , nineteen , twenty , twenty one , twenty two , twenty three , twenty four , twenty five'</code></pre>
</div>
</div>
<p><code>(5)</code> ‘twenty , twenty one ,’ 이후에 이어질 50개의 단어를 생성하라.</p>
<p>(풀이)</p>
<div id="5a3320ad-c8b8-4926-b1d1-d84f26fdc708" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>lrnr.predict(<span class="st">'twenty, twenty one,'</span>, n_words<span class="op">=</span><span class="dv">50</span>) </span></code></pre></div>
<div class="cell-output cell-output-display">

<style>
    /* Turns off some styling */
    progress {
        /* gets rid of default border in Firefox and Opera. */
        border: none;
        /* Needs to be in here for Safari polyfill so background images work as expected. */
        background-size: auto;
    }
    progress:not([value]), progress:not([value])::-webkit-progress-bar {
        background: repeating-linear-gradient(45deg, #7e7e7e, #7e7e7e 10px, #5c5c5c 10px, #5c5c5c 20px);
    }
    .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
        background: #F44336;
    }
</style>
</div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>'twenty , twenty one , twenty two , twenty three , twenty four , twenty five , twenty six , twenty seven , twenty eight , twenty nine , thirty , thirty one , thirty two , thirty three , thirty four , thirty five , thirty six , thirty seven , thirty eight ,'</code></pre>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="seoyeonc/md" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>