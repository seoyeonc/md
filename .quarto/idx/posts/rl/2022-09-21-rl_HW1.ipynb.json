{"title":"Regression HW 1","markdown":{"yaml":{"title":"Regression HW 1","author":"SEOYEON CHOI","date":"2022-09-21","categories":["Advanced Regression Analysis"]},"headingText":"1.","containsRefs":false,"markdown":"\n\n고급회귀분석 과제, CH03, CH04\n\n---\n\n과제1\n\n**풀이** :\n\nR 이용하지 않고 직접 계산. (R로 단순 계산은 해도 됨)\n\n모든 문제에는 풀이가 있어야 함.\n\n풀이 없이 답만 있는 경우 '0'점 처리.\n\n \n\n- 제출 기한 : 10월 03일\n\n**제출 방법** : \n\n직접 제출 (607호) 또는 스캔, 사진, tex 작업, 문서 작업 등 후 pdf로 변환 후 제출\n\npdf 아닌 경우 미제출 처리\n\n---\n\n\n원점을 지나는 회귀모형은 다음과 같이 정의할 수 있다.\n$$y_i =β_1x_i +ε_i, ε_i ∼_{i.i.d.} N(0,σ^2), i=1,...,n$$\n오차제곱합을 정의하고 $β_1$ 의 최소제곱추정량 ($\\hat{β}_1$)을 구하여라.\n\n**Answer**\n\n$SSE = \\sum(y_i - \\hat{y_i})^2 = \\sum(y_i - \\hat{\\beta_1}x_i)^2$\n\n$SSE' = 0 = \\sum(-x_i)2(y_i - \\hat{\\beta_1}x_i )$\n\n$\\sum(-x_iy_i) + \\sum(x_i^2\\hat{\\beta_1}) = 0$\n\n$\\hat{\\beta_1} = \\frac{\\sum(x_iy_i)}{\\sum(x_i^2)}$\n\n# 2.\n\n자동차의 무게가 무거우면 이를 움직이는 데 더 많은 연료가 소모된다는 것은 알려진 사실이다. 자동차의 무게와 자동차를 1km 움직이는 데 필요한 에너지량과의 함수관계를 정확히 판단하기 위하여 A 자동차회사는 다음의 자료를 실험을 통하여 얻었다. 실험 비용이 많이 드는 관계로 9번만 실험하였다.\n\n|무게 X(단위: 1,000kg)|에너지소모량 Y(단위: 1,000btu)|\n|:---:|:---:|\n|0.9|2.0|\n|1.3|2.6|\n|2.1|4.3|\n|2.5|5.8|\n|2.4|5.1|\n|1.7|3.2|\n|0.7|1.8|\n|1.2|2.3|\n|1.6|3.0|\n\n## (1)\n\n이 데이터의 산점도를 그리시오.\n\n**Answer**\n\n- 양의 상관관계가 있어보인다.\n- 무게가 커질수록 에너지소모량도 큰 경향이 보이기 때문이다.\n- 우상향의 모양이라, 단순상관선형 적용해보면 되겠다.\n\n## (2)\n\n최소제곱법의 의한 회귀직선을 적합시키시오.\n\n**Answer**\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n- 반올림 해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n- $\\hat{y} =  -0.1156783 +  2.162577x$의 모형으로 적합되었다.\n\n## (3)\n\n데이터의 산점도를 그리고 추정한 회귀직선을 (1)에서 그린 산점도 위에 그리시오.\n\n**Answer**\n\n- 추정한 회귀직선을 그려보니 오차가 클 것처럼 y와 $\\hat{y}$가 떨어진 값이 많아보인다.\n\n## (4)\n\n결정계수와 상관계수를 구하시오.\n\n$r_{xy} = \\frac{S_{xy}}{\\sqrt{S_{xx}S_{yy}}}$\n\n- 상관계수는 약 98% 로, $x,y$간 높은 양의 상관관계가 있었다.\n\n$R^2 = \\frac{SSR}{SST} = r^2$\n\n- 결정계수는 약 95%로, 설명력도 높은 편이라고 말할 수 있지만, 결정계수는 다른 모델과 비교할때 언급되는 것이 적절하다.\n\n## (5)\n\n분산분석표를 작성하고 회귀직선의 유의 여부를 검정하시오 (유의수준 $α = 0.05$ 사용).\n\n||df|sum of square|mean of square| F value| p value|\n|:---:|:---:|:---:|:---:|:---:|:---:|\n|x|1|15.24617|15.24617|141.1584|1.614672e-07|\n|Residuals|7|0.7560522|0.1080075|||\n\n- F값은 141.1584, p value는 1.614672e-07가 나왔다.\n- 유의수준 5%에서 모형이 유의하다는 것을 알 수 있었다.\n\n## (6)\n\n$\\beta_0,\\beta_1$ 에 대한 90% 신뢰구간을 구하시오.\n\n**Answer**\n\n$$\\hat{\\beta_0} \\pm t_{(\\alpha/2,n-2)}\\hat{\\sigma} \\sqrt{\\frac{1}{n} + \\frac{\\bar{x}^2}{S_{xx}}}$$\n\n$$\\hat{\\beta_1} \\pm t_{(\\alpha/2,n-2)} \\sqrt{\\frac{MSE}{S_{xx}}}$$\n\n- $\\beta_0$의 신뢰구간은 0을 포함하였다.($H_0 : \\beta_0=0$ 채택)\n- $\\beta_1$의 신뢰구간은 0을 포함하지 않았다.($H_0 : \\beta_1=0$ 기각)\n- 신뢰구간으로 신뢰구간에 0이 포함된 $\\beta_1$ 계수만 유의미하다는 것을 알 수 있다.\n\n## (7)\n\n$H_0 :\\beta_1 =1$ vs. $H_1 :\\beta_1  \\ne 1$의 가설검정을 유의수준 $α=0.1$에서 수행하시오.\n\n$$\\text{t value} = \\frac{\\hat{\\beta_1} - 1}{s.e(\\hat{\\beta_1})}$$\n\n- 구힌 t value = 6.39가 유의수준 $\\alpha = 0.1$ 에서의 t value = 1.89보다 크기 때문에 유의하다는 결과가 나와 귀무가설을 기각한다.\n- 따라서 $\\beta_1$은 1이 아니다.\n\nfigure로 표현\n\n## (8)\n\n무게가 3,000kg 이 되는 차량의 평균 에너지 소모량을 예측하시오. 이것은 무게가 1,000kg이 되는 차량의 에너지 소모량의 몇 배인가?\n\n$$\\hat{\\mu}_0 = \\hat{\\beta_0} + \\hat{\\beta_1} x_0$$\n\n## (9)\n\n무게가 3,000kg 이 되는 차량의 평균 에너지 소모량과 하나의 개별 $y$ 값의 90% 신뢰구간을 각각 구하시오.\n\n**Answer**\n\n$$\\hat{Var(\\hat{\\mu}_0}) = \\sigma (\\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}})$$\n\n$S_{xx}$\n\n$\\hat{Var(\\hat{\\mu_0})}$\n\n$\\hat{\\sigma}_{\\hat{\\mu_0}}$\n\n$\\hat{\\mu_0} \\pm t_{(\\alpha/2,(n-2))}\\hat{\\sigma_{\\hat{\\mu_0}}}$\n\n## (10)\n\n잔차 $e_i = y_i − \\hat{y}_i$ 를 구하고 잔차의 합이 0 임을 확인하시오.\n\n**Answer**\n\n합이 0인 것을 확인했다.\n\n## (11)\n\n잔차들의 $x_i$ 에 대한 가중합, $\\sum x_ie_i$ 를 구하시오.\n\n잔차들의 $x_i$ 에 대한 가중합, $\\sum x_ie_i$이 0인 것을 확인했다.\n\n## (12)\n\n잔차들의 $\\hat{y}$에 대한 가중합 $\\sum \\hat{y}_ie_i$, 를 구하시오.\n\n잔차들의 $\\hat{y}$에 대한 가중합 $\\sum \\hat{y}_ie_i$이 0인 것을 확인했다.\n\n## (13)\n\n원점을 지나는 회귀직선을 구하시오.\n\n**Answer**\n\n$\\hat{\\beta_1} = \\frac{\\sum(x_iy_i)}{\\sum(x_i^2)}$\n\n- 원점을 지나는 회귀직선은 $\\hat{y} =  2.09924x$의 모형으로 적합되었다.\n\n## (14)\n\n위 회귀직선에서 회귀계수(기울기)의 90% 신뢰구간을 구하시오.\n\n**Answer**\n\n$$\\hat{\\beta_1} \\pm t_{(\\alpha/2,n-1)}\\frac{\\hat{\\sigma}}{\\sqrt{S_{xx}}}$$\n\n- $\\beta_1$의 신뢰구간은 0을 포함하지 않았다.($H_0 : \\beta_1=0$ 기각)\n- 신뢰구간으로 신뢰구간에 0이 포함된 $\\beta_1$ 계수가 유의미하다는 것을 알 수 있다.\n\n## (15)\n\n원점을 지나는 회귀직선의 결정계수를 구하시오.\n\n**Answer**\n\n$R^2 = \\frac{SSR}{SST} = r^2$\n\n## (16)\n\n원점을 포함한 회귀직선과 포함하지 않은 회귀직선의 결과를 비교하여라.\n\n**Answer**\n\n- 선형성 만족\n\n- 원점을 지나지 않는 모형이 한쪽 부호에 머무는 경향이 있어보인다.(독립성을 만족하지 않을 수 있다.)\n- 원점을 지나는 모형은 그러한 경향이 없고, 등분산성을 만족하는 것처럼 보인다.\n\n- 두 모형 모두 정규성 가정을 만족했다.\n\nANOVA table 비교\n\n|y=beta0+beta1x|df|sum of square|mean of square| F value| p value|\n|:---:|:---:|:---:|:---:|:---:|:---:|\n|x|1|15.24617|15.24617|141.1584|1.614672e-07|\n|Residuals|7|0.7560522|0.1080075|||\n\n|y=beta1x|df|sum of square|mean of square| F value| p value|\n|:---:|:---:|:---:|:---:|:---:|:---:|\n|x|1|115.89906559088|115.89906559088|1202.60806139735|1.728622e-12|\n|Residuals|8|0.77098479088|0.09637309886|||\n\n# 3.\n\n(강의노트 CH04, p9) 다음이 성립함을 증명하시오.\n\n$$\\hat{\\beta}_0 \\sim N\\big( \\beta_0 , \\sigma^2\\big( \\frac{1}{n} + \\frac{\\bar{x}^2}{S_{(xx)}} \\big) \\big)$$\n\n**Answer**\n\n$\\hat{\\beta_0}$\n\n$= \\bar{y} - \\hat{\\beta_1} \\bar{x} = \\bar{y} - \\frac{S_{xy}}{S_{xx}}\\bar{x}$\n\n$= \\bar{y} - \\frac{\\sum(x_i - \\bar{x})(y_i - \\bar{y})}{S_{xx}}\\bar{x}$\n\n$= \\bar{y} - \\sum\\frac{(x_i-\\bar{x})y_i\\bar{x}-(x_i - \\bar{x})\\bar{y}\\bar{x}}{S_{xx}}$\n\n$= \\bar{y} - \\sum\\frac{(x_i - \\bar{x})}{S_{xx}}y_i\\bar{x} - \\frac{\\bar{x}\\bar{y}}{S_{xx}}\\sum(x_i - \\bar{x})$\n\n$= \\bar{y} - \\sum\\frac{(s_i - \\bar{x})}{S_{xx}}y_i\\bar{x}$\n\n$\\approx \\bar{y} - \\sum a_iy_i\\bar{x}$\n\n$E(\\hat{\\beta_0})$\n\n$=\\bar{y} - \\bar{x}\\sum a_i E(y_i)$\n\n$=\\bar{y} - \\bar{x}\\sum a_i (\\beta_0 + \\beta_1 x_i)$\n\n$=\\bar{y} - (\\beta_0\\bar{x}\\sum a_i + \\beta_1 \\bar{x} \\sum a_i x_i)$\n\n$=\\bar{y} - \\beta_1\\bar{x} = \\beta_0$\n\n$\\star \\sum a_i = \\sum\\frac{x_i - \\bar{x}}{S_{xx}} = \\frac{1}{S_{xx}}\\sum(x_i-\\bar{x} )= 0$\n\n$\\star \\sum a_i x_i = \\sum\\frac{(x_i - \\bar{x})x_i}{S_{xx}}= \\frac{1}{S_{xx}} \\sum(x_i - \\bar{x})(x_i - \\bar{x} + \\bar{x}) = \\frac{1}{S_{xx}} \\sum(x_i - \\bar{x})^2 + \\frac{\\bar{x}}{S_{xx}} \\sum(x_i - \\bar{x}) = \\frac{1}{S_{xx}} \\sum(x_i - \\bar{x})^2 = 1$\n\n$Var(\\hat{\\beta_0})$\n\n$=Var(\\bar{y} - \\bar{x}\\sum a_i x_i)$\n\n$=Var(\\frac{y_i}{n} - \\bar{x}\\sum a_i y_i)$\n\n$=\\frac{\\sigma^2}{n} - \\bar{x}^2\\sigma^2\\sum a_i^2$\n\n$= \\frac{\\sigma^2}{n} - \\frac{\\bar{x}^2\\sigma^2}{S_{xx}}$\n\n$= \\sigma^2(\\frac{1}{n} - \\frac{\\bar{x}^2}{S_{xx}})$\n\n$\\star \\sum a_i^2 = \\sum\\frac{(x_i - \\bar{x})^2}{S_{xx}^2} = \\frac{1}{S_{xx}^2}\\sum(x_i - \\bar{x})^2 = \\frac{1}{S_{xx}}$\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"2022-09-21-rl_HW1.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"pulse","code-copy":false,"title-block-banner":true,"title":"Regression HW 1","author":"SEOYEON CHOI","date":"2022-09-21","categories":["Advanced Regression Analysis"]},"extensions":{"book":{"multiFile":true}}}}}