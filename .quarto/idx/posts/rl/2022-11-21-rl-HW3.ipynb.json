{"title":"Regression HW 3","markdown":{"yaml":{"title":"Regression HW 3","author":"SEOYEON CHOI","date":"2022-11-21","categories":["Advanced Regression Analysis"]},"headingText":"1.","containsRefs":false,"markdown":"\n\n고급회귀분석 과제, CH03,07\n\n---\n\n고급회귀분석 세번째 과제입니다.\n\n \n\n제출 기한 : 11월 21일 \n\n \n\n제출 방법\n\n  - 직접 제출(607호) 도 가능하지만, \n\n  - 문서 작성 후 pdf로 변환(★★★)하여 lms에 제출을 추천\n\n  (pdf 아닌 문서는 미제출로 간주)\n\n \n\n주의사항\n\n- pdf로 꼭 변환하여 제출\n\n- 풀이가 꼭 있어야 함 (답만 적혀 있는 경우 '0'점 처리)\n\n- 부정행위 시 'F'학점 \n\n- 계산은 R로 해도 되지만 계산 풀이 과정이 꼭 있어야 함!!\n\n예) R에서 lm으로 beta의 추정량을 구하면 안 됨. 수업 시간에 배운 식으로 풀이를 적어야 함.\n\n- 행렬식 계산은 R로 해도 됩니다.\n\n \n\n \n\n************ R을 이용해서 푸는 문제는, R 코드도 같이 업로드.\n\n---\n\n\n어떤 큰 공장에서 동일한 기계들의 정비기록에 관한 표본자료를 취하였다. 이는 기계의 사용연도(age of machines)와 정비비용(maintenance cost) 간에 어떤 관계가 있는가를 밝혀내기 위한 것이다. 그 자료는 다음과 같다 (표본의 크기 $n = 14$).\n\n|사용연도$X$(단위:년)|정비비용$Y$(단위:1,000원)|\n|:---:|:---:|\n|3|39|\n|1|24|\n|5|115|\n|8|105|\n|1|50|\n|4|86|\n|2|67|\n|6|90|\n|9|140|\n|3|112|\n|5|70|\n|7|186|\n|2|43|\n|6|126|\n\n## (1)\n\n $X^\\top X, X^\\top y, y^\\top y$와 $(X^\\top X)^{-1}$을 구하시오.\n\n## (2)\n\n$\\hat{\\beta} = (X^\\top X)^{-1}X^\\top y$를 구하고, 적합된 회귀선형을 써 보아라.\n\n$y = 29.1 + 13.6x$\n\n## (3)\n\n$\\sigma^2$을 MSE 로 추정할 경우, $\\hat{\\beta}$의 분산-공분산행렬의 추정은 $\\hat{Var}(\\hat{\\beta}) = (X^\\top X)^{-1}$(MSE)이다. 먼저 분산분석하여 MSE 를 구하고 $\\hat{Var}(\\hat{\\beta})$을 구하시오\n\n$SSE = y^\\top(I-H)y$\n\n$SST = y^\\top y - n(\\bar{y})^2$\n\n**분산분석표**\n\n|요인|제곱합|자유도(df)|평균제곱(MS)|$F_0$|유의확률\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|회귀|15887.25|1|15887.25|18.75293|4.747225|\n|잔차|10166.25|12|847.19|||\n|계|26053.5|13||||\n\n# 2.\n\n어떤 공정에서 나오는 제품의 강도$(kg/cm^2)$가 그 공정의 온도와 압력에 어떠한 영향을 받는가를 조사하기 위하여 다음의 데이터를 얻었다.\n\n|공정온도$x_1$(단위:°C)|공정압력$x_2$(단위:$psi$)|강도$y$(단위:$kg/cm^2$)|\n|:---:|:---:|:---:|\n|195|57|81.4|\n|179|61|122.2|\n|205|60|101.7|\n|204|62|175.6|\n|201|61|150.3|\n|184|54|64.8|\n|210|58|92.1|\n|209|61|113.8|\n\n## (1)\n\n선형회귀모형, $y_j = \\beta_0 + \\beta_1 x_{1j} + \\beta_2 x_{2j} + \\epsilon_j$ 가 성립된다고 가정하고 데이터로부터 회귀모형을 추정하시오.\n\n$y = -554.31 - 0.1797 x_1 + 11.86 x_2$\n\n## (2)\n\n오차분산이 $\\sigma^2 = 3$이라 하면, $Var(\\hat{\\beta}_0), Var(\\hat{\\beta}_1), Var(\\hat{\\beta}_2)$와 $Cov(\\hat{\\beta}_1, \\hat{\\beta}_2)$는 무엇인가?\n\n$var(\\hat{\\beta}) = (x^\\top x)^{-1} \\sigma^2$\n\n$var(\\hat{\\beta}_0) = 248.6250$\n\n$var(\\hat{\\beta}_1) = 0.0037$\n\n$var(\\hat{\\beta}_2) = 0.0669$\n\n$cov(\\hat{\\beta}_1, \\hat{\\beta}_2) = -0.0057$\n\n## (3)\n\n$x_1 = 200$°C이고 $x_2 = 59\\text{psi}$에서 평균 제품의 강도의 추정값 $\\hat{y}$는 얼마인가? 이의 분산을 $\\sigma^2 = 3$이라 가정하고 구하시오.\n\n$\\hat{\\mu}_0 = 109.4804$\n\n## (4)\n\n추정된 회귀계수 $\\hat{\\beta}_1, \\hat{\\beta}_2$의 의미는 무엇인가?\n\n$\\hat{\\beta}_1$ : 공정압력이 일정하게 유지되었을 때, 공정온도가 1도씨 증가하면 강도는 0.1797만큼 감소한다.\n\n\n$\\hat{\\beta}_2$ : 공정온도가 일정하게 유지되었을 때, 공정압력이 1psi 증가하면 강도는 11.8600만큼 증가한다.\n\n## (5)\n\n분산분석표를 작성하고 $\\alpha = 0.05$로 $F$-검정을 행하시오.\n\n$SSE = y^\\top (I-H)y$\n\n$SST = y^\\top y - n(\\bar{y})^2$\n\n|요인|제곱합|자유도(df)|평균제곱(MS)|$F_0$|유의확률\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|회귀|6940.195|2|3470.097|7.4119|5.786135|\n|잔차|2340.884|5|468.177|||\n|계|9281.079|7||||\n\n결론 : 검정통계량의 관측값이 기각역에 속하므로 귀무가설 기각. 즉 모형이 유의수준 0.05하에서 유의하다고 할 수 있다.\n\n## (6)\n\n결정계수 $R^2$을 구하시오.\n\n$R^2  = \\frac{SSR}{SST}$\n\n## (7)\n\n수정된 결정계수 $R^2_{adj}$ 을 구하시오.\n\n$R^2_{adj}  = 1-\\frac{SSE(n-p-1)}{SST/(n-1)}$\n\n## (8)\n\n$\\sigma^2$의 추정값 MSE 를 구하시오.\n\n$\\sigma^2 = MSE$\n\n## (9)\n\nMSR의 기대값을 $\\sigma^2$과 $\\beta_0, \\beta_1, \\beta_2$의 함수로 표시하여라.\n\n# 3. \n\n어떤 공장에서 물의 소비량을 조사하기 위하여 매달의 물소비량($y$), 평균온도($x_1$), 작업일수($x_2$)와 작업량($x_3$)에 관한 데이터를 얻었다.\n\n|물소비량$y$(단위:1,000톤)|평균온도$x_1$(단위:°C)|작업일수$x_2$(단위:일)|작업량$x_3$(단위:1,000톤)|\n|:---:|:---:|:---:|:---:|\n|2.8|10|27|64|\n|3.9|24|26|72|\n|3.9|25|28|80|\n|4.4|28|26|88|\n|3.1|15|30|81|\n|3.1|18|24|45|\n|3.5|22|27|46|\n|3.6|22|25|69|\n|3.0|12|27|54|\n|3.3|15|25|39|\n\n## (1)\n\n데이터로부터 회귀모형, $\\hat{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_1 + \\hat{\\beta}_2 x_2 + \\hat{\\beta}_3 x_3$ 을 구하여라. 그리고 어째서 이 모형이 선택되었는가에 대하여 토의하시오.\n\n$\\hat{y} = 2.409 + 0.0698x_1 - 0.0248x_2 + 0.0059x_3$\n\n## (2)\n\n$\\hat{\\beta}_1, \\hat{\\beta}_2$와 $\\hat{\\beta}_3$의 의미는 무엇인가?\n\n$\\hat{\\beta}_1$ : 작업일수, 작업량이 변하지 않을 때, 평균온도가 1도씨 증가하면 물소비량은 69.8톤 증가한다.\n\n$\\hat{\\beta}_2$ : 평균온도, 작업량이 변하지 않을 때, 작업일수가 1일 증가하면 물소비량은 24.8톤 감소한다.\n\n$\\hat{\\beta}_3$ : 평균온도, 작업일수이 변하지 않을 때, 작업량이 1000톤 증가하면 물소비량은 5.9톤 증가한다.\n\n## (3)\n\n$Var(\\hat{\\beta}_3)$을 구하시오. $\\sigma^2$을 MSE 로 추정하면 $\\hat{Var}(\\hat{\\beta}_3)$은 무엇인가?\n\n$var(\\beta_3) = (x^\\top x)^{-1}_{(4,4)} \\sigma^2$\n\n$var(\\hat{\\beta}_3) = 0.0000255$\n\n## (4)\n\n분산분석표를 작성하고, 결정계수 $R^2$을 구하시오.\n\n$SSE = y^\\top (I-H)y$\n\n$SST = y^\\top y - n(\\bar{y})^2$\n\n|요인|제곱합|자유도(df)|평균제곱(MS)|$F_0$|유의확률\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|회귀|2.0465|3|0.6822|23.0544|4.7571|\n|잔차|0.1775|6|0.0296|||\n|계|2.2240|9||||\n\n$R^2$\n\n## (5)\n\n$x_1 = 20, x_2 = 27, x_3 = 60$에서 평균 물소비량을 추정하시오. 이 추정된 소비량의 표준편차의 추정값을 구하시오.\n\n$\\hat{\\mu}_0 = 3.4881$\n\n## (6)\n\n$x_1 = 20, x_2 = 27, x_3 = 60$에서 어느 한 달의 물소비량 $y_s$ 를 예측하여라. 이 예측된 물소비량의 표준편차의 추정값을 구하시오.\n\n$\\hat{y}_s = 3.4881$\n\n## (7)\n\n$y_j = \\beta_0 + \\beta_1 x_{1j} + \\beta_2 x_{2j} + \\epsilon_j$ 라 가정하고 회귀제곱합 SSR의 기대값을 $\\sigma^2$과 $\\beta_i, i = 0, 1, 2, 3$의 함수로 표시하여라.\n\n## (8)\n\n$\\beta_3$의 95% 신뢰구간을 구하시오. 이 신뢰구간의 의미를 해석하시오.\n\n$\\beta_3 \\pm t_{0.025}(6) se(\\hat{\\beta}_3)$\n\n이 신뢰구간이 $\\beta_3$을 포함하고 있을 것이라고 95% 확신한다.\n\n## (9)\n\n$\\beta_1$의 99% 신뢰구간을 구하시오. 이 신뢰구간의 의미를 해석하시오.\n\n$\\beta_1 \\pm t_{0.005}(6) se(\\hat{\\beta}_1)$\n\n이 신뢰구간이 $\\beta_1$을 포함하고 있을 것이라고 99% 확신한다.\n\n## (10)\n\n$x_1 = 20, x_2 = 27, x_3 = 60$에서 평균 물소비량, $E(y)$의 95% 신뢰구간을 구하시오.\n\n## (11)\n\n가설 $H_0 : \\beta_1 = 0, H_1 : \\beta_1 > 0$을 $\\alpha = 0.05$로 검정하시오.\n\n검정통계량 : $t_0 = \\frac{\\hat{\\beta}_1}{se(\\hat{\\beta}_1)}$\n\n$t_0 = 5.5211$\n\n기각역 : $t_{0.05}(6) = 1.9432$\n\n결론 : $H_0$ 기각 가능. 즉 유의수준 5%에서 $\\beta_2$는 0보다 크다고 할 수 있다.\n\n$T = \\frac{\\hat{\\beta}_i - \\beta^0_i}{\\hat{\\sigma} \\sqrt{c_{ii}}}$\n\n## (12)\n\n가설 $H_0 : \\beta_1 = \\beta_2 = \\beta_3$을 $\\alpha = 0.05$로 검정하시오.\n\n$H_0 : \\beta_1 = \\beta_2 = \\beta_3$\n\n$T= (0,1,-1,0) (0,0,1,-1)$\n\n$y= \\beta_0 + \\beta_1 x_1 + \\beta_1 x_2 + \\beta_1 x_3 + \\epsilon = \\beta_0 + \\beta_1(x_1+x_2+x_3)$\n\n검정통계량 : $\\frac{(SSE_{RM} - SSE_{FM})/r}{SSE_{FM}/(n-p-1)}$\n\n관측값 $f_0 = 15.968$\n\n기각역 : $f_0 > 5.1433$\n\n결론 : 기각할 수 있다.\n\n## (13)\n\n가설 $H_0 : \\beta_1 = \\beta_2 + 3$을 $\\alpha = 0.05$로 검정하시오.\n\n$H_0 : \\beta_1 = \\beta_2 = \\beta_3$\n\n$T= (0,1,-1,0)$\n\n$y = \\beta_0 + (\\beta_2+3)x_1 + \\beta_2 x_2 + \\beta_3 x_3 + \\epsilon$\n$y - 3x_1 = \\beta_0 + \\beta_2(x_1 + x_2) + \\beta_3 x_3 + \\epsilon$\n\n검정통계량 : $\\frac{(SSE_RM - SSE_FM)/r)}{(SSE_FM/(n-p-1))}$\n\n관측값 $f_0 = 5311.082$\n\n기각역 : $f_0 > 5.9874$\n\n결론 : 기각할 수 있다.\n\n## (14)\n\n$x_1 = 20, x_2 = 27, x_3 = 60$에서 $E(y)$에 관한 가설 $H_0 : E(y) = 3.5, H_1 : E(y) ̸\\neq 3.5$를 $\\alpha = 0.05$로 검정하시오.\n\nsy 풀이\n\n$T_0 = \\frac{\\hat{y} - E(y)}{\\sqrt{Var{\\hat{y}}}} = \\frac{\\hat{y} - E(Y)}{\\sqrt{x^\\top (X^\\top X)^{-1} x MSE}} \\sim t(n-1)$\n\n$Var{y} = x_i (X^\\top X)^{-1} x_i^\\top \\sigma^2$\n\n$F_0=-0.16663$ > $t_{0.025}(9)=-0.5097$ 로 귀무가설을 기각하지 못하여 $E(y) = 3.5$라는 결론이 나온다.\n\n# 4. \n\n중회귀모형, $y = X\\beta + \\epsilon, \\epsilon \\sim N(0_n, I\\sigma^2)$에서 $X$ 가 $n \\times (p + 1)$행렬이고 rank가 $p + 1$이라면 적합된 모형 $\\hat{y} = X\\hat{\\beta}$에 대하여\n$$\\sum^{n}_{j=1} Var(\\hat{y}_j ) = (p + 1)\\sigma^2$$\n이 됨을 증명하여라.\n\n$\\hat{\\bf{y}}=  X\\hat{\\beta} = X(X^\\top X)^{-1} X^\\top y = Hy$\n\n$Var(X\\hat{\\beta}) = XVar(\\hat{\\beta})X^\\top$\n\n$Var(\\hat{\\beta}) = Var((X^\\top X)^{-1} X^\\top y) = (X^\\top X)^{-1} X^\\top Var(y)X(X^\\top X)^{-1} = (X^\\top X)^{-1} X^\\top X(X^\\top X)^{-1} \\sigma^2 = (X^\\top X )^{-1} \\sigma^2$\n\n$Var(\\hat{y}) = Var(X\\hat{\\beta}) = X(X^\\top X)^{-1} X^\\top \\sigma^2$\n\n$\\to Var(\\hat{y}) = HVar(y) H^\\top = HH\\sigma^2 = H\\sigma^2$\n\n$\\star H^\\top = H, H^2 = H, Var(y) = I_n \\sigma^2$\n\n$\\sum^{n}_{j=1} Var(\\hat{y}_j) = tr(Var(\\hat{y})) = tr(H\\sigma^2) = \\sigma^2 tr(H) = tr((X^\\top X)^{-1} X^\\top X)\\sigma^2 = tr(I_{p+1})\\sigma^2 = (p+1)\\sigma^2$\n\n$\\star tr(X (X^\\top X)^{-1} X^\\top)$\n\n# 5. \n\n중회귀모형에서 다음을 증명하시오.\n\n## (1)\n\n$Cov(e, y) = \\sigma^2[I_n − X(X^\\top X)^{-1}X^\\top]$ \n\n$\\bf{e} = y - \\hat{y} = y - Hy = (I-H)y$\n\n$Cov(\\bf{e},y) = Cov((I-H)y,y) = (I-H)Var(y) = (I-H) \\sigma^2$\n\n$\\star Cov(Ax,y) = A Cov(X,Y)$\n\n$\\star Var(y) = \\sigma^2$\n\n## (2)\n\n$Cov(e, \\hat{y}) = \\mathbb{O}_n$\n\n$Cov(e(I - H)\\bf{y},Hy) = (I-H) Cov(y,y)H^\\top = (I-H)H\\sigma^2 = \\mathbb{O}_n \\sigma^2$\n\n$\\star Cov(Ax,By) = ACov(X,Y)B^\\top$\n\n$\\star H^\\top= H$\n\n$\\star H^2 = H$\n\n## (3)\n\n$Cov(e, \\hat{\\beta}) = \\mathbb{O}_{n\\times(k+1)}$\n\n$Cov((I-H)\\bf{y},(X^\\top X)^{-1} y) = (I-H) Cov(y,y) X (X^\\top X)^{-1} = (I - X(X^\\top X)^{-1} X^\\top ) X (X^\\top X)^{-1} \\sigma^2 = \\{ X(X^\\top X)^{-1} - X(X^\\top X)^{-1} \\} \\sigma^2 = \\mathbb{O}_{n \\times ([+1)}$\n\n## (4)\n\n$Cov(\\epsilon, \\hat{\\beta}) = \\sigma^2 X(X^\\top X)^{-1}$\n\n$\\bf{\\hat{\\beta}} = (X^\\top X)^{-1} X^\\top y = (X^\\top X)^{-1} X^\\top (X\\beta + \\epsilon) = \\beta + (X^\\top X)^{-1} X^\\top \\epsilon$\n\n$Cov(\\bf{\\epsilon} , \\beta + (X^\\top X)^{-1} X^\\top \\epsilon ) = Cov(\\epsilon, \\beta) + Cov(\\epsilon, \\epsilon)X(X^\\top X)^{-1} = \\sigma^2 X(X^\\top X)^{-1}$\n\n$\\star Cov(\\epsilon, \\beta) = 0$\n\n$\\star Cov(\\epsilon, \\epsilon) = I_n \\sigma^2$\n\n## (5)\n\n$\\sum^{n}_{j=1} e_j y_j = SSE$\n\n$\\sum^{n}_{j=1} e_j y_j = \\bf{e^\\top y} = \\{ (I - H)y\\}^\\top y = y^\\top (I-H)y$\n\n$\\star \\bf{e}^\\top (e_1, \\dots , e_n) = (y-\\hat{y})^\\top$\n\n$\\star \\bf{y}^\\top  = (y_1 , \\dots , y_n)$\n\n$SSE = \\sum^n_{j=1} (y_i - \\hat{y}_j)^2 = (\\bf{y} - \\hat{y} ) ^\\top ( y - \\hat{y} ) = e^\\top e = \\{ (I - H)y \\}^\\top \\{ (I - H)y \\} = y^\\top (I - H) (I-H)y = y^\\top (I - H)y$\n\n$\\star I - H_H+H^2 = I-H, H^2 = H$\n\n$\\therefore \\sum^{n}_{j=1} e_j y_j = SSE$\n\n## (6)\n\n$\\sum^{n}_{j=1} e_j \\hat{y}_j = 0$\n\n$\\sum^{n}_{j=1} \\bf{e_j \\hat{y}_j} = e^\\top \\hat{y} = y^\\top (I-H) Hy = y^\\top_{1\\times n} \\mathbb{O}_{n\\times n} y_{n \\times 1} = 0$\n\n$\\star H - H^2 = H - H = \\mathbb{O}_{n \\times n}$\n\n# 1 plus.\n\n다음의 데이터에 대하여 모형 $y_i = \\beta_0 + \\beta_1 x_{1j} + \\beta_2 x_{2j} + \\epsilon_j, \\epsilon  \\sim N(0,\\sigma^2)$이 옳다고 가정하고 질문에 답하여라.\n\n|y|1|5|0|4|4|-1|\n|:--:|:--:|:--:|:--:|:--:|:--:|:--:|\n|x_1|1|2|1|3|3|3|\n|x_2|1|1|2|1|2|3|\n\n## (1)\n\n$X^\\top X, X^\\top y y^\\top y$와 $(X^\\top X)^{-1}$ 을 구하시오.\n\n## (2)\n\n$\\beta_0, \\beta_1, \\beta_2, \\sigma^2$를 추정하시오.\n\n## (3)\n\n$x_1 = x_2 = 2$에서 $E(y)$의 95% 신뢰구간을 구하시오.\n\n## (4)\n\n$\\beta_1$의 90% 신뢰구간을 구하시오.\n\n## (5)\n\n가설 $H_0: \\beta_1 = \\beta_2, H_1: \\beta_1 \\neq \\beta_2$을 유의수준 $\\alpha = 0.05$\n\n**T검정 방법**\n\n## (6)\n\n가설 $H_0 : \\beta_1 = 0, H_1 : \\beta_1 \\neq 0$을 유의수준 $\\alpha = 0.1$로 검정하시오. 위 (3)의 질문의 결과와 어떠한 연관을 지을 수 있는가?\n\n## (7)\n\n$x_1 = 2, x_2 = 3$에서 가설 $H_0 : E(y) = 4,H_1 : E(y) \\neq 4$를 $\\alpha = 0.05$로 검정하시오 \n\n## (8)\n\n가설 $H_0 : \\beta_2 = 0, H_1: \\beta_2 <0$을 $\\alpha = 0.05$ 로 검정하시오.\n\n## (9)\n\n가설 $H_0: \\beta_1 = 2\\beta_2, H_1 : \\beta_1 \\neq 2\\beta_2 $를 $\\alpha=0..05$로 검정하시오.\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"2022-11-21-rl-HW3.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"pulse","code-copy":false,"title-block-banner":true,"title":"Regression HW 3","author":"SEOYEON CHOI","date":"2022-11-21","categories":["Advanced Regression Analysis"]},"extensions":{"book":{"multiFile":true}}}}}