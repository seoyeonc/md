{"title":"Regression HW 2","markdown":{"yaml":{"title":"Regression HW 2","author":"SEOYEON CHOI","date":"2022-10-23","categories":["Advanced Regression Analysis"]},"headingText":"1.","containsRefs":false,"markdown":"\n\n고급회귀분석 과제, CH03,04,05\n\n---\n\n고급회귀분석 두번째 과제입니다.\n\n \n\n제출 기한 : 10월 23일 \n\n(마지막 문제는 R을 이용해서 풀이해도 됨)\n\n \n\n제출 방법\n\n  - 직접 제출(607호) 도 가능하지만, \n\n  - 문서 작성 후 pdf로 변환(★★★)하여 lms에 제출을 추천\n\n  (pdf 아닌 문서는 미제출로 간주)\n\n \n\n주의사항\n\n- pdf로 꼭 변환하여 제출\n\n- 풀이가 꼭 있어야 함 (답만 적혀 있는 경우 '0'점 처리)\n\n- 부정행위 시 'F'학점 \n\n- 계산은 R로 해도 되지만 계산 풀이 과정이 꼭 있어야 함!!\n\n예) R에서 lm으로 beta의 추정량을 구하면 안 됨. 수업 시간에 배운 식으로 풀이를 적어야 함.\n\n \n\n \n\n************ R을 이용해서 푸는 문제는, R 코드도 같이 업로드.\n\n---\n\n\n단순회귀에서 회귀제곱합,\n$$SSE = \\sum^{n}_{i=1} (y_i - \\hat{y}_i)^2$$\n을 이차형식 $y^\\top B y$ 로 표현하시오. 이 이차형식의 분포를 구하고, 또한 기대치를 ⟨정리 5.1⟩에 의하여 구하시오\n\n**Answer**\n\n$\\sum^{n}_{i=1} (y_i - \\hat{y}_i)^2$\n\n$= \\sum^{n}_{i=1} (y_i - \\hat{y}_i)^\\top(y_i - \\hat{y}_i)$\n\n$= (\\bf{y} - \\hat{\\bf{y}})^\\top(\\bf{y} - \\hat{\\bf{y}})$\n\n$= (\\bf{y} - \\bf{X}b)^\\top(\\bf{y} - \\bf{X}b)$\n\n$= \\bf{y}^\\top\\bf{y} - \\bf{y}^\\top X\\bf{b} - \\bf{b}^\\top\\bf{X}^\\top\\bf{y} + \\bf{b}^\\top\\bf{X}^\\top\\bf{X}\\bf{b}$\n\n$= \\bf{y}^\\top\\bf{y} - 2\\bf{y}^\\top\\bf{X}\\bf{b} + \\bf{b}^\\top\\bf{X}^\\top\\bf{X}\\bf{b}$\n\n$= \\bf{y}^\\top\\bf{y} - \\bf{y}^\\top\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top\\bf{y}$\n\n$= \\bf{y}^\\top(\\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)\\bf{y}$\n\n$\\frac{\\sum^{n}_{i=1} (y_i - \\hat{y}_i)^2}{\\sigma^2} = \\bf{y}^\\top \\bf{B} \\bf{y}$\n\n<정리5.3>\n\n만약 $y \\sim N(\\mu,V)$이면,\n\n$$y^\\top A y \\sim \\chi^2 (r(A),\\frac{1}{2}\\mu^\\top A \\mu ) \\to \\text{AV : independent matrix}$$\n\n$\\frac{SSE}{\\sigma^2} = \\bf{y}^\\top\\frac{1}{\\sigma^2}(\\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)\\bf{y}$\n\n$\\frac{SSE}{\\sigma^2} \\sim \\chi^2 (r(A),\\frac{1}{2}\\mu^\\top A \\mu )$\n\n$\\star y_i \\sim N(\\beta_0 + \\beta_1 x_i, \\sigma^2)$\n\n$\\star \\bf{y}^\\top \\sim N(\\mu, I\\sigma^2)$\n\n$\\bf{B} = \\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top$\n\n$\\bf{B}\\bf{B} = (\\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)(\\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)$ \n\n$= \\bf{I_n} - 2\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top + \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top = \\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top = \\bf{B}$\n\n$\\therefore \\bf{B} \\text{ is an independendt matrix}$\n\n$r(\\bf{B}) = tr(\\bf{B}) = tr(\\bf{I_n} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top) = tr(\\bf{I_n}) - tr(\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top) =   n - (p+1)$\n\n$V = I\\sigma^2$\n\n$\\therefore \\bf{BV = BVBV}$\n\n$\\therefore \\bf{BV} \\text{ is an independent matrix}$\n\n$\\mu^\\top \\bf{B} \\mu = \\mu^\\top (\\bf{I}-\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)\\mu = \\beta^\\top \\bf{X}^\\top (\\bf{I} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)\\bf{X}\\beta = \\beta^\\top \\bf{X}^\\top (\\bf{X} - \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top\\bf{X})\\beta = 0$\n\n$\\star \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top\\bf{X} = \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top \\bf{X} = \\bf{X}$\n\n$\\frac{SSE}{\\sigma^2}\\sim \\chi^2_{(n-(p+1))}$\n\n<정리 5.1> 만약 $y \\sim N(\\mu, V)$이면,\n$$E(y^\\top A y) = tr(AV) + \\mu^\\top A \\mu, Cov(y,y^\\top A y ) = 2 V A \\mu$$\n\n$E(SSE) = tr(BV) + \\mu^\\top B \\mu = tr(\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top V) + \\mu^\\top \\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top \\mu =  (n-(p+1))\\sigma^2 + 0 = (n - (p+1))\\sigma^2$\n\n$Cov(y,y^\\top B y) = 2VB\\mu = 2 \\sigma^2 (I-\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)\\mu = 2 \\sigma^2 (I-\\bf{X}(\\bf{X}^\\top\\bf{X})^{-1}\\bf{X}^\\top)\\bf{X}\\beta = 0$\n\n---\n\n# 2.\n\n만약\n$$y_1 = \\beta_0 + \\epsilon_1$$\n$$y_2 = 2\\beta_0 - \\beta_1 + \\epsilon_2$$\n$$y_3 = \\beta_0 + 2\\beta_1 + \\epsilon_3$$\n이고, $E(\\epsilon_i) = 0, i = 1, 2, 3$이라면 $\\beta_0$ 와 $\\beta_1$ 의 최소제곱추정값은 무엇인가? $y_i, i = 1, 2, 3$의 함수로써 나타내어라. 그리고 이 경우의 잔차제곱합(residual sum of squares)을 구하시오.\n\n**Answer**\n\n$\\epsilon_1 = y_1 + \\beta_0, \\epsilon_2 = y_2 - 2\\beta_0 + \\beta_1, \\epsilon_3 = y_3 - \\beta_0 - 2\\beta_1$\n\n$S = (y_1 - \\hat{\\beta}_0)^2 + (y_2 - 2\\hat{\\beta}_0 + \\hat{\\beta}_1)^2 + (y_3 - \\hat{\\beta}_0 - 2\\hat{\\beta}_1)^2$\n\n$\\frac{\\partial S}{\\partial \\beta_0} = -2(y_1 - \\hat{\\beta}_0) -4(y_2 - 2\\hat{\\beta}_0 + \\hat{\\beta}_1) -2(y_3 - \\hat{\\beta}_0 - 2\\hat{\\beta}_1)$\n\n$= -2y_1 + 2\\hat{\\beta}_0 -4y_2 + 8\\hat{\\beta}_0 -4\\hat{\\beta}_1 -2y_3 +2\\hat{\\beta}_0 +4\\hat{\\beta}_1$\n\n$= -2y_1 -4y_2 -2y_3 + 12\\hat{\\beta}_0 = 0$\n\n$\\therefore \\hat{\\beta}_0 = \\frac{1}{12}(2y_1 + 4y_2 + 2y_3) = \\frac{1}{6}(y_1 + 2y_2 + y_3)$\n\n$\\frac{\\partial S}{\\partial \\beta_1} = 2(y_2 - 2\\hat{\\beta}_0 + \\hat{\\beta}_1) -4(y_3 - \\hat{\\beta}_0 - 2\\hat{\\beta}_1)$\n\n$= 2y_2 - 4\\hat{\\beta}_0 + 2\\hat{\\beta}_1 -4y_3 +4 \\hat{\\beta}_0 + 8\\hat{\\beta}_1$\n\n$= 2y_2 -4y_3 + 10\\hat{\\beta}_1 = 0$\n\n$\\therefore \\hat{\\beta}_1 = \\frac{1}{10}(-2y_2 + 4y_3) = \\frac{1}{5}(-y_2 + 2y_3)$\n\n$\\text{Residual sum of squares  }S = (y_1 - \\hat{\\beta}_0)^2 + (y_2 - 2\\hat{\\beta}_0 + \\hat{\\beta}_1)^2 + (y_3 - \\hat{\\beta}_0 - 2\\hat{\\beta}_1)^2$\n\n$= y_2^2 + \\hat{\\beta}_0^2 - 2\\hat{\\beta}_0y_1 + y_2^2 - 4\\hat{\\beta}_0 y_2 + 2\\hat{\\beta}_1 y_2 - 4\\hat{\\beta}_0 \\hat{\\beta}_1 + \\hat{\\beta}_1^2 + y_3^2 -2\\hat{\\beta}_0 y_3 - 4 \\hat{\\beta}_1 y_3 + \\hat{\\beta}_0^2 + 4\\hat{\\beta}_0\\hat{\\beta}_ + 4\\hat{\\beta}_1^2$\n\n$= y_1^2 + y_2^2 + y_3^2 + 2\\hat{\\beta}_0^2 + 5\\hat{\\beta}_1^2 + \\hat{\\beta}_0(-2y_1 -4y_2 -2y_3) + \\hat{\\beta}_1 (2y_2 -4y_3)$\n\n$= y_1^2 + y_2^2 + y_3^2 -10 \\hat{\\beta}_0^2 - 5\\hat{\\beta}_1^2$\n\n$= y_1^2 + y_2^2 + y_3^2 - \\frac{5}{18}(y_1 + 2y_2 + y_3)^2 - \\frac{1}{5}(-y_2 + 2y_3)^2$\n\n\n$= \\frac{13}{18} y_1^2 -\\frac{14}{45}y_2^2 -\\frac{70}{90}y3^2 -\\frac{10}{9}y_1y_2 -\\frac{5}{9} y_1y_3 - \\frac{32}{45}y_2y_3$\n\n$= \\frac{1}{90}(65y_1^2 -28 y_2^2 - 70y_3^2 -100y_1y_2 -50y_1y_3 - 64y_2y_3)$\n\n---\n\n# 3.\n\n단순회귀모형\n$$y_i = \\beta_0 + \\beta_1 x_i + \\epsilon_i, \\epsilon_i ~ N(0, \\sigma^2), i = 1, 2, \\dots , n$$\n에서 각각의 $x_i$ 가 $cx_i (c \\neq 0)$로 대체된다고 가정하자. $\\hat{\\beta}_0, \\hat{\\beta}_1, s^{2}_{y·x}, R^2$ 과 $H_0 : \\beta_1 = 0$에 대한 $t$−검정 결과는 어떤 영향을 받는가?\n\n**Answer**\n\n$S = \\sum^n_{i=1}\\epsilon^2_i = \\sum^n_{i=1} \\{ y_i - (\\beta_0 + \\beta_1 c x_i)\\}^2$\n\n$\\frac{\\partial S}{\\partial \\beta_1} = -2\\sum^n_{i=1} c x_i (y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 c x_i) = \\sum^n_{i=1} c x_i (y_i - \\hat{y}) = \\sum^n_{i=1} c x_i e_i = 0$\n\n$= \\sum^n_{i=1} c x_i (y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 c x_i ) =\\sum^n_{i=1} c x_i (y_i - \\bar{y} + \\hat{\\beta}_1 c\\bar{x} - \\hat{\\beta}_1 c x_i) = \\sum^n_{i=1} c x_i(y_i - \\bar{y}) - \\hat{\\beta}_1 \\sum^n_{i=1} c x_i (c x_i - c\\bar{x})$\n\n$\\star \\sum^n_{i=1} c x_i(y_i - \\bar{y}) = \\sum^n_{i=1}(c x_i - c\\bar{x} + c\\bar{x})(y_i - \\bar{y}) = c\\sum^n_{i=1}(x_i - \\bar{x})(y_i - \\bar{y}) + \\sum^n_{i=1} c \\bar{x}(y_i - \\bar{y}) = c S_{xy}$\n\n$\\star \\hat{\\beta}_1 \\sum^n_{i=1} c x_i (c x_i - c\\bar{x}) = \\hat{\\beta}_1 \\sum^n_{i=1} (c x_i - c \\bar{x} + c \\bar{x}) (c x_i - c \\bar{x}) = \\hat{\\beta}_1 \\{ \\sum^n_{i=1} (c x_i - c \\bar{x})(c x_i - c \\bar{x}) + \\sum^n_{i=1} c^2 \\bar{x}( x_i -  \\bar{x}) \\} = c^2 \\hat{\\beta}_1 S_{xx}$\n\n$c S_{xy} - \\hat{\\beta}_1 c^2 S_{xx} = 0$\n\n$\\hat{\\beta}_1 = \\frac{S_{xy}}{c S_{xx}}$\n\n$\\hat{\\beta}_1$ 은 $\\frac{1}{c}$배가 되었다.\n\n$\\frac{\\partial S}{\\partial \\beta_0} = -2\\sum^n_{i=1} (y_i - \\hat{\\beta}_0 - \\hat{\\beta}_1 c x_i) = \\sum^n_{i=1} (y_i - \\hat{y}_i) = \\sum^n_{i=1}e_i = 0$\n\n$n \\hat{\\beta}_0 = \\sum^n_{i=1}y_i - \\frac{1}{c} \\hat{\\beta}_1 c \\sum^n_{i=1} x_i$\n\n$\\hat{\\beta}_0 = \\frac{1}{n} \\sum^n_{i=1} y_i - \\frac{1}{c}\\hat{\\beta}_1 c \\frac{1}{n}\\sum^n_{i=1} x_i = \\bar{y} - \\hat{\\beta}_1 \\bar{x}$\n\n$\\hat{\\beta}_0$은 $x_i$가 $cx_i$로 대체되었을때 영향을 받지 않았다.\n\n$S_{yx} = c \\sum^n_{i=1}(x_i - \\bar{x})(y_i - \\bar{y})$\n\n$S^2_{yx} = c^2 \\sum^n_{i=1}(x_i - \\bar{x})^2(y_i - \\bar{y})^2$\n\n$\\star S_{xx} = c^2 \\sum^n_{i=1} (x_i - \\bar{x})(x_i - \\bar{x})$\n\n$\\star S_{yy} = \\sum^n_{i=1} (y_i - \\bar{y})(y_i - \\bar{y})$\n\n$R^2 = r_{xy}^2 = \\frac{S_{xy}^2}{S_{xx}S_{yy}} = \\frac{c^2 \\sum^n_{i=1}(x_i - \\bar{x})^2(y_i - \\bar{y})^2}{(c^2 \\sum^n_{i=1} (x_i - \\bar{x})(x_i - \\bar{x}))(\\sum^n_{i=1} (y_i - \\bar{y})(y_i - \\bar{y}))} = \\frac{ \\sum^n_{i=1}(x_i - \\bar{x})^2(y_i - \\bar{y})^2}{( \\sum^n_{i=1} (x_i - \\bar{x})(x_i - \\bar{x}))(\\sum^n_{i=1} (y_i - \\bar{y})(y_i - \\bar{y}))}$\n\n$R^2$은 영향을 받지 않았다.\n\n회귀직선의 유의성 검정 $H_0 : \\beta_1 = 0 \\text{ vs. } H_1: \\beta_1 \\neq 0$\n\n검정통계량 $F = \\frac{MSR}{MSE} = \\frac{SSR/1}{SSE/(n-2)} \\sim_{H_0} F(1,n-2)$\n\n검정통계량 계산에도 영향을 주지 않았기 때문에 $\\text{t test}$ 결과는 $x_i$에 $c$배를 한 후에도 같은 결과가 나온다.\n\n---\n\n# 4.\n\n생선을 잡아서 얼음창고에 일주일 동안 보관한 후에 생선의 신선도가 어느 정도 변하는가를 실험하였다. 신선도를 $y$로 놓고 10점 만점으로 하여 0점이 신선도가 전혀 없는 것이고 10점이 가장 좋은 경우이다. 설명변수 $x$는 생선을 잡은 지 $x$시간이 경과한 후에 얼음창고에 넣는 것을 가리킨다. 실험으로 10개의 데이터를 얻었다.\n\n|$y$(신선도)|8.5|8.4|7.9|8.1|7.8|7.6|7.3|7.0|6.8|6.7|\n|---|---|---|---|---|---|---|---|---|---|---|\n|$x$(경과시간)|0|0|3|3|6|6|9|9|12|12|\n\n## (1)\n\n선형회귀모형 ($y = \\beta_0 + \\beta_1 x + \\epsilon$)이 타당한가를 유의수준 $\\alpha = 0.05$를 사용하여 적합결여검정을 행하라.\n\n**Answer**\n\n$H_0 : E(Y|X = x) = \\beta_0 + \\beta_1 x$\n\n$H_1 : E(Y|X=x) \\neq \\beta_0 + \\beta_1 x$\n\n산점도\n\n우하향하는 모습이다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$\\hat{y} = 8.46 - 0.1417x$\n\n$H_0 : \\beta_1 = 0$\n\n$H_1 : \\beta_1 \\neq 0$\n\nF값이 유의수준 0.05에서 기준 F보다 크기 때문에 $H_0$ 기각하고, $\\beta_1$ 은 유의미하다.\n\n$\\hat{y} = 8.46 - 01417x$\n\n$H_0 : E(Y|X = x) = \\beta_0 + \\beta_1 x$ 기각못함\n\n## (2)\n\n선형회귀모형이 타당한 경우, 신선도의 점수가 시간당 얼마만큼이나 떨어지는가를 95% 신뢰계수를 가지고 구간추정하라(즉, $\\beta_1$의 구간추정).\n\n**Answer**\n\n$\\hat{\\beta}_1$의 $100(1-\\alpha)$%의 신뢰구간\n\n$\\hat{\\beta}_1 \\pm t_{\\alpha/2}(n-2)\\frac{\\sqrt{MSE}}{\\sqrt{S_{xx}}}$\n\n신뢰계수가 0을 포함하지 않는다. 신뢰구간에서 $\\beta_1$이 유의미함을 알 수 있다.\n\n---\n\n5.  두 타이어회사 A, B에서 생산되는 타이어를 비교하기 위하여 고속도로에서 트럭이 달리는 상황을 모의실험(simulated experiment)하여 다음의 데이터를 얻었다. $x$는 트럭이 달리는 속도이고 $y$는 타이어가 마모되기까지의 총 주행거리이다.\n\n|$x_{1j}$|10|20|30|40|50|60|70|\n|---|---|---|---|---|---|---|---|\n|$y_{1j}(A)$|9.8|12.5|14.9|16.5|22.4|24.1|25.8|\n|$y_{2j}(B)$|15.0|14.5|16.5|19.1|22.3|20.8|22.4|\n\n(1) 산점도를 그리시오.\n\n**Answer**\n\n(2) 각 회사별로 속도와 총주행거리 간의 회귀모형을 구한다면, 두 개의 직선이 동일하다고 볼수 있는가? 유의수준 $\\alpha = 0.05$로 가설검정하시오.\n\n**Answer**\n\n$H_0: \\beta_{01} = \\beta_{02} \\text{ and } \\beta_{11} = \\beta_{12}$\n\n$H_1: \\beta_{01} \\ne \\beta_{02} \\text{ or } \\beta_{11} \\ne \\beta_{12}$\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$yA = 6.757143  + 0.2810714x$\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$yB = 12.85714 + 0.145x$\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$\\text{y} = 9.807143  +0.2130357\\text{x}$\n\n가설\n\n$H_0 : \\beta_{01} = \\beta_{02} \\text{ and } \\beta_{11} = \\beta_{12}$\n\n$H_1 : \\beta_{01} \\neq \\beta_{02} \\text{ or } \\beta_{11} \\neq \\beta_{12}$\n\n검정통계량\n\n$F_0 = \\frac{SSE(R) - SSE(F)}{df_R-df_F} \\times \\frac{df_F}{SSE(F)}$\n\n$H_0 : \\beta_{01} = \\beta_{02} \\text{ and } \\beta_{11} = \\beta_{12}$ 기각\n\n## (3)\n\n관심의 대상이 $x$가 증가함에 따라 $y$ 가 얼마나 증가하는가에 있다. 두 회사의 타이어에 대하여 각각 회귀모형을 적합했을 때, 기울기가 같은지 유의수준 5%로 검정하시오.\n\n**Answer**\n\n기울기 비교에 대한 가설\n\n$H_0 : \\beta_{11} = \\beta_{12} \\text{ vs. } H_1 : \\beta_{11} \\neq \\beta_{12}$\n\n검정통계량\n\n$t_0 = \\frac{ \\hat{\\beta}_{11} - \\hat{\\beta}_{12} }{ \\sqrt{ \\hat{Var}( \\hat{\\beta}_{11} - \\hat{\\beta}_{12} ) } }$\n\n$\\text{Degree of Freedom} = t((n_1 - 1) + (n_2 - 1))$\n\n$\\hat{Var}( \\hat{\\beta}_{11} - \\hat{\\beta}_{12} ) = MSE(F) [\\frac{1}{\\sum(x_{1j} - \\bar{x}_1)^2} + \\frac{1}{\\sum(x_{2j} - \\bar{x}_2)^2}]$\n\n$H_0 : \\beta_{11} = \\beta_{12}$ 기각\n\n---\n\n# 6. \n\n**R 실습**. 아마존 강 수위 문제 아마존 강 유역은 지구상의 가장 큰 열대림 지역이지만 대부분의 다른 자연자원과 마찬가지로 개발의 손길이 미치면서 열대림이 급속히 파괴됐다. 1970년대 이후 아마존 상류지역에 도로가 건설되면서 인구가 빠르게 증가되었고 대규모의 삼림파괴가 이뤄졌다. 강수량과 유수량이 모두 영향을 받을 수 있기 때문에 이것은 결국 아마존 강 전체에 영향을 미치는 심각한 기후학적 및 수문학적 변화를 가져왔다. 다음의 표는 페루 이키토스(Iquitos)에서 1962년부터 1978년까지 기록한 아마존 강 최고수위 (High)와, 최저수위 (Low)를 기록한 것이다(단위: 미터).1962년부터 1969년까지의 데이터는 개발 이전에 수집된 데이터이고, 1970년부터 1978년까지의 데이터는 개발이후에 관측된 데이터를 나타낸다. 이 데이터는 아마존 상류지역의 삼림파괴가 아마존 유역의 강 수위에 변화를 일으켰는지 분석하고자 한다. 우리의 관심은 시간에 따른 아마존 강 수위 변화여부이다. 예를 들어, 우리가 다음을 적합한다면\n\n$$\\text{High} = \\beta_0 + \\beta_1 \\times \\text{Year} + \\epsilon$$\n\n(a) $\\beta_1 = 0$은 시간에 따른 아마존 강의 최고수위에 아무런 (선형)변화가 없다는 것을 의미하고,\n\n(b) $\\beta_1 > 0$은 아마존 강의 최고수위가 증가된 것을 의미하는데, 이것은 해마다 아마존 강의 흐르는 물이 늘어난 것을 나타낼 수 있다.\n\n(c) $\\beta_1 < 0$은 시간에 따라 아마존 강의 최고수위가 낮아진 것을 의미하는데, 이것은 해마다 아마존 강의 흐르는 물이 줄어든 것을 의미한다. 다음의 물음에 답하시오.\n\n$$\\text{Table 1: 아마존 강 데이터 (Amazon River data)}$$\n\n|Year|High(m)|Low(m)|\n|:---:|:---:|:---:|\n|1962|25.82|18.24|\n|1963|25.35|16.50|\n|1964|24.29|20.26|\n|1965|24.05|20.97|\n|1966|24.89|19.43|\n|1967|25.35|19.31|\n|1968|25.23|20.85|\n|1969|25.06|19.54|\n|1970|27.13|20.49|\n|1971|27.36|21.91|\n|1972|26.65|22.51|\n|1973|27.13|18.81|\n|1974|27.49|19.42|\n|1975|27.08|19.10|\n|1976|27.51|18.80|\n|1977|27.54|18.80|\n|1978|26.21|17.57|\n\n## (1)\n\nHigh와 Year, Low와 Year, 그리고 High와 Low에 대해 산점도를 그리시오.\n\n**Answer**\n\n양의 기울기로 선형 관계를 갖는 모습이다.\n\n이차함수 모양의 연관이 있는 모양새이다.\n\n관련이 있는지 모르겠다.\n\n## (2)\n\nYear에 대한 High, Year에 대한 Low, 그리고 Low에 대한 High의 회귀모형을 구하시오. 3개 회귀모형의 결과를 요약하고, 각 모형별로 회귀계수의 의미를 설명하시오.\n\n**Answer**\n\n**Year에 대한 High의 회귀모형**\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$\\text{High} = -330.21235 + 0.18088\\text{Year}$\n\nR결과와 비교\n\nR결과 해석 \n- beta0과 beta1이 5%보다 유의확률이 작아 유의미하다.\n- 모형의 설명력은 50%정도에 머문다.\n- 모형의 p값이 0.05보다 작아 유의미하다고 볼 수 있다.\n\n**Year에 대한 Low의 회귀모형**\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$\\text{Low} =  35.106961 -0.007892\\text{Year}$\n\nR결과와 비교\n\nR결과 해석 \n- beta0과 beta1이 5%보다 유의확률이 커 유의미하지 않다.\n- 모형의 설명력은 굉장히 낮았다.\n- 모형의 p값이 0.05보다 커 유의미하지 않다.\n\n**Low에 대한 High의 회귀모형**\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\n$\\text{High} = 26.40088 -0.01406\\text{Low}$\n\nR결과와 비교\n\nR결과 해석 \n- beta0은 유의미 하지만 beta1이 5%보다 유의확률이 커 유의미하지 않다.\n- 모형의 설명력은 굉장히 낮았다.\n- 모형의 p값이 0.05보다 커 유의미하지 않다.\n\n모형 정리\n\n$\\text{Low} =  35.106961 -0.007892\\text{Year}$ 모형의 의미\n- $\\beta_0 = 35.106961$: 해당 모형에서 시간에 영향을 받지 않았을때의 아마존 강의 최저 수위가 35.106961m이다.\n- $\\beta_1 = -0.007892$: 아마존 강의 최저수위가 0.007892m만큼 감소한 것을 의미하는데, 이것은 해마다 아마존 강의 흐르는 물이 감소하는 것을 의미하지만, 0에 가까운 값으로서 영향이 미세해 보인다.\n\n$\\text{High} = -330.21235 + 0.18088\\text{Year}$ 모형의 의미\n- $\\beta_0 = -330.21235$: 해당 모형에서 시간에 영향을 받지 않았을때의 아마존 강의 최고 수위가 -330.21235m이다.\n- $\\beta_1 = 0.18088$: 아마존 강의 최고수위가 0.18088m만큼 증가된 것을 의미하는데, 이것은 해마다 아마존 강의 흐르는 물이 0.18088m 늘어난 것을 나타낼 수 있다. 이 모형에서도 영향이 크게 끼치지 않는 것 같다.\n\n$\\text{High} = 26.40088 -0.01406\\text{Low}$ 모형의 의미\n- $\\beta_0 = -26.40088$: 해당 모형에서 최저수위의 영향을 받지 않았을 때의 아마존 강의 최고수위가 026.40088m 라는 것을 의미한다.\n- $\\beta_1 = -0.014061$: 아마존 강의 최고수위가 최저수위가 1m 증가함에 따라 -0.0014061m 만큼 감소함을 의미한다. 아마존 강의 최저수위는 최고수위에 미치는 영향이 미미해 보인다.\n\n## (3)\n\n이 자료를 근거로 우리는 삼림파괴가 아마존 강 수위의 변화를 일으킨다고 할 수 있는가?\n\n**Answer**\n\n- 1970년대 이후 삼림파괴가 이루어졌다. 구간을 나누어 보지 않는 이상 삼림파괴가 아마존 강 수위의 변화를 일으켰다는 판단은 섣불러 보인다.\n- 모형만 봐도 시간과 아마존 강의 최고수위 및 최저수위의 영향과 아마존 강의 최저수위 및 최고수위 간의 영향이 거의 없어보인다. 모두 1도 넘지 않았기도 하다.\n- 따라서 삼림파괴가 아마존 강 수위의 변화를 일으켰다고 2번의 근거로는 할 수 없다.\n\n## (4)\n\n아마존강의 최저수위와 최고수위와의 산점도를 1960년대, 1970년대 자료별로 다르게 그리고, 각각의 회귀선을 적합하시오.\n\n**Answer**\n\n1960년대 아마존강의 최저수위와 최고수위와의 산점도\n\n1960년대 아마존강의 최저수위와 최고수위와의 회귀선\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\nR결과 비교\n\nR결과 비교\n\n1970년대 아마존강의 최저수위와 최고수위와의 산점도\n\n1970년대 아마존강의 최저수위와 최고수위와의 회귀선\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주기 위해 $x_i - \\bar{x}, y_i - \\bar{y}$를 구했다.\n\n- $S_{xx}, S_{yy},S_{xy}$를 구해주었다.\n\n$\\hat{\\beta_1} = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0} = \\bar{y} - \\hat{\\beta_1}\\bar{x}$\n\nR결과 비교\n\nR결과 비교\n\n## (5)\n\n아마존강의 최저수위와 최고수위와의 관계가 1960년대와 1970년대에 따라 차이가 있는가? 두 회귀모형의 동일성 여부를 유의수준 $\\alpha = 0.01$에서 검정하시오.\n\n**Answer**\n\n가설\n\n$H_0 : \\beta_{01} = \\beta_{02} \\text{ and } \\beta_{11} = \\beta_{12}$\n\n$H_1 : \\beta_{01} \\neq \\beta_{02} \\text{ pr } \\beta_{11} \\neq \\beta_{12}$\n\n(2)에서 구했던 것\n\n$\\text{High} = 26.40088 -0.01406\\text{Low}$\n\nR결과와 비교\n\n$\\text{1960 High} = 29.8367  +  -0.2492\\text{Low}$\n\n$\\text{1970 High} = 26.8016  +  0.0163\\text{Low}$\n\n검정통계량\n\n$F_0 = \\frac{SSE(R) - SSE(F)}{df_R} - \\times \\frac{df_F}{SSE(F)}$\n\n## (6)\n\n(4)에서 구한 두 회귀모형의 기울기가 같은지 유의수준 $\\alpha = 0.01$에서 검정하시오.\n\n**Answer**\n\n기울기 비교에 대한 가설\n\n$H_0 : \\beta_{11} = \\beta_{12} \\text{ vs. } H_1 : \\beta_{11} \\neq \\beta_{12}$\n\n검정통계량\n\n$t_0 = \\frac{ \\hat{\\beta}_{11} - \\hat{\\beta}_{12} }{ \\sqrt{ \\hat{Var}( \\hat{\\beta}_{11} - \\hat{\\beta}_{12} ) } }$\n\n$\\text{Degree of Freedom} = t((n_1 - 1) + (n_2 - 1))$\n\n$\\hat{Var}( \\hat{\\beta}_{11} - \\hat{\\beta}_{12} ) = MSE(F) [\\frac{1}{\\sum(x_{1j} - \\bar{x}_1)^2} + \\frac{1}{\\sum(x_{2j} - \\bar{x}_2)^2}]$\n\n$H_0 : \\beta_{11} = \\beta_{12}$ 채택\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"2022-10-23-rl-HW2.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"pulse","code-copy":false,"title-block-banner":true,"title":"Regression HW 2","author":"SEOYEON CHOI","date":"2022-10-23","categories":["Advanced Regression Analysis"]},"extensions":{"book":{"multiFile":true}}}}}