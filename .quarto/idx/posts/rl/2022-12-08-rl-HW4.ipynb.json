{"title":"Regression HW 4","markdown":{"yaml":{"title":"Regression HW 4","author":"SEOYEON CHOI","date":"2022-12-08","categories":["Advanced Regression Analysis"]},"headingText":"1.","containsRefs":false,"markdown":"\n\n고급회귀분석 과제, CH13\n\n네 번째 과제입니다.\n\n \n\n제출 기한 12월 8일\n\n \n\n행렬 계산은 R로 해도 됩니다.\n\n그리고, 계산 후에 R 함수(예:lm)를 이용하여 결과 확인하고, 본인의 풀이가 맞는지 결과 확인해보세요.\n\n \n\n제출 방법\n\n  - 직접 제출(607호) 도 가능하지만, \n\n  - 문서 작성 후 pdf로 변환(★★★)하여 lms에 제출을 추천\n\n  (pdf 아닌 문서는 미제출로 간주)\n\n  - ★★★ 파일이름 : 이름(학번)_HW04.pdf \n\n \n\n주의사항\n\n- pdf로 꼭 변환하여 제출\n\n- 풀이가 꼭 있어야 함 (답만 적혀 있는 경우 '0'점 처리)\n\n- 부정행위 시 'F'학점 \n\n- 계산은 R로 해도 되지만 계산 풀이 과정이 꼭 있어야 함(수업 시간에 배운 식으로 풀이를 적어야 함.)!!\n\n- lm등의 함수를 이용한 풀이는 정답 확인용으로만 사용.\n\n---\n\n\n|일련번호|$y$(총 소요시간)|$x_1$(적성검사점수)|$x_2$(성별)|학력|\n|:---:|:---:|:---:|:---:|:---:|\n|1|17|151|남자|대|\n|2|26|92|남자|고|\n|3|21|175|남자|대|\n|4|30|31|남자|고|\n|5|22|104|남자|고|\n|6|1|277|남자|대학원|\n|7|12|210|남자|대학원|\n|8|19|120|남자|대|\n|9|4|290|남자|대학원|\n|10|16|238|남자|대학원|\n|11|28|164|여자|대학원|\n|12|15|272|여자|대학원|\n|13|11|295|여자|대학원|\n|14|38|68|여자|고|\n|15|31|85|여자|대|\n|16|21|224|여자|대학원|\n|17|20|166|여자|대|\n|18|13|305|여자|대학원|\n|19|30|124|여자|대|\n|20|14|246|여자|대학원|\n\n### (1)\n\n$x_1$을 $x$로 놓고 각 성별에 대하여 회귀모형을 적합하시오. 그런 후 두 회귀직선의 기울기가 같은지에 대한 가설검정을 하시오(5장 p12 : 두 회귀모형의 검정 참고).\n\n**answer**\n\n남성, Model 1: $y_i = \\beta_{01} + \\beta_{11} x_{i1} + \\epsilon_i , \\epsilon_i \\sim i.i.d. N(0, \\sigma^2)$\n\n여성, Model 2: $y_i = \\beta_{02} + \\beta_{12} x_{i2} + \\epsilon_i , \\epsilon_i \\sim i.i.d. N(0, \\sigma^2)$\n\n**남자**\n\n$S_{yy}$\n\n$S_{xx}$\n\n$S_{xy}$\n\n$\\hat{\\beta}_1 = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0}$\n\n$\\hat{y}_{men} = 33.65637 -0.09986 x_{men}$\n\n---\n\nR code\n\n---\n\n**answer**\n\n$SSE_{men}$\n\n$MSE_{men} \\sim \\sigma^2_{men}$\n\n---\n\nR code\n\n---\n\n**answer**\n\n**여자**\n\n$S_{yy}$\n\n$S_{xx}$\n\n$S_{xy}$\n\n$\\hat{\\beta}_1 = \\frac{S_{xy}}{S_{xx}}$\n\n$\\hat{\\beta_0}$\n\n$\\hat{y}_{women} = 41.97006 -0.10195 x_{women}$\n\n---\n\nR code\n\n---\n\n**answer**\n\n$SSE_{women}$\n\n$MSE_{women} \\sim \\sigma^2_{women}$\n\n---\n\nR code\n\n---\n\n**answer**\n\n가설\n\n$H_0: \\beta_{11} - \\beta_{12} = 0$\n\n$H_0: \\beta_{11} - \\beta_{12} \\neq 0$\n\n검정통계량 $t_0 = \\frac{\\hat{\\beta}_{11}- \\hat{\\beta}_{12}}{\\sqrt{\\hat{var}(\\hat{\\beta}_{11} - \\hat{\\beta}_{12})}}\\sim H_0, t(n_1 - n_2 - 4)$\n\n$var(\\hat{\\beta}_{11} - \\hat{\\beta}_{12})$\n\n$= var(\\hat{\\beta}_{11}) + var(\\hat{\\beta}_{12})$\n\n$= \\frac{\\sigma^2}{\\sum(x_{11} - \\bar{x}_{11})^2} + \\frac{\\sigma^2}{\\sum(x_{12} - \\bar{x}_{12})^2}$\n\n$\\hat{\\beta}_{11} - \\hat{\\beta}_{12}$\n\n$\\sigma^2 = MSE(FM) = \\frac{SSE_{FM}}{n_1 + n_2 - 1}$\n\n$\\star SSE_{FM} = SSE_1 + SSE_2$\n\n$\\sqrt{var(\\hat{\\beta}_{11} - \\hat{\\beta}_{12}))}$\n\n$t_0$\n\n$var(\\hat{\\beta}_{men} - \\hat{\\beta}_{women})$\n\n기각역 : $|t_0| > t_{\\alpha/2}(n_1 + n_2 - 4) = 2.120$\n\n결론: 기각역에 속하지 않으므로 귀무가설 기각 못함.\n\n$H_0: \\beta_{11} - \\beta_{12} = 0$ 채택\n\n따라서 성별간 두 기울기가 다르다고 할 수 없다.\n\n---\n\nR code\n\n$\\beta_3 = -0.002089$, 유의확률 $0.9078 $ 유의수준 $\\alpha=0.05$에서 기각할 수 없다.\n\n기각역: $|t_0|?t_{\\alpha/2}(n_1 + n_2 - 4) = t_{0.025}(16) = 2.120$\n\n기각역에 속하지 않으므로 $H_0$ 기각 못함 $H_0: \\beta_{11} - \\beta_{12} = 0$ 채택\n\n따라서 성별간 두 기울기가 다르다고 할 수 없다.\n\n### (2)\n\n13장 강의노트 p.8 에 따르면 $x_1,x_2$을 설명변수로 했을 때 적합 결과는\n$$\\hat{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x_1 + \\hat{\\beta}_2 x_2$$\n$$= 33.8349 − 0.1009x_1 + 7.9340x_2$$\n이었다. $\\beta_1$ 의 추정값 $\\hat{\\beta}_1$ 이 갖는 분산을 추정하고, $\\beta_1$ 의 95% 신뢰구간을 구하시오.\n\n**answer**\n\n$var(\\beta_1) = (x^\\top x)^{-1}_{(2,2)} \\sigma^2$\n\n$(x^\\top x)^{-1}_{(2,2)}$\n\n$MSE \\sim \\sigma^2$\n\n$var(\\beta_1) = (x^\\top x)^{-1}_{(2,2)} \\sigma^2$\n\n$\\beta_1 \\pm t_{0.975}(17) se(\\hat{\\beta}_1)$\n\n---\n\nR code\n\n### (3)\n\n다음의 모형을 적합하시오.\n$$y_i =\\beta_0 +\\beta_1x_{1i} +\\beta_2x_{2i} +\\beta_3x_{3i} +\\beta_4x_{4i} + \\epsilon_i$$\n\n$$x_{3i}=\\begin{cases} 1: & \\text{학력이 고졸} \\\\ 0 : &\\text{기타} \\end{cases}, x_{4i}= \\begin{cases} 1 : & \\text{학력이 대졸} \\\\ 0 : & \\text{기타}\\end{cases} $$\n\n**answer**\n\n$\\hat{\\beta}$\n\n$y = 36.5226684 - 0.1101234 x_1 + 7.8990531 x_2 - 1.3758336 x_3 - 2.4036479 x_4$\n\n----\n\nR code\n\n---\n\n### (4)\n\n위의 모형에서 $\\beta_3$과 $\\beta_4$가 갖는 의미를 해석하시오.\n\n$$y_i =\\beta_0 +\\beta_1x_{1i} +\\beta_2x_{2i} +\\beta_3x_{3i} +\\beta_4x_{4i} + \\epsilon_i$$\n\n$$x_{3i}=\\begin{cases} 1: & \\text{학력이 고졸} \\\\ 0 : &\\text{기타} \\end{cases}, x_{4i}= \\begin{cases} 1 : & \\text{학력이 대졸} \\\\ 0 : & \\text{기타}\\end{cases} $$\n\n**answer**\n\n$E(y) = \\beta_0 +\\beta_1x_{1} +\\beta_2x_{2} +\\beta_3x_{3} +\\beta_4x_{4}$\n\n학력이 고등학교 졸업\n\n$E(y|고) = (\\beta_0 +\\beta_3) +\\beta_1x_{1} +\\beta_2x_{2}$\n\n학력이 대학교 졸업\n\n$E(y|고) = (\\beta_0 +\\beta_4)+\\beta_1x_{1}+\\beta_2x_{2}$\n\n학력이 대학원 졸업\n\n$E(y|대학원) = \\beta_0 +\\beta_1x_{1}+\\beta_2x_{2}$\n\n$\\beta_3$ = 학력이 고등학교 졸업일때의 평균 숙련 시간에서 학력이 대학원 졸업일때의 평균 숙련시간을 뺀 값이다.\n\n$\\beta_4$ = 학력이 대학교 졸업일때의 평균 숙련 시간에서 학력이 대학원 졸업일때의 평균 숙련시간을 뺀 값이다.\n\n### (5)\n\n위의 $\\beta_3$과 $\\beta_4$의 최소제곱추정값 $\\hat{\\beta}_3$과 \\$\\hat{\\beta}_4$가 갖는 각각의 분산을 추정하시오. $\\beta_3$과 $\\beta_4$의 95% 신뢰구간을 구하시오\n\n**answer**\n\n$var(\\beta_3) = (x^\\top x)^{-1}_{(4,4)} \\sigma^2$\n\n$(x^\\top x)^{-1}_{(4,4)}$\n\n$MSE \\sim \\sigma^2$\n\n$var(\\hat{\\beta}_3) = (x^\\top x)^{-1}_{(4,4)} \\sigma^2$\n\n$t_{\\alpha/2}(n-4-1)$\n\n$\\beta_3 \\pm t_{0.975}(15) se(\\hat{\\beta}_3)$\n\n$(x^\\top x)^{-1}_{(5,5)}$\n\n$MSE \\sim \\sigma^2$\n\n$var(\\beta_4) = (x^\\top x)^{-1}_{(5,5)} \\sigma^2$\n\n$\\beta_4 \\pm t_{0.975}(15) se(\\hat{\\beta}_4)$\n\n---\n\nR code\n\n### (6)\n\n만약 적성검사점수와 성별, 적성검사점수와 학력, 성별과 학력간에 교호작용이 있다면, 다음의 반응함수를 가정할 수 있다.\n$$E(y)=\\beta_0 +\\beta_1x_1 +\\beta_2x_2 +\\beta_3x_3 +\\beta_4x_4$$\n$$+ \\beta_5x_1x_2 + \\beta_6x_1x_3 + \\beta_7x_1x_4 + \\beta_8x_2x_3 + \\beta_9x_2x_4$$\n데이터로부터 위의 반응함수를 적합하고, 다섯 개의 다음 가설을 유의수준 $\\alpha = 0.1$에서 검정하시오. $H_0 :\\beta_i =0, H_1 :\\beta_i  \\neq 0(i=5,6,7,8,9)$\n\n**answer**\n\n$\\hat{E}(y) = 36.63696518 - 0.11186981x_1 + 12.27994350x_2 - 3.42748073x_3 - 6.74634061x_4 - 0.01528919x_1 x_2 + 0.01659028x_1 x_3 + 0.03861449 x_1 x_4 + 0.02924469x_2 x_3 - 4.10250464x_2 x_4$\n\n$MSE \\sim \\sigma^2$\n\n$H_0: \\beta_1 = 0 \\text{ vs } H_1: \\beta_i \\neq 0 (i=5,6,7,8,9)$\n\n$t_0 = \\frac{\\hat{\\beta}_i}{\\hat{s.e.}(\\hat{\\beta}_i)}\\sim H_0 , t(n-p-1)$\n\n---\n\n $H_0 :\\beta_5 =0$\n \n $H_1 :\\beta_5  \\neq 0$\n\n$(x^\\top x)^{-1}_{(6,6)}$\n\n$var(\\hat{\\beta}_5) = (x^\\top x)^{-1}_{(6,6)} \\sigma^2$\n\n$t_0 = \\frac{\\beta_5}{\\sqrt{\\hat{var}(\\hat{\\beta}_5)}}$\n\n$|t_0|<1.812$가 되어 귀무가설 $H_0 :\\beta_5 =0$은 기각할 수 없다.\n\n---\n\n $H_0 :\\beta_6 =0$\n \n $H_1 :\\beta_6  \\neq 0$\n\n$(x^\\top x)^{-1}_{(7,7)}$\n\n$var(\\beta_6) = (x^\\top x)^{-1}_{(7,7)} \\sigma^2$\n\n$t_0 = \\frac{\\beta_6}{\\sqrt{\\hat{var}(\\hat{\\beta}_6)}}$\n\n$|t_0|<1.812$가 되어 귀무가설 $H_0 :\\beta_6 =0$은 기각할 수 없다.\n\n---\n\n $H_0 :\\beta_7 =0$\n \n $H_1 :\\beta_7  \\neq 0$\n\n$(x^\\top x)^{-1}_{(8,8)}$\n\n$var(\\beta_7) = (x^\\top x)^{-1}_{(8,8)} \\sigma^2$\n\n$t_0 = \\frac{\\beta_7}{\\sqrt{\\hat{var}(\\hat{\\beta}_7)}}$\n\n$|t_0|<1.812$가 되어 귀무가설 $H_0 :\\beta_7 =0$은 기각할 수 없다.\n\n---\n\n $H_0 :\\beta_8 =0$\n \n $H_1 :\\beta_8  \\neq 0$\n\n$(x^\\top x)^{-1}_{(9,9)}$\n\n$var(\\beta_8) = (x^\\top x)^{-1}_{(9,9)} \\sigma^2$\n\n$t_0 = \\frac{\\beta_8}{\\sqrt{\\hat{var}(\\hat{\\beta}_8)}}$\n\n$|t_0|<1.812$가 되어 귀무가설 $H_0 :\\beta_8 =0$은 기각할 수 없다.\n\n---\n\n $H_0 :\\beta_9 =0$\n \n $H_1 :\\beta_9  \\neq 0$\n\n$t_0 = \\frac{\\beta_9}{\\sqrt{\\hat{var}(\\hat{\\beta}_9)}}$\n\n$(x^\\top x)^{-1}_{(10,10)}$\n\n$var(\\beta_{10}) = (x^\\top x)^{-1}_{(10,10)} \\sigma^2$\n\n$|t_0|<1.812$가 되어 귀무가설 $H_0 :\\beta_9 =0$은 기각할 수 없다.\n\n---\n\nR code\n\n### (7)\n\n위의 반응함수에 대하여 회귀분석을 통한 분산분석표를 작성하고, 회귀변동의 유의성을 $F$-검정하시오. 이때 $F$ -검정의 귀무가설을 $\\beta_i$ 들로 표현하시오.\n\n**answer**\n\n$SST$\n\n$SSR$\n\n$MSR$\n\n$SSE$\n\n$MSE$\n\n$F_0$\n\n||제곱합|자유도|평균제곱합|F_0|F_{0.05}(9,10)|\n|:--:|:--:|:--:|:--:|:--:|:--:|\n|회귀|1514.35|9|168.26|13.084|3.0204|\n|잔차|128.6|10|12.86|||\n|합계|1642.95|19||||\n\n$H_0 : \\beta_1 = \\beta_2 = \\beta_3 = \\beta_4 = \\beta_5 = \\beta_6 = \\beta_7 = \\beta_8 = \\beta_9 = 0$\n\n$H_1 : \\text{not } H_0$\n\n$|F_0|>3.0204$가 되어 귀무가설 $H_0 : \\beta_1 = \\beta_2 = \\beta_3 = \\beta_4 = \\beta_5 = \\beta_6 = \\beta_7 = \\beta_8 = \\beta_9 = 0$은 기각한다.\n\n따라서 유의수준 0.05에서 회귀모형이 유의함을 알 수 있다.\n\n---\n\nR code\n\n## 2.\n\n아래의 데이터에 대하여 다음 물음에 답하시오.\n\n|$x$|1|2|2|3|4|5|5|6|7|\n|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|\n|$y$|2.0|3.2|3.2|4.1|5.2|7.0|7.4|9.7|11.5|\n\n### (1)\n\n$x$와 $y$에 대한 산점도를 그려보고, 어떤 $x$의 값($x_w$)에서 구간을 두 개로 나누면 적절한지 논하시오.\n\n**answer**\n\n산점도를 그려보면 $x = 4$를 기준으로 기울기가 달라지는 것으로 보인다.\n\n### (2)\n\n위의 (1)에서 얻은 점을 경계로 구간별 단순선형회귀선을 추정하시오. 사용되는 모형은\n$$x_{2i} = \\begin{cases} 1 :& \\text{만약 }x_{1i} > x_w \\text{ 이면 }\\\\ 0 : &\\text{만약 } x_{1i} \\le x_w \\text{ 이면 } \\end{cases}$$\n과 같다.\n\n**answer**\n\n---\n\nR code\n\n**this is the predicted line of multiple linear regression**\n\n### (3)\n\n위의 (2)에 있는 모형에서 $\\beta_2$ 의 90% 신뢰구간을 구하고, 그 의미를 해석하시오.\n\n**answer**\n\n$(x^\\top x)^{-1}_{(3,3)}$\n\n$MSE \\sim \\sigma^2$\n\n$var(\\beta_2) = (x^\\top x)^{-1}_{(3,3)} \\sigma^2$\n\n$\\beta_2 \\pm t_{0.95}(6) se(\\hat{\\beta}_2)$\n\n$\\beta_2$는 기울기의 차이이다.\n\n90% 시뢰구긴이 0을 포함하지 않고 모두 양수이므로, $\\beta_2 \\neq 0$이라고 90% 확신할 수 있다.\n\n즉 구간별 회귀직선의 기울기는 다르다고 할 수 있다.(유의수준 0.1)\n\n---\n\nR code\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"2022-12-08-rl-HW4.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"pulse","code-copy":false,"title-block-banner":true,"title":"Regression HW 4","author":"SEOYEON CHOI","date":"2022-12-08","categories":["Advanced Regression Analysis"]},"extensions":{"book":{"multiFile":true}}}}}