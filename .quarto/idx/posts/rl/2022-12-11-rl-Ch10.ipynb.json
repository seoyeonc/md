{"title":"고급회귀분석 CH10","markdown":{"yaml":{"title":"고급회귀분석 CH10","author":"SEOYEON CHOI","date":"2022-12-11","categories":["Advanced Regression Analysis"]},"headingText":"회귀진단","containsRefs":false,"markdown":"\n\n> 이상치\n\n\n1. 오차항의 검토\n2. 적절한 모형의 선택\n3. 독립변수들 간의 상관관계 검토\n4. 지렛대점(leverage point)의 검출\n5. 이상치(outlier) 화인\n6. 영향점(influential observation)의 검출\n\n추정된 회귀직선\n\n$$\\hat{y} = X(X^\\top X)^{-1} X^\\top y = Hy$$\n\nH: hat matrix, $n \\times n$ matrix\n\n$Var(\\hat{y}) = \\sigma^2 H$\n\n$Var(e) = (I_N - H) \\sigma^2$\n\n$h_{i,j} = x_i^\\top (X^\\top X) ^{-1} x_j$\n\n$h_{ij}$ : H의 대각원소\n\n$H = X(X^\\top X)^{-1} X^\\top$\n\n$HH = H$\n\n$rank(H) = p+1$\n\n$tr(H) = \\sum^n_{i=1}h_{ii} = p+1$\n\n$H$ : 양반정치행렬 positive definite\n\n$0 \\le h_{ii} <1 , -\\frac{1}{2} \\le h_{ij} \\le -\\frac{1}{2}$\n\n$p=1, h_{ii} = \\frac{1}{n} + \\frac{(x_{u} - \\bar{x})^2}{S_{xx}}$\n\n$p>1, h_{ii} = \\frac{1}{n} + (x_i - \\bar{x})^\\top (X^\\top X)^{-1} (x_i - \\bar{x})$\n\n### 지렛대점(leverage point)\n\n$h_{ii} > s\\bar{h}$ 이면, i번째 관측치가 leverage point로 고려 가능\n\n$$\\bar{h} = \\frac{1}{n} \\sum^n_{i=1}h_{ii} = \\frac{p+1}{n}$$\n\n### 잔차(Residual)\n\n$e = y − \\hat{y} = y − X \\hat{\\beta}$\n\n$= y − X(X^\\top X)^{-1} X^\\top y$\n\n$= (In − X(X^\\to X)^{-1}X^\\to )y = (I_n − H)y$\n\n$E(e) = 0_n, Var(e) = (I_n − H)σ^2$\n\n$E(e_i) = 0, Var(e_i) = (1 − h_{ii})σ^2$\n\n$Cov(e_i,e_j) = −h_{ij} σ^2$\n\n$ρ_{ij} = \\frac{−h_{ij} σ^2}{ \\sqrt{(1 − h_{ii})(1 − h_{jj})σ^4} }=\\frac{ −h_{ij}}{\\sqrt{(1 − h_{ii})(1 − h_{jj})}}$\n\n### 표준화잔차(standardized residual)\n\n$y \\sim N(Xβ,I_nσ^2)$\n\n$e \\sim N(0_n,(I_n−H)σ^2)$\n\n$e_i \\sim N(0,(1−h_{ii})σ^2)$\n\n$\\star \\frac{e_i}{\\sigma\\sqrt{1-h_{ii}}} \\sim N(0,1)$\n\n#### 내적 스튜던트화 잔차(internally studentized residual)\n\n$r_i = \\frac{e_i}{\\hat{\\sigma}\\sqrt{1−h_{ii}}}$\n\n$\\hat{\\sigma}^2 = MSE$\n\n이러한 표준화 잔차에 대한 표본분포는 분자와 분모가 서로 독립이 아니기 때문에 $t$ 분포로 근사할 수 없는데, $|e_i|$가 큰 경우, $s$도 역시 커지게 되기 때문이다.\n\n#### 외적 스튜던트화 잔차(externally studentized residual)\n\n$r_i^{*} = \\frac{e_i}{\\hat{\\sigma}_{(i)}\\sqrt{1 − h_{ii}}} \\sim t(n-p-1-1)$\n\n$\\hat{\\sigma}^2_{(i)} = [(n-p-1)\\hat{\\sigma} - \\frac{e^2_{(i)}}{1-h_{ii}}]/(n-p-2)$\n\n$|r_i^{*}| ≥ t_{α/2}(n − p − 2)$ 이면 유의수준$\\alpha$에서 $y_i$를 이상점이라고 판정\n\n$\\star$\n\n$t_{i} = \\frac{y_i - \\tilde{y}_i}{\\hat{\\sigma}\\sqrt{1 + x_i^\\top [X{i}^\\top X(i)]^{-1} x_i}} \\sim t(n-p-2)$\n\n$|r_i^{*}| \\sim t_{i}$\n\n### 예제 10.1\n\n$y = 109.8738  -1.1270 x$\n\n$F_0 = 13.20 > F_{0.05}(1,19) = 4.38$, 회귀직선은 유의하다\n\n$\\sigma^2 \\sim MSE$\n\n손계산\n\n$2\\bar{h}$\n\n18번째가 2hbar 보다 크니까 지렛대점\n\n19번째가 ri2 t보다 크니까 이상점\n\n### 영향점(influential observation)\n\n#### DIFFITS\n\n$DIFFITS(i) = (\\frac{h_{ii}}{10h_{ii}})^{1/2} r^{*}_i$\n\n$DIFFITS(i) \\ge 2(\\frac{p+1}{n})^{1/2}$ 이 되는  i번째 관측칠가 영향점이라고 말함\n\n#### Cook의 통계량\n\n$D(i) = \\frac{r^2_i}{p+1} \\frac{h_{ii}}{1-h_{ii}}$\n\n대략적으로 $D(i) \\ge F_{0.5}(p+1,n-p-1)$이면 영향을 크게 주는 측정값으로 의심\n\nh\n\ndiffits\n\ncooksdistance, D\n\nCOVRATIO\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"output-file":"2022-12-11-rl-Ch10.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","theme":"pulse","code-copy":false,"title-block-banner":true,"title":"고급회귀분석 CH10","author":"SEOYEON CHOI","date":"2022-12-11","categories":["Advanced Regression Analysis"]},"extensions":{"book":{"multiFile":true}}}}}