<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="SEOYEON CHOI">
<meta name="dcterms.date" content="2022-09-14">

<title>Seoyeon’s Blog for classes - DNN (2주차)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Seoyeon’s Blog for classes</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/seoyeonc/md"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">DNN (2주차)</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">DNN (2주차)</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">Special Topics in Machine Learning</div>
                <div class="quarto-category">추천시스템</div>
                <div class="quarto-category">텍스트분석</div>
                <div class="quarto-category">GAN</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>SEOYEON CHOI </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 14, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Posts</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ap/index.html" class="sidebar-item-text sidebar-link">Advanced Probability Theory</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ap/2023-03-07-ap_1wk.html" class="sidebar-item-text sidebar-link">1주차: 측도론</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/rl/index.html" class="sidebar-item-text sidebar-link">Advanced Regression Analysis</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2023-02-23-rl-final_term.html" class="sidebar-item-text sidebar-link">Advanced Regression Analysis Final Term</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2023-03-02-graduation_test.html" class="sidebar-item-text sidebar-link">Advanced Regression Analysis GT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2023-02-22-rl-mid_term.html" class="sidebar-item-text sidebar-link">Advanced Regression Analysis Mid Term</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-09-21-rl_HW1.html" class="sidebar-item-text sidebar-link">Regression HW 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-10-23-rl-HW2.html" class="sidebar-item-text sidebar-link">Regression HW 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-21-rl-HW3.html" class="sidebar-item-text sidebar-link">Regression HW 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-12-08-rl-HW4.html" class="sidebar-item-text sidebar-link">Regression HW 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-12-11-rl-Ch10.html" class="sidebar-item-text sidebar-link">고급회귀분석 CH10</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-09-21-rl_CH03, CH04.html" class="sidebar-item-text sidebar-link">고급회귀분석 실습 CH03, CH04</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-14-rl_CH06, CH07.html" class="sidebar-item-text sidebar-link">고급회귀분석 실습 CH06, CH07</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-23-rl-CH10.html" class="sidebar-item-text sidebar-link">고급회귀분석 실습 CH10</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-12-05-rl-CH11.html" class="sidebar-item-text sidebar-link">고급회귀분석 실습 CH11</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/rl/2022-11-28-rl-CH13.html" class="sidebar-item-text sidebar-link">고급회귀분석 실습 CH13</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ct/index.html" class="sidebar-item-text sidebar-link">Coding Test</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-15-Coding_Test_Algorithm.html" class="sidebar-item-text sidebar-link">Algorithm</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-02-12-Coding_Test.html" class="sidebar-item-text sidebar-link">ArrayList &amp; LinkedList</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-01-Coding_Test_Greedy.html" class="sidebar-item-text sidebar-link">Chapter 03 Greedy</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-03-12-Coding_Test_Queue.html" class="sidebar-item-text sidebar-link">Queue</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-03-05-Coding_Test_Stack.html" class="sidebar-item-text sidebar-link">Stack</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-15-Coding_Test_interfunction.html" class="sidebar-item-text sidebar-link">내장함수</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-23-Coding_Test_Q2.html" class="sidebar-item-text sidebar-link">두 큐 합 같게 만들기(Done)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-21-Coding_Test_Q1.html" class="sidebar-item-text sidebar-link">성격 유형 검사하기(Done)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ct/2023-01-30-Coding_Test_Q3.html" class="sidebar-item-text sidebar-link">코딩 테스트 공부(Done)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ml/index.html" class="sidebar-item-text sidebar-link">Special Topics in Machine Learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-07-13wk.html" class="sidebar-item-text sidebar-link">A1: 깊은복사와 얕은복사 (12주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-19-Assignment-1-Copy1.html" class="sidebar-item-text sidebar-link">Assignment 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-19-ml_7w.html" class="sidebar-item-text sidebar-link">CNN (7주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-26-ml_8w_1.html" class="sidebar-item-text sidebar-link">CNN (8주차) 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-26-ml_8w_2.html" class="sidebar-item-text sidebar-link">CNN (8주차) 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-29-13wk-2-final.html" class="sidebar-item-text sidebar-link">Deep Learning final example</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-07-ml_1w.html" class="sidebar-item-text sidebar-link">DNN (1주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-14-ml_2w.html" class="sidebar-item-text sidebar-link active">DNN (2주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-21-ml_3w.html" class="sidebar-item-text sidebar-link">DNN (3주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-29-ml_4w.html" class="sidebar-item-text sidebar-link">DNN (4주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-05-ml-5w.html" class="sidebar-item-text sidebar-link">DNN (5주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-12-ml-6w.html" class="sidebar-item-text sidebar-link">DNN (6주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-21-Extra-1.html" class="sidebar-item-text sidebar-link">Extra-1: 추천시스템</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-21-Extra-2.html" class="sidebar-item-text sidebar-link">Extra-2: 생성모형(GAN)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-23-Extra-3.html" class="sidebar-item-text sidebar-link">Extra-3: 딥러닝의 기초 (5)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-13-final_seoyeon.html" class="sidebar-item-text sidebar-link">Finalterm</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-10-05-ml-HW.html" class="sidebar-item-text sidebar-link">Homework</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-09-07-ml.html" class="sidebar-item-text sidebar-link">Intro</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-02-ml-midterm.html" class="sidebar-item-text sidebar-link">Midterm</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-09-ml-10w.html" class="sidebar-item-text sidebar-link">RNN (10주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-21-ml-11w.html" class="sidebar-item-text sidebar-link">RNN (11주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-30-12wk.html" class="sidebar-item-text sidebar-link">RNN (12주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-08-13wk.html" class="sidebar-item-text sidebar-link">RNN (13주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-11-02-ml_9w.html" class="sidebar-item-text sidebar-link">RNN (9주차)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ml/2022-12-14-study.html" class="sidebar-item-text sidebar-link">study</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../posts/ts/index.html" class="sidebar-item-text sidebar-link">Theoritical Statistics</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-25-ts-final term.html" class="sidebar-item-text sidebar-link">Theoritical Statistics Final term</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-03-03-ts-final_qanda.html" class="sidebar-item-text sidebar-link">Theoritical Statistics Final term 6 Explanation</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-03-03-graduation_test.html" class="sidebar-item-text sidebar-link">Theoritical Statistics GT</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-05-ts_HW1.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-05-ts_HW2.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-05-ts_HW3.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-09-ts_HW4.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-12-ts_HW5.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-14-ts_HW6.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW6</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-18-ts_HW7.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW7</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-18-ts-HW8.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW8</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-21-ts-HW9.html" class="sidebar-item-text sidebar-link">Theoritical Statistics HW9</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2023-01-14-ts_Mid term.html" class="sidebar-item-text sidebar-link">Theoritical Statistics Mid term</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/ts/2022-12-31-ts_1.html" class="sidebar-item-text sidebar-link">확률변수와 확률분포</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imports" id="toc-imports" class="nav-link active" data-scroll-target="#imports">imports</a></li>
  <li><a href="#이미지-자료분석-실습-지난시간-복습" id="toc-이미지-자료분석-실습-지난시간-복습" class="nav-link" data-scroll-target="#이미지-자료분석-실습-지난시간-복습">이미지 자료분석 실습 (지난시간 복습)</a>
  <ul class="collapse">
  <li><a href="#단계-데이터의-정리" id="toc-단계-데이터의-정리" class="nav-link" data-scroll-target="#단계-데이터의-정리">1단계: 데이터의 정리</a></li>
  <li><a href="#단계-lrnr-오브젝트-생성" id="toc-단계-lrnr-오브젝트-생성" class="nav-link" data-scroll-target="#단계-lrnr-오브젝트-생성">2단계: lrnr 오브젝트 생성</a></li>
  <li><a href="#단계-lrnr.학습" id="toc-단계-lrnr.학습" class="nav-link" data-scroll-target="#단계-lrnr.학습">3단계: lrnr.학습()</a></li>
  <li><a href="#단계-lrnr.예측" id="toc-단계-lrnr.예측" class="nav-link" data-scroll-target="#단계-lrnr.예측">4단계: lrnr.예측()</a></li>
  </ul></li>
  <li><a href="#프로그래밍-과정" id="toc-프로그래밍-과정" class="nav-link" data-scroll-target="#프로그래밍-과정">프로그래밍 과정</a>
  <ul class="collapse">
  <li><a href="#프로그래밍-과정-overview" id="toc-프로그래밍-과정-overview" class="nav-link" data-scroll-target="#프로그래밍-과정-overview">프로그래밍 과정 overview</a></li>
  <li><a href="#이미지분석-추천시스템-텍스트분석-gan-분석과정-비교" id="toc-이미지분석-추천시스템-텍스트분석-gan-분석과정-비교" class="nav-link" data-scroll-target="#이미지분석-추천시스템-텍스트분석-gan-분석과정-비교">이미지분석, 추천시스템, 텍스트분석, GAN 분석과정 비교</a></li>
  </ul></li>
  <li><a href="#추천시스템-실습" id="toc-추천시스템-실습" class="nav-link" data-scroll-target="#추천시스템-실습">추천시스템 실습</a>
  <ul class="collapse">
  <li><a href="#단계" id="toc-단계" class="nav-link" data-scroll-target="#단계">1단계</a></li>
  <li><a href="#단계-1" id="toc-단계-1" class="nav-link" data-scroll-target="#단계-1">2단계</a></li>
  <li><a href="#단계-2" id="toc-단계-2" class="nav-link" data-scroll-target="#단계-2">3단계</a></li>
  <li><a href="#단계-3" id="toc-단계-3" class="nav-link" data-scroll-target="#단계-3">4단계</a></li>
  </ul></li>
  <li><a href="#텍스트분석-실습" id="toc-텍스트분석-실습" class="nav-link" data-scroll-target="#텍스트분석-실습">텍스트분석 실습</a>
  <ul class="collapse">
  <li><a href="#단계-4" id="toc-단계-4" class="nav-link" data-scroll-target="#단계-4">1단계</a></li>
  <li><a href="#단계-5" id="toc-단계-5" class="nav-link" data-scroll-target="#단계-5">2단계</a></li>
  <li><a href="#단계-6" id="toc-단계-6" class="nav-link" data-scroll-target="#단계-6">3단계</a></li>
  <li><a href="#단계-7" id="toc-단계-7" class="nav-link" data-scroll-target="#단계-7">4단계</a></li>
  </ul></li>
  <li><a href="#gan-intro" id="toc-gan-intro" class="nav-link" data-scroll-target="#gan-intro">GAN intro</a>
  <ul class="collapse">
  <li><a href="#생성모형이란-쉬운-설명" id="toc-생성모형이란-쉬운-설명" class="nav-link" data-scroll-target="#생성모형이란-쉬운-설명">생성모형이란? (쉬운 설명)</a></li>
  <li><a href="#생성모형이란-통계학과-버전의-설명" id="toc-생성모형이란-통계학과-버전의-설명" class="nav-link" data-scroll-target="#생성모형이란-통계학과-버전의-설명">생성모형이란? 통계학과 버전의 설명</a></li>
  <li><a href="#gan의-원리" id="toc-gan의-원리" class="nav-link" data-scroll-target="#gan의-원리">GAN의 원리</a></li>
  </ul></li>
  <li><a href="#gan-실습" id="toc-gan-실습" class="nav-link" data-scroll-target="#gan-실습">GAN 실습</a>
  <ul class="collapse">
  <li><a href="#단계-8" id="toc-단계-8" class="nav-link" data-scroll-target="#단계-8">1단계</a></li>
  <li><a href="#단계-9" id="toc-단계-9" class="nav-link" data-scroll-target="#단계-9">2단계</a></li>
  <li><a href="#단계-10" id="toc-단계-10" class="nav-link" data-scroll-target="#단계-10">3단계</a></li>
  <li><a href="#단계-없음" id="toc-단계-없음" class="nav-link" data-scroll-target="#단계-없음">4단계 (없음)</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>기계학습 특강 (2주차) 9월14일 [추천시스템, 텍스트분석, GAN]</p>
<section id="imports" class="level2">
<h2 class="anchored" data-anchor-id="imports">imports</h2>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.collab <span class="im">import</span> <span class="op">*</span> <span class="co">## 추천시스템</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.text.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span> <span class="co">## 텍스트분석 </span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span>  <span class="co">## GAN (이미지분석) </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fastai.vision.gan <span class="im">import</span> <span class="op">*</span> <span class="co">## GAN (이미지생성)</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div>
</div>
</section>
<section id="이미지-자료분석-실습-지난시간-복습" class="level2">
<h2 class="anchored" data-anchor-id="이미지-자료분석-실습-지난시간-복습">이미지 자료분석 실습 (지난시간 복습)</h2>
<section id="단계-데이터의-정리" class="level3">
<h3 class="anchored" data-anchor-id="단계-데이터의-정리">1단계: 데이터의 정리</h3>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.PETS)<span class="op">/</span><span class="st">'images'</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>path.ls()</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(#7393) [Path('/home/csy/.fastai/data/oxford-iiit-pet/images/Bombay_13.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/beagle_193.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/Ragdoll_8.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/boxer_106.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/keeshond_56.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/american_pit_bull_terrier_162.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/saint_bernard_136.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/staffordshire_bull_terrier_76.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/pug_173.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/american_pit_bull_terrier_117.jpg')...]</code></pre>
</div>
</div>
<p><strong>every files’ list</strong></p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>fnames <span class="op">=</span> get_image_files(path)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fnames</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>(#7390) [Path('/home/csy/.fastai/data/oxford-iiit-pet/images/Bombay_13.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/beagle_193.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/Ragdoll_8.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/boxer_106.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/keeshond_56.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/american_pit_bull_terrier_162.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/saint_bernard_136.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/staffordshire_bull_terrier_76.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/pug_173.jpg'),Path('/home/csy/.fastai/data/oxford-iiit-pet/images/american_pit_bull_terrier_117.jpg')...]</code></pre>
</div>
</div>
<p><strong>image files’ list</strong></p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ImageDataLoaders.from_name_func??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
ImageDataLoaders<span class="ansi-blue-fg">.</span>from_name_func<span class="ansi-blue-fg">(</span>
    path<span class="ansi-blue-fg">,</span>
    fnames<span class="ansi-blue-fg">,</span>
    label_func<span class="ansi-blue-fg">,</span>
    valid_pct<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.2</span><span class="ansi-blue-fg">,</span>
    seed<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    item_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    batch_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    bs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span>
    val_bs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
    <span class="ansi-blue-fg">@</span>classmethod
    <span class="ansi-green-fg">def</span> from_name_func<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">,</span> fnames<span class="ansi-blue-fg">,</span> label_func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        <span class="ansi-blue-fg">"Create from the name attrs of `fnames` in `path`s with `label_func`"</span>
        <span class="ansi-green-fg">if</span> sys<span class="ansi-blue-fg">.</span>platform <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">'win32'</span> <span class="ansi-green-fg">and</span> isinstance<span class="ansi-blue-fg">(</span>label_func<span class="ansi-blue-fg">,</span> types<span class="ansi-blue-fg">.</span>LambdaType<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> label_func<span class="ansi-blue-fg">.</span>__name__ <span class="ansi-blue-fg">==</span> <span class="ansi-blue-fg">'&lt;lambda&gt;'</span><span class="ansi-blue-fg">:</span>
            <span class="ansi-red-fg"># https://medium.com/@jwnx/multiprocessing-serialization-in-python-with-pickle-9844f6fa1812</span>
            <span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"label_func couldn't be lambda function on Windows"</span><span class="ansi-blue-fg">)</span>
        f <span class="ansi-blue-fg">=</span> using_attr<span class="ansi-blue-fg">(</span>label_func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'name'</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>from_path_func<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">,</span> fnames<span class="ansi-blue-fg">,</span> f<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/vision/data.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>
</div>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(fname):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> fname[<span class="dv">0</span>].isupper():</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'cat'</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'dog'</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>f(x) <span class="op">=</span> x<span class="op">+</span> <span class="dv">1</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">lambda</span> x : x<span class="op">+</span><span class="dv">1</span></span></code></pre></div>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fnames[<span class="dv">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>Path('/home/csy/.fastai/data/oxford-iiit-pet/images/Bombay_13.jpg')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> fname: <span class="st">'cat'</span> <span class="cf">if</span> fname[<span class="dv">0</span>].isupper() <span class="cf">else</span> <span class="st">'dog'</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>f(<span class="st">'s'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>'dog'</code></pre>
</div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>f(<span class="st">'D'</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>'cat'</code></pre>
</div>
</div>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> ImageDataLoaders.from_name_func(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    path, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    fnames,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">lambda</span> fname: <span class="st">'cat'</span> <span class="cf">if</span> fname[<span class="dv">0</span>].isupper() <span class="cf">else</span> <span class="st">'dog'</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>)) </span></code></pre></div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> ImageDataLoaders.from_name_func(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>    path, </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    fnames,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>    f, <span class="co"># f대신 (lambda fname: 'cat' if fname[0].isupper() else 'dog') 를 넣어도 가능</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    item_tfms<span class="op">=</span>Resize(<span class="dv">224</span>)) <span class="co"># 사이즈가 달라서 통일</span></span></code></pre></div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-14-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="단계-lrnr-오브젝트-생성" class="level3">
<h3 class="anchored" data-anchor-id="단계-lrnr-오브젝트-생성">2단계: lrnr 오브젝트 생성</h3>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cnn_learner??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
cnn_learner<span class="ansi-blue-fg">(</span>
    dls<span class="ansi-blue-fg">,</span>
    arch<span class="ansi-blue-fg">,</span>
    normalize<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    n_out<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    pretrained<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    config<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    loss_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    opt_func<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function Adam at <span class="ansi-cyan-fg">0x7fcb70042550</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.001</span><span class="ansi-blue-fg">,</span>
    splitter<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    metrics<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    model_dir<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'models'</span><span class="ansi-blue-fg">,</span>
    wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    wd_bn_bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    train_bn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    moms<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.85</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
    cut<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    n_in<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span>
    init<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function kaiming_normal_ at <span class="ansi-cyan-fg">0x7fcbc439a8b0</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    custom_head<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    concat_pool<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    lin_ftrs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    ps<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.5</span><span class="ansi-blue-fg">,</span>
    first_bn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    bn_final<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    lin_first<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    y_range<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>create_cnn_model<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">def</span> cnn_learner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> arch<span class="ansi-blue-fg">,</span> normalize<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> n_out<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> config<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
                <span class="ansi-red-fg"># learner args</span>
                loss_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> opt_func<span class="ansi-blue-fg">=</span>Adam<span class="ansi-blue-fg">,</span> lr<span class="ansi-blue-fg">=</span>defaults<span class="ansi-blue-fg">.</span>lr<span class="ansi-blue-fg">,</span> splitter<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> metrics<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
                model_dir<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'models'</span><span class="ansi-blue-fg">,</span> wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> wd_bn_bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> train_bn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> moms<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">0.85</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
                <span class="ansi-red-fg"># other model args</span>
                <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"Build a convnet style learner from `dls` and `arch`"</span>
    <span class="ansi-green-fg">if</span> config<span class="ansi-blue-fg">:</span>
        warnings<span class="ansi-blue-fg">.</span>warn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'config param is deprecated. Pass your args directly to cnn_learner.'</span><span class="ansi-blue-fg">)</span>
        kwargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">**</span>config<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">}</span>
    meta <span class="ansi-blue-fg">=</span> model_meta<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span>arch<span class="ansi-blue-fg">,</span> _default_meta<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">if</span> normalize<span class="ansi-blue-fg">:</span> _add_norm<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> meta<span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">if</span> n_out <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> n_out <span class="ansi-blue-fg">=</span> get_c<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">assert</span> n_out<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">"`n_out` is not defined, and could not be inferred from data, set `dls.c` or pass `n_out`"</span>
    model <span class="ansi-blue-fg">=</span> create_cnn_model<span class="ansi-blue-fg">(</span>arch<span class="ansi-blue-fg">,</span> n_out<span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">=</span>pretrained<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
    splitter<span class="ansi-blue-fg">=</span>ifnone<span class="ansi-blue-fg">(</span>splitter<span class="ansi-blue-fg">,</span> meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'split'</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
    learn <span class="ansi-blue-fg">=</span> Learner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">=</span>dls<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">=</span>model<span class="ansi-blue-fg">,</span> loss_func<span class="ansi-blue-fg">=</span>loss_func<span class="ansi-blue-fg">,</span> opt_func<span class="ansi-blue-fg">=</span>opt_func<span class="ansi-blue-fg">,</span> lr<span class="ansi-blue-fg">=</span>lr<span class="ansi-blue-fg">,</span> splitter<span class="ansi-blue-fg">=</span>splitter<span class="ansi-blue-fg">,</span> cbs<span class="ansi-blue-fg">=</span>cbs<span class="ansi-blue-fg">,</span>
                   metrics<span class="ansi-blue-fg">=</span>metrics<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> model_dir<span class="ansi-blue-fg">=</span>model_dir<span class="ansi-blue-fg">,</span> wd<span class="ansi-blue-fg">=</span>wd<span class="ansi-blue-fg">,</span> wd_bn_bias<span class="ansi-blue-fg">=</span>wd_bn_bias<span class="ansi-blue-fg">,</span> train_bn<span class="ansi-blue-fg">=</span>train_bn<span class="ansi-blue-fg">,</span>
                   moms<span class="ansi-blue-fg">=</span>moms<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">if</span> pretrained<span class="ansi-blue-fg">:</span> learn<span class="ansi-blue-fg">.</span>freeze<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
    <span class="ansi-red-fg"># keep track of args for loggers</span>
    store_attr<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'arch,normalize,n_out,pretrained'</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">=</span>learn<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">return</span> learn
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/vision/learner.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat <span class="op">~/</span>anaconda3<span class="op">/</span>envs<span class="op">/</span>csy<span class="op">/</span>lib<span class="op">/</span>python3<span class="fl">.8</span><span class="op">/</span>site<span class="op">-</span>packages<span class="op">/</span>fastai<span class="op">/</span>vision<span class="op">/</span>learner.py</span></code></pre></div>
<p>이 코드로 존재하는 함수의 정의 확인 가능</p>
<p>어디 소속된 함수인지 확인 하기 위해</p>
<p>fastai에 소속된 cnn_leaner,따라서 fastai를 import해야 나타나지.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> cnn_learner(dls,resnet34,metrics<span class="op">=</span>error_rate)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>lrnr.dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-17-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span>(lrnr.dls)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>140510181797744</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="bu">id</span>(dls)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>140510181797744</code></pre>
</div>
</div>
<p>주소가 같다. 같은 역할</p>
<p>lrnr에 dls가 소속되어 있다고 생각(?) - 포스트잇을 위에 덧붙인다 생각</p>
</section>
<section id="단계-lrnr.학습" class="level3">
<h3 class="anchored" data-anchor-id="단계-lrnr.학습">3단계: lrnr.학습()</h3>
<p>학습하는 fine_tune 이외에 여러가지 있음 - fine_tune 학습된 일부는 유지하고 바꿀 부분만 학습시키는 법: transfer learning</p>
<p>for exampel: cnn의 1d에서는 끝에만 학습</p>
<div class="cell" data-outputid="7f1224fb-951d-4c4b-8d73-431e4867760c" data-execution_count="20">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>lrnr.fine_tune(<span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>error_rate</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.155603</td>
      <td>0.014394</td>
      <td>0.006766</td>
      <td>00:10</td>
    </tr>
  </tbody>
</table>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>error_rate</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.051081</td>
      <td>0.008424</td>
      <td>0.002706</td>
      <td>00:11</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<ul>
<li>fine_tune()은 모든 가중치를 학습하는 것이 아니라 일부만 학습하는 것임.</li>
<li>fine_tune()이외이 방법으로 학습할 수도 있음.</li>
</ul>
</section>
<section id="단계-lrnr.예측" class="level3">
<h3 class="anchored" data-anchor-id="단계-lrnr.예측">4단계: lrnr.예측()</h3>
<p>(방법1) lrnr.predict() 함수를 이용</p>
<div class="cell" data-outputid="fed8845e-371c-4542-9b1a-004630b37b35" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>lrnr.predict(<span class="st">'2022-09-07-dogs.jpeg'</span>) <span class="co"># 방법1-1</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co">#lrnr.predict(PILImage.create('2022-09-07-dogs.jpeg')) # 방법1-2</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#lrnr.predict(path.ls()[0]) # 방법1-3</span></span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>('dog', TensorBase(1), TensorBase([2.2932e-05, 9.9998e-01]))</code></pre>
</div>
</div>
<p>컴퓨터가 이해하기 쉬운 방법인 1-2번째 방법</p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>lrnr.predict(PILImage.create(<span class="st">'2022-09-07-dogs.jpeg'</span>))</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>('dog', TensorBase(1), TensorBase([2.2932e-05, 9.9998e-01]))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>lrnr.predict(path.ls()[<span class="dv">1</span>])</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>('dog', TensorBase(1), TensorBase([2.4945e-08, 1.0000e+00]))</code></pre>
</div>
</div>
<hr>
<pre class="pyhton"><code>dir(lrnr.model)</code></pre>
<p>directory에 _call_있으면 함수처럼 사용 가능</p>
<hr>
<p>(방법2) lrnr.model(X) 를 이용: X의 shape이 (?,3,224,224)의 형태의 텐서이어야함</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(dls.one_batch())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>tuple</code></pre>
</div>
</div>
<p>끝에 괄호로 묶여 있으면 tuple</p>
<div class="cell" data-outputid="b402fa50-9f08-46f1-f86c-9a90667af1fc" data-execution_count="29">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>X,y <span class="op">=</span> dls.one_batch() <span class="co"># 방법2</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>lrnr.model(X[<span class="dv">0</span>:<span class="dv">1</span>]) </span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>TensorBase([[-8.3588,  7.0462]], device='cuda:0', grad_fn=&lt;AliasBackward0&gt;)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>torch.Size([3, 224, 224])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>X[:<span class="dv">2</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>torch.Size([2, 3, 224, 224])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>X.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>torch.Size([64, 3, 224, 224])</code></pre>
</div>
</div>
<p>image의 사이즈 224 * 224 - 3개의 채널 - 64개 - image, 입력</p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>y.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>torch.Size([64])</code></pre>
</div>
</div>
<ul>
<li>예측값</li>
</ul>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>y[:<span class="dv">3</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>TensorCategory([1, 1, 0], device='cuda:0')</code></pre>
</div>
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(X[<span class="dv">0</span>])</span></code></pre></div>
<p>오류 뜬다. - torch.Size([3, 224, 224]) - shape을 - torch.Size([?, 3, 224, 224]) - 이런 식으로 만들어주자, 입력</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(X[:<span class="dv">3</span>])</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>TensorBase([[ -8.3605,   7.0472],
        [ -4.4236,   5.1110],
        [ 14.0977, -13.0582]], device='cuda:0', grad_fn=&lt;AliasBackward0&gt;)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(X)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>TensorBase([[ -8.3595,   7.0465],
        [ -4.4246,   5.1111],
        [ 14.0959, -13.0577],
        [ -6.4868,   7.2289],
        [ -3.4974,   2.0202],
        [ -7.1135,   6.2276],
        [ -4.2407,   2.9429],
        [ -7.0260,   6.4789],
        [ -6.5011,   5.1029],
        [ -7.4927,   4.9038],
        [ -5.7292,   5.0113],
        [ -9.6244,   5.7399],
        [ -6.8247,   3.4742],
        [ 17.2742, -12.6829],
        [ -4.0548,   2.6589],
        [ 16.3894, -14.2360],
        [ -3.8864,   5.6632],
        [ -5.1192,   6.0355],
        [ 11.3016, -13.4798],
        [ -8.1850,   7.5925],
        [  8.3147,  -5.9946],
        [ -8.0415,   8.4349],
        [ -9.6461,   8.3790],
        [ -5.4923,   5.8070],
        [ 12.1504,  -9.3661],
        [ -7.7945,   6.7907],
        [ -5.0291,   3.4955],
        [ 13.8045, -11.3889],
        [ -4.5400,   5.1561],
        [ 16.5360, -13.3928],
        [ -4.0467,   3.3478],
        [ -5.8401,   7.2492],
        [  6.9878,  -4.8408],
        [ -8.0189,   6.0578],
        [ -7.7578,   4.7063],
        [ -5.0351,   4.5309],
        [  6.0511,  -4.1623],
        [ -8.4919,   8.1300],
        [ -5.9893,   5.8341],
        [ -7.0671,   6.2901],
        [ 17.0369, -13.7746],
        [ -6.7633,   5.5232],
        [ -7.3533,   7.6700],
        [ -8.3923,   6.6368],
        [ 13.2212, -10.2649],
        [ 14.7573, -11.7938],
        [ -6.6409,   5.6934],
        [ -6.5882,   4.9800],
        [ -5.2839,   5.3899],
        [ -5.7066,   4.9765],
        [ -5.8099,   3.8355],
        [ -8.5055,   7.2022],
        [ -8.7006,   4.5980],
        [ -5.4901,   4.5288],
        [ -7.6612,   7.1533],
        [ 15.9380, -16.2778],
        [  7.9763,  -7.1954],
        [ 13.4158, -10.9864],
        [ -4.9234,   2.9219],
        [ -4.0274,   4.1298],
        [ 16.8217, -16.0985],
        [ -8.6418,   7.1085],
        [ -5.9216,   6.0076],
        [ -5.3720,   3.9876]], device='cuda:0', grad_fn=&lt;AliasBackward0&gt;)</code></pre>
</div>
</div>
<p><span class="math inline">\(y\)</span> : 왼쪽이 크면 0, 오른쪽이 크면 1 - 둘다 음수인 건 없네? - 왼쪽이 양수면 0 오른쪽이 양수면 1로 생각 가능하겠다.</p>
</section>
</section>
<section id="프로그래밍-과정" class="level2">
<h2 class="anchored" data-anchor-id="프로그래밍-과정">프로그래밍 과정</h2>
<section id="프로그래밍-과정-overview" class="level3">
<h3 class="anchored" data-anchor-id="프로그래밍-과정-overview">프로그래밍 과정 overview</h3>
<p><code>-</code> overview</p>
<ol type="1">
<li><p><code>dls</code> 오브젝트 생성</p></li>
<li><p><code>lrnr</code> 오브젝트 생성</p></li>
<li><p><code>lrnr.학습()</code></p></li>
<li><p><code>lrnr.예측()</code></p></li>
</ol>
</section>
<section id="이미지분석-추천시스템-텍스트분석-gan-분석과정-비교" class="level3">
<h3 class="anchored" data-anchor-id="이미지분석-추천시스템-텍스트분석-gan-분석과정-비교">이미지분석, 추천시스템, 텍스트분석, GAN 분석과정 비교</h3>
<p><code>-</code> 비교</p>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">이미지분석(CNN)</th>
<th style="text-align: center;">추천시스템</th>
<th style="text-align: center;">텍스트분석</th>
<th style="text-align: center;">GAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1단계</td>
<td style="text-align: center;">ImageDataLoaders</td>
<td style="text-align: center;">CollabDataLoaders</td>
<td style="text-align: center;">TextDataLoaders</td>
<td style="text-align: center;">DataBlock -&gt; dls</td>
</tr>
<tr class="even">
<td style="text-align: center;">2단계</td>
<td style="text-align: center;">cnn_learner()</td>
<td style="text-align: center;">collab_learner()</td>
<td style="text-align: center;">language_model_learner()</td>
<td style="text-align: center;">GANLearner.wgan()</td>
</tr>
<tr class="odd">
<td style="text-align: center;">3단계</td>
<td style="text-align: center;">lrnr.fine_tune(1)</td>
<td style="text-align: center;">lrnr.fit()</td>
<td style="text-align: center;">lrnr.fit()</td>
<td style="text-align: center;">lrnr.fit()</td>
</tr>
<tr class="even">
<td style="text-align: center;">4단계</td>
<td style="text-align: center;">lrnr.predict(), lrnr.model(X)</td>
<td style="text-align: center;">lrnr.model(X)</td>
<td style="text-align: center;">lrnr.predict()</td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="추천시스템-실습" class="level2">
<h2 class="anchored" data-anchor-id="추천시스템-실습">추천시스템 실습</h2>
<section id="단계" class="level3">
<h3 class="anchored" data-anchor-id="단계">1단계</h3>
<p>github에서 해당 파일의 raw click하여 주소 가져오기</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>guebin<span class="op">/</span>DL2022<span class="op">/</span>master<span class="op">/</span>_notebooks<span class="op">/</span><span class="dv">2022</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span><span class="op">-</span>rcmd_view.csv</span></code></pre></div>
<p>위와 같이 wget사용하면 주소의 data 바로 다운 가능</p>
<div class="cell" data-outputid="a6725657-cee1-4c71-a031-9ce34538c8ef" data-execution_count="4">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>df_view <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/DL2022/master/_notebooks/2022-09-08-rcmd_view.csv'</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df_view</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>커피1</th>
      <th>커피2</th>
      <th>커피3</th>
      <th>커피4</th>
      <th>커피5</th>
      <th>커피6</th>
      <th>커피7</th>
      <th>커피8</th>
      <th>커피9</th>
      <th>커피10</th>
      <th>홍차1</th>
      <th>홍차2</th>
      <th>홍차3</th>
      <th>홍차4</th>
      <th>홍차5</th>
      <th>홍차6</th>
      <th>홍차7</th>
      <th>홍차8</th>
      <th>홍차9</th>
      <th>홍차10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.149209</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.078139</td>
      <td>4.033415</td>
      <td>4.071871</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.142659</td>
      <td>1.109452</td>
      <td>NaN</td>
      <td>0.603118</td>
      <td>1.084308</td>
      <td>NaN</td>
      <td>0.906524</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.903826</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.031811</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.822704</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.071410</td>
      <td>3.996206</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.839565</td>
      <td>1.011315</td>
      <td>NaN</td>
      <td>1.120552</td>
      <td>0.911340</td>
      <td>NaN</td>
      <td>0.860954</td>
      <td>0.871482</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.082178</td>
      <td>4.196436</td>
      <td>NaN</td>
      <td>3.956876</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.450931</td>
      <td>3.972090</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.983838</td>
      <td>NaN</td>
      <td>0.918576</td>
      <td>1.206796</td>
      <td>0.913116</td>
      <td>NaN</td>
      <td>0.956194</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>4.000621</td>
      <td>3.895570</td>
      <td>NaN</td>
      <td>3.838781</td>
      <td>3.967183</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.105741</td>
      <td>1.147554</td>
      <td>NaN</td>
      <td>1.346860</td>
      <td>NaN</td>
      <td>0.614099</td>
      <td>1.297301</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.147545</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.888208</td>
      <td>NaN</td>
      <td>3.970330</td>
      <td>3.979490</td>
      <td>NaN</td>
      <td>4.010982</td>
      <td>NaN</td>
      <td>0.920995</td>
      <td>1.081111</td>
      <td>0.999345</td>
      <td>NaN</td>
      <td>1.195183</td>
      <td>NaN</td>
      <td>0.818332</td>
      <td>1.236331</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>95</th>
      <td>0.511905</td>
      <td>1.066144</td>
      <td>NaN</td>
      <td>1.315430</td>
      <td>NaN</td>
      <td>1.285778</td>
      <td>NaN</td>
      <td>0.678400</td>
      <td>1.023020</td>
      <td>0.886803</td>
      <td>NaN</td>
      <td>4.055996</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.156489</td>
      <td>4.127622</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>96</th>
      <td>NaN</td>
      <td>1.035022</td>
      <td>NaN</td>
      <td>1.085834</td>
      <td>NaN</td>
      <td>0.812558</td>
      <td>NaN</td>
      <td>1.074543</td>
      <td>NaN</td>
      <td>0.852806</td>
      <td>3.894772</td>
      <td>NaN</td>
      <td>4.071385</td>
      <td>3.935935</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.989815</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.267142</td>
    </tr>
    <tr>
      <th>97</th>
      <td>NaN</td>
      <td>1.115511</td>
      <td>NaN</td>
      <td>1.101395</td>
      <td>0.878614</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.329319</td>
      <td>NaN</td>
      <td>4.125190</td>
      <td>NaN</td>
      <td>4.354638</td>
      <td>3.811209</td>
      <td>4.144648</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.116915</td>
      <td>3.887823</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>98</th>
      <td>NaN</td>
      <td>0.850794</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.927884</td>
      <td>0.669895</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.665429</td>
      <td>1.387329</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.329404</td>
      <td>4.111706</td>
      <td>3.960197</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.725288</td>
      <td>4.122072</td>
    </tr>
    <tr>
      <th>99</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.413968</td>
      <td>0.838720</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.094826</td>
      <td>0.987888</td>
      <td>NaN</td>
      <td>1.177387</td>
      <td>3.957383</td>
      <td>4.136731</td>
      <td>NaN</td>
      <td>4.026915</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>4.164773</td>
      <td>4.104276</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 20 columns</p>
</div>
</div>
</div>
<p>컴퓨터가 좋아하는 타입은 아님</p>
<ul>
<li>row0 - row49 에 해당하는 유저는 커피를 선호</li>
<li>row50 - row99 에 해당하는 유저는 홍차를 선호</li>
</ul>
<p>위의 자료는 비효율적, tidy data로 바꿔주자, 아래와 같이 정리함으로써 저장할 data도 줄어든다.</p>
<div class="cell" data-outputid="705c40d2-f948-4607-e6b4-bf7eeffc9819" data-execution_count="5">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/DL2022/master/_notebooks/2022-09-08-rcmd_anal.csv'</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
      <th>item_name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>15</td>
      <td>1.084308</td>
      <td>홍차5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4.149209</td>
      <td>커피1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>11</td>
      <td>1.142659</td>
      <td>홍차1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>5</td>
      <td>4.033415</td>
      <td>커피5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>4</td>
      <td>4.078139</td>
      <td>커피4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>995</th>
      <td>100</td>
      <td>18</td>
      <td>4.104276</td>
      <td>홍차8</td>
    </tr>
    <tr>
      <th>996</th>
      <td>100</td>
      <td>17</td>
      <td>4.164773</td>
      <td>홍차7</td>
    </tr>
    <tr>
      <th>997</th>
      <td>100</td>
      <td>14</td>
      <td>4.026915</td>
      <td>홍차4</td>
    </tr>
    <tr>
      <th>998</th>
      <td>100</td>
      <td>4</td>
      <td>0.838720</td>
      <td>커피4</td>
    </tr>
    <tr>
      <th>999</th>
      <td>100</td>
      <td>7</td>
      <td>1.094826</td>
      <td>커피7</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 4 columns</p>
</div>
</div>
</div>
<ul>
<li>컴퓨터는 이러한 형태를 더 분석하기 좋아한다.</li>
</ul>
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat 파일명</span></code></pre></div>
<p>data 도 확인 가능하다</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>guebin<span class="op">/</span>DL2022<span class="op">/</span>master<span class="op">/</span>_notebooks<span class="op">/</span><span class="dv">2022</span><span class="op">-</span><span class="dv">0</span><span class="er">9</span><span class="op">-</span><span class="dv">0</span><span class="er">8</span><span class="op">-</span>rcmd_anal.csv</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>cat Real_estate_valuation_data_set.csv</span></code></pre></div>
<hr>
<div class="cell" data-outputid="d44a2791-ea47-46ad-986e-d4d210e388a0" data-execution_count="6">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>df.item.unique(),df.user.unique()</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 유저는 1~100 으로 아이템은 1~20으로 번호가 매겨져 있음 </span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>(array([15,  1, 11,  5,  4, 14,  6, 20, 12, 17,  8,  9, 13, 19, 18, 16,  2,
         3, 10,  7]),
 array([  1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,
         14,  15,  16,  17,  18,  19,  20,  21,  22,  23,  24,  25,  26,
         27,  28,  29,  30,  31,  32,  33,  34,  35,  36,  37,  38,  39,
         40,  41,  42,  43,  44,  45,  46,  47,  48,  49,  50,  51,  52,
         53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64,  65,
         66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,
         79,  80,  81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,
         92,  93,  94,  95,  96,  97,  98,  99, 100]))</code></pre>
</div>
</div>
<p>item, user 번호 확인</p>
<hr>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>CollabDataLoaders.from_df??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">

<pre><span class="ansi-red-fg">Signature:</span>
CollabDataLoaders<span class="ansi-blue-fg">.</span>from_df<span class="ansi-blue-fg">(</span>
    ratings<span class="ansi-blue-fg">,</span>
    valid_pct<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.2</span><span class="ansi-blue-fg">,</span>
    user_name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    item_name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    rating_name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    seed<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'.'</span><span class="ansi-blue-fg">,</span>
    bs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span>
    val_bs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
    <span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>DataLoaders<span class="ansi-blue-fg">.</span>from_dblock<span class="ansi-blue-fg">)</span>
    <span class="ansi-blue-fg">@</span>classmethod
    <span class="ansi-green-fg">def</span> from_df<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> ratings<span class="ansi-blue-fg">,</span> valid_pct<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.2</span><span class="ansi-blue-fg">,</span> user_name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> item_name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> rating_name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> seed<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'.'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        <span class="ansi-blue-fg">"Create a `DataLoaders` suitable for collaborative filtering from `ratings`."</span>
        user_name   <span class="ansi-blue-fg">=</span> ifnone<span class="ansi-blue-fg">(</span>user_name<span class="ansi-blue-fg">,</span>   ratings<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
        item_name   <span class="ansi-blue-fg">=</span> ifnone<span class="ansi-blue-fg">(</span>item_name<span class="ansi-blue-fg">,</span>   ratings<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
        rating_name <span class="ansi-blue-fg">=</span> ifnone<span class="ansi-blue-fg">(</span>rating_name<span class="ansi-blue-fg">,</span> ratings<span class="ansi-blue-fg">.</span>columns<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
        cat_names <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>user_name<span class="ansi-blue-fg">,</span>item_name<span class="ansi-blue-fg">]</span>
        splits <span class="ansi-blue-fg">=</span> RandomSplitter<span class="ansi-blue-fg">(</span>valid_pct<span class="ansi-blue-fg">=</span>valid_pct<span class="ansi-blue-fg">,</span> seed<span class="ansi-blue-fg">=</span>seed<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>range_of<span class="ansi-blue-fg">(</span>ratings<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        to <span class="ansi-blue-fg">=</span> TabularCollab<span class="ansi-blue-fg">(</span>ratings<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">[</span>Categorify<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> cat_names<span class="ansi-blue-fg">,</span> y_names<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span>rating_name<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> y_block<span class="ansi-blue-fg">=</span>TransformBlock<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> splits<span class="ansi-blue-fg">=</span>splits<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> to<span class="ansi-blue-fg">.</span>dataloaders<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/collab.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>dls<span class="op">=</span>CollabDataLoaders.from_df(df)</span></code></pre></div>
</div>
<p>batch 데이터들의 group</p>
<div class="cell" data-outputid="54e295fd-f1df-42af-bcbc-a48b2e18fd2a" data-execution_count="9">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>user</th>
      <th>item</th>
      <th>rating</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>59</td>
      <td>14</td>
      <td>3.986921</td>
    </tr>
    <tr>
      <th>1</th>
      <td>23</td>
      <td>3</td>
      <td>4.393831</td>
    </tr>
    <tr>
      <th>2</th>
      <td>43</td>
      <td>15</td>
      <td>1.022492</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15</td>
      <td>16</td>
      <td>0.857821</td>
    </tr>
    <tr>
      <th>4</th>
      <td>81</td>
      <td>11</td>
      <td>3.892794</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8</td>
      <td>1</td>
      <td>4.194341</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>18</td>
      <td>1.124469</td>
    </tr>
    <tr>
      <th>7</th>
      <td>41</td>
      <td>20</td>
      <td>1.019717</td>
    </tr>
    <tr>
      <th>8</th>
      <td>10</td>
      <td>18</td>
      <td>0.789071</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2</td>
      <td>4</td>
      <td>3.822704</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>학습 전</p>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>X,y<span class="op">=</span> dls.one_batch()</span></code></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(X)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>torch.Tensor</code></pre>
</div>
</div>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(y)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>torch.Tensor</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(dls.one_batch())</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>tuple</code></pre>
</div>
</div>
<div class="cell" data-outputid="cf6d40bb-fc05-450a-b123-575b3f0c75d6" data-execution_count="14">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>],y[<span class="dv">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>(tensor([74,  5]), tensor([1.0687]))</code></pre>
</div>
</div>
<ul>
<li><p>99번 user가 13번 아이템을 먹었을때 평점 4.3294</p></li>
<li><p>64번 유저가 15번 아이템을 먹었을때 평점을 4.1146 주었음</p></li>
</ul>
</section>
<section id="단계-1" class="level3">
<h3 class="anchored" data-anchor-id="단계-1">2단계</h3>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>collab_learner??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
collab_learner<span class="ansi-blue-fg">(</span>
    dls<span class="ansi-blue-fg">,</span>
    n_factors<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">,</span>
    use_nn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    emb_szs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    layers<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    config<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    y_range<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    loss_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    opt_func<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function Adam at <span class="ansi-cyan-fg">0x7f6f5cbebca0</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.001</span><span class="ansi-blue-fg">,</span>
    splitter<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function trainable_params at <span class="ansi-cyan-fg">0x7f6f7682d0d0</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    metrics<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    model_dir<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'models'</span><span class="ansi-blue-fg">,</span>
    wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    wd_bn_bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    train_bn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    moms<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.85</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>Learner<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">def</span> collab_learner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> n_factors<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">50</span><span class="ansi-blue-fg">,</span> use_nn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> emb_szs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> layers<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> config<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> y_range<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> loss_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"Create a Learner for collaborative filtering on `dls`."</span>
    emb_szs <span class="ansi-blue-fg">=</span> get_emb_sz<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> ifnone<span class="ansi-blue-fg">(</span>emb_szs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">if</span> loss_func <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> loss_func <span class="ansi-blue-fg">=</span> MSELossFlat<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">if</span> config <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> config <span class="ansi-blue-fg">=</span> tabular_config<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">if</span> y_range <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> config<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'y_range'</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> y_range
    <span class="ansi-green-fg">if</span> layers <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> layers <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>n_factors<span class="ansi-blue-fg">]</span>
    <span class="ansi-green-fg">if</span> use_nn<span class="ansi-blue-fg">:</span> model <span class="ansi-blue-fg">=</span> EmbeddingNN<span class="ansi-blue-fg">(</span>emb_szs<span class="ansi-blue-fg">=</span>emb_szs<span class="ansi-blue-fg">,</span> layers<span class="ansi-blue-fg">=</span>layers<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>config<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>      model <span class="ansi-blue-fg">=</span> EmbeddingDotBias<span class="ansi-blue-fg">.</span>from_classes<span class="ansi-blue-fg">(</span>n_factors<span class="ansi-blue-fg">,</span> dls<span class="ansi-blue-fg">.</span>classes<span class="ansi-blue-fg">,</span> y_range<span class="ansi-blue-fg">=</span>y_range<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">return</span> Learner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">,</span> loss_func<span class="ansi-blue-fg">=</span>loss_func<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/collab.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> collab_learner(dls,y_range<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">5</span>)) <span class="co"># y_range는 평점의 범위</span></span></code></pre></div>
</div>
<p>y는 평점이니까 0~5까지의 범위를 넣어주자</p>
</section>
<section id="단계-2" class="level3">
<h3 class="anchored" data-anchor-id="단계-2">3단계</h3>
<div class="cell" data-outputid="33040777-2f51-48b0-811f-5c8896222b63" data-execution_count="17">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">30</span>) <span class="co"># 총 30번 정도 해야 적합이 잘된다. </span></span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.319048</td>
      <td>2.344653</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.308136</td>
      <td>2.343053</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.294945</td>
      <td>2.327852</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.277872</td>
      <td>2.286632</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2.242915</td>
      <td>2.204543</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>5</td>
      <td>2.190223</td>
      <td>2.074773</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>6</td>
      <td>2.110882</td>
      <td>1.897575</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>7</td>
      <td>2.002486</td>
      <td>1.683303</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>8</td>
      <td>1.865617</td>
      <td>1.440904</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>9</td>
      <td>1.705019</td>
      <td>1.189762</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>10</td>
      <td>1.528594</td>
      <td>0.947479</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>11</td>
      <td>1.343253</td>
      <td>0.728591</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>12</td>
      <td>1.158638</td>
      <td>0.542451</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.982688</td>
      <td>0.394331</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.821111</td>
      <td>0.282930</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.678422</td>
      <td>0.203212</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.556185</td>
      <td>0.148874</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.453426</td>
      <td>0.112210</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.368528</td>
      <td>0.088727</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.299861</td>
      <td>0.073288</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>20</td>
      <td>0.244360</td>
      <td>0.064172</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>21</td>
      <td>0.200107</td>
      <td>0.058580</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>22</td>
      <td>0.164968</td>
      <td>0.055078</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>23</td>
      <td>0.137080</td>
      <td>0.052871</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>24</td>
      <td>0.115055</td>
      <td>0.051715</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>25</td>
      <td>0.097788</td>
      <td>0.051180</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>26</td>
      <td>0.084044</td>
      <td>0.051137</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>27</td>
      <td>0.073312</td>
      <td>0.050811</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>28</td>
      <td>0.064564</td>
      <td>0.050948</td>
      <td>00:00</td>
    </tr>
    <tr>
      <td>29</td>
      <td>0.057734</td>
      <td>0.051064</td>
      <td>00:00</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>loss가 2.3에서 0.47으로 떨어지는 모습</p>
</section>
<section id="단계-3" class="level3">
<h3 class="anchored" data-anchor-id="단계-3">4단계</h3>
<p><code>-</code> 이미 있는 데이터를 예측</p>
<p><code>-</code> 하나의 배치 전체를 예측</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(X)</span></code></pre></div>
<p>만 넣으면 에러뜬다.</p>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>nvidia<span class="op">-</span>smi</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Tue Sep 20 23:48:21 2022       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 495.46       Driver Version: 495.46       CUDA Version: 11.5     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA GeForce ...  Off  | 00000000:65:00.0 Off |                  N/A |
| 30%   51C    P2   130W / 420W |  12684MiB / 24268MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A     37424      C   ...onda3/envs/csy/bin/python     3419MiB |
|    0   N/A  N/A    293359      C   ...onda3/envs/csy/bin/python     4789MiB |
|    0   N/A  N/A    378609      C   ...onda3/envs/csy/bin/python     2605MiB |
|    0   N/A  N/A    378623      C   ...onda3/envs/csy/bin/python     1869MiB |
+-----------------------------------------------------------------------------+</code></pre>
</div>
</div>
<p>GPU 확인 가능</p>
<p>GPU아님 CPU로 올리자</p>
<div class="cell" data-outputid="96f421fa-1b19-4757-e960-cb1c29ffc1da" data-execution_count="19">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>yhat<span class="op">=</span>lrnr.model(X.to(<span class="st">"cuda:0"</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>yhat</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>tensor([1.0097, 3.9209, 4.0095, 1.0768, 1.0179, 3.9701, 1.0862, 4.0802, 4.0528,
        1.0718, 3.9230, 0.9994, 0.9662, 0.9122, 0.9745, 4.0083, 0.9989, 4.1045,
        4.1632, 4.0724, 3.9754, 0.9565, 4.0757, 4.0317, 4.0740, 1.0779, 3.9354,
        0.9951, 3.9031, 1.0241, 4.0253, 4.0965, 4.0368, 4.0944, 1.0856, 4.1450,
        4.0549, 4.0072, 0.8689, 4.0659, 3.9192, 3.9501, 4.0449, 0.9437, 1.0582,
        0.9584, 4.0409, 4.0453, 1.0675, 0.9406, 1.0740, 0.9307, 0.9885, 3.9951,
        3.9118, 4.1501, 0.8893, 0.8946, 3.9687, 1.0579, 4.1036, 3.9685, 1.0809,
        1.0768], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>y.reshape(<span class="op">-</span><span class="dv">1</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>tensor([1.0687, 3.8248, 3.8609, 1.0261, 0.8480, 4.4577, 1.1617, 4.3921, 4.2632,
        0.7725, 4.0136, 1.2705, 0.8435, 1.0225, 0.8010, 4.1617, 1.0468, 4.1678,
        4.5026, 4.0560, 3.8630, 0.9917, 4.0591, 3.7022, 4.1746, 1.3469, 3.7943,
        1.0213, 3.7841, 0.8235, 4.0407, 3.9853, 4.1260, 4.1900, 1.0309, 4.1798,
        3.9636, 3.7450, 0.6707, 4.0318, 4.1648, 4.1057, 3.9359, 0.7864, 1.2067,
        0.8126, 4.0661, 4.1786, 1.3155, 0.9504, 1.1084, 0.8396, 0.8503, 4.0655,
        3.8489, 4.0402, 0.7891, 0.9279, 4.1935, 0.9436, 4.4777, 4.0123, 1.0577,
        0.8246])</code></pre>
</div>
</div>
<ul>
<li>lrnr.model()은 GPU메모리에 존재하고 X는 일반메모리에 존재하므로 X를 GPU메모리로 옮겨주어야 함</li>
<li>X.to(“cuda:0”)을 통하여 X를 GPU메모리로 옮기는 작업을 수행할 수 있다.</li>
</ul>
<p><code>-</code> 하나의 유저가 하나의 아이템을 선택했다고 가정하고 예측 (주어진 자료중에서 예측)</p>
<div class="cell" data-outputid="b356a2d4-3ea4-4665-8eb6-8c2a299be001" data-execution_count="21">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>X.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>torch.Size([64, 2])</code></pre>
</div>
</div>
<div class="cell" data-outputid="e7fdfffb-4b3f-40c1-9d64-8a4e58546c58" data-execution_count="22">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>:<span class="dv">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>tensor([[74,  5]])</code></pre>
</div>
</div>
<p><code>-</code> 1번 user가 커피2 마셨을때 - 예상: 4점 근처</p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(X[<span class="dv">0</span>:<span class="dv">1</span>].to(<span class="st">"cuda:0"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>tensor([1.0097], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(tensor([[<span class="dv">1</span>,<span class="dv">2</span>]]).to(<span class="st">"cuda:0"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>tensor([3.9337], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<ul>
<li>18번 유저가 5번 아이템(커피)를 먹는다면?</li>
</ul>
<div class="cell" data-outputid="3e423158-76b9-44a7-b2f7-18d8abb1c7bc" data-execution_count="25">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(X[<span class="dv">0</span>:<span class="dv">1</span>].to(<span class="st">"cuda:0"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>tensor([1.0097], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
<ul>
<li>평점은 4.1128정도 될것</li>
</ul>
<p><code>-</code> 하나의 유저가 하나의 아이템을 선택했다고 가정하고 예측 (주어지지 않은 자료중에서 예측)</p>
<div class="cell" data-outputid="c017359e-5eda-4331-bef3-9086fbf0d535" data-execution_count="26">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">0</span>:<span class="dv">1</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>tensor([[74,  5]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>Xnew <span class="op">=</span> torch.tensor([[<span class="dv">1</span>,  <span class="dv">2</span>]])</span></code></pre></div>
</div>
<div class="cell" data-outputid="1a4b7fc3-3f62-40d2-93e9-5a3ee64f215b" data-execution_count="28">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>lrnr.model(Xnew.to(<span class="st">"cuda:0"</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>tensor([3.9337], device='cuda:0', grad_fn=&lt;AddBackward0&gt;)</code></pre>
</div>
</div>
</section>
</section>
<section id="텍스트분석-실습" class="level2">
<h2 class="anchored" data-anchor-id="텍스트분석-실습">텍스트분석 실습</h2>
<p>timeseries 와 text 순서가 중요! - 가장 잘 응용할 수 있는 게 chatbot챗봇 - 나는 <span class="math inline">\(\to\)</span> 학교에 <span class="math inline">\(\to\)</span> 갔다.</p>
<p>timeseries는 뒤를 정확히 맞춰야 하지만, text는 그렇지 않..?</p>
<section id="단계-4" class="level3">
<h3 class="anchored" data-anchor-id="단계-4">1단계</h3>
<div class="cell" data-outputid="5e257e95-28e3-4110-fa40-34ac7a34ac95" data-execution_count="67">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'text'</span>:[<span class="st">'h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??'</span>]<span class="op">*</span><span class="dv">20000</span>})</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>1</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>2</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>3</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>4</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>19995</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>19996</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>19997</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>19998</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
    <tr>
      <th>19999</th>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o !! h e l l o ??</td>
    </tr>
  </tbody>
</table>
<p>20000 rows × 1 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>TextDataLoaders.from_df??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
TextDataLoaders<span class="ansi-blue-fg">.</span>from_df<span class="ansi-blue-fg">(</span>
    df<span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'.'</span><span class="ansi-blue-fg">,</span>
    valid_pct<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.2</span><span class="ansi-blue-fg">,</span>
    seed<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    text_col<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>
    label_col<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    label_delim<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    y_block<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    text_vocab<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    is_lm<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    valid_col<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    tok_tfm<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    tok_text_col<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'text'</span><span class="ansi-blue-fg">,</span>
    seq_len<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">72</span><span class="ansi-blue-fg">,</span>
    backwards<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    bs<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span>
    val_bs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    shuffle<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
    <span class="ansi-blue-fg">@</span>classmethod
    <span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>DataLoaders<span class="ansi-blue-fg">.</span>from_dblock<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">def</span> from_df<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> df<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'.'</span><span class="ansi-blue-fg">,</span> valid_pct<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.2</span><span class="ansi-blue-fg">,</span> seed<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> text_col<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> label_col<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> label_delim<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> y_block<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
                text_vocab<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> is_lm<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> valid_col<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> tok_tfm<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> tok_text_col<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">"text"</span><span class="ansi-blue-fg">,</span> seq_len<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">72</span><span class="ansi-blue-fg">,</span> backwards<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        <span class="ansi-blue-fg">"Create from `df` in `path` with `valid_pct`"</span>
        blocks <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>TextBlock<span class="ansi-blue-fg">.</span>from_df<span class="ansi-blue-fg">(</span>text_col<span class="ansi-blue-fg">,</span> text_vocab<span class="ansi-blue-fg">,</span> is_lm<span class="ansi-blue-fg">,</span> seq_len<span class="ansi-blue-fg">,</span> backwards<span class="ansi-blue-fg">,</span> tok<span class="ansi-blue-fg">=</span>tok_tfm<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
        <span class="ansi-green-fg">if</span> y_block <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> is_lm<span class="ansi-blue-fg">:</span>
            blocks<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>MultiCategoryBlock <span class="ansi-green-fg">if</span> is_listy<span class="ansi-blue-fg">(</span>label_col<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">and</span> len<span class="ansi-blue-fg">(</span>label_col<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">1</span> <span class="ansi-green-fg">else</span> CategoryBlock<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">if</span> y_block <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> <span class="ansi-green-fg">not</span> is_lm<span class="ansi-blue-fg">:</span> blocks <span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">(</span>y_block <span class="ansi-green-fg">if</span> is_listy<span class="ansi-blue-fg">(</span>y_block<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> <span class="ansi-blue-fg">[</span>y_block<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
        splitter <span class="ansi-blue-fg">=</span> RandomSplitter<span class="ansi-blue-fg">(</span>valid_pct<span class="ansi-blue-fg">,</span> seed<span class="ansi-blue-fg">=</span>seed<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> valid_col <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> ColSplitter<span class="ansi-blue-fg">(</span>valid_col<span class="ansi-blue-fg">)</span>
        dblock <span class="ansi-blue-fg">=</span> DataBlock<span class="ansi-blue-fg">(</span>blocks<span class="ansi-blue-fg">=</span>blocks<span class="ansi-blue-fg">,</span>
                           get_x<span class="ansi-blue-fg">=</span>ColReader<span class="ansi-blue-fg">(</span>tok_text_col<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
                           get_y<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span> <span class="ansi-green-fg">if</span> is_lm <span class="ansi-green-fg">else</span> ColReader<span class="ansi-blue-fg">(</span>label_col<span class="ansi-blue-fg">,</span> label_delim<span class="ansi-blue-fg">=</span>label_delim<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
                           splitter<span class="ansi-blue-fg">=</span>splitter<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">.</span>from_dblock<span class="ansi-blue-fg">(</span>dblock<span class="ansi-blue-fg">,</span> df<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> seq_len<span class="ansi-blue-fg">=</span>seq_len<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/text/data.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>
</div>
</div>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>is_lm <span class="op">=</span> <span class="va">False</span></span></code></pre></div>
<p>다음 자료를 예측하고 싶을때</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>is_lm <span class="op">=</span> <span class="va">True</span></span></code></pre></div>
<ul>
<li><p>classification을 수행하고 싶을 때</p></li>
<li><p>생성에 목적</p></li>
<li><p>is_lm: text의 생성에 관심이 있다면 True로 설정할 것</p></li>
</ul>
<div class="cell" data-outputid="8c945837-2455-4746-fa96-b21b302ccb9d" data-execution_count="69">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> TextDataLoaders.from_df(df,text_col<span class="op">=</span><span class="st">'text'</span>,is_lm<span class="op">=</span><span class="va">True</span>) </span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
</div>
<div class="cell" data-outputid="24a6777f-5792-4a16-b7ce-a2ce39555ffa" data-execution_count="70">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>text</th>
      <th>text_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o</td>
      <td>h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o .</td>
    </tr>
    <tr>
      <th>1</th>
      <td>? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l</td>
      <td>xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o</td>
    </tr>
    <tr>
      <th>2</th>
      <td>? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l</td>
      <td>? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l</td>
    </tr>
    <tr>
      <th>3</th>
      <td>o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e</td>
      <td>? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l</td>
    </tr>
    <tr>
      <th>4</th>
      <td>l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h</td>
      <td>o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e</td>
    </tr>
    <tr>
      <th>5</th>
      <td>l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos</td>
      <td>l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h</td>
    </tr>
    <tr>
      <th>6</th>
      <td>e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ?</td>
      <td>l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos</td>
    </tr>
    <tr>
      <th>7</th>
      <td>h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ?</td>
      <td>e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ?</td>
    </tr>
    <tr>
      <th>8</th>
      <td>! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o</td>
      <td>h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ? ? xxbos h e l l o . h e l l o ! h e l l o ? h e l l o ! ! h e l l o ?</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<p>위의 결과에서 <strong>xxbos</strong>는 하나의 내용이 끝나고 다른 내용이 시작된다는 의미</p>
</section>
<section id="단계-5" class="level3">
<h3 class="anchored" data-anchor-id="단계-5">2단계</h3>
<div class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>language_model_learner??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
language_model_learner<span class="ansi-blue-fg">(</span>
    dls<span class="ansi-blue-fg">,</span>
    arch<span class="ansi-blue-fg">,</span>
    config<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    drop_mult<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1.0</span><span class="ansi-blue-fg">,</span>
    backwards<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    pretrained<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    pretrained_fnames<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    loss_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    opt_func<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function Adam at <span class="ansi-cyan-fg">0x7fcb70042550</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.001</span><span class="ansi-blue-fg">,</span>
    splitter<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function trainable_params at <span class="ansi-cyan-fg">0x7fcb79d04940</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    metrics<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    model_dir<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'models'</span><span class="ansi-blue-fg">,</span>
    wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    wd_bn_bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    train_bn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    moms<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.85</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>Learner<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">def</span> language_model_learner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> arch<span class="ansi-blue-fg">,</span> config<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> drop_mult<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1.</span><span class="ansi-blue-fg">,</span> backwards<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> pretrained<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> pretrained_fnames<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"Create a `Learner` with a language model from `dls` and `arch`."</span>
    vocab <span class="ansi-blue-fg">=</span> _get_text_vocab<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">)</span>
    model <span class="ansi-blue-fg">=</span> get_language_model<span class="ansi-blue-fg">(</span>arch<span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>vocab<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> config<span class="ansi-blue-fg">=</span>config<span class="ansi-blue-fg">,</span> drop_mult<span class="ansi-blue-fg">=</span>drop_mult<span class="ansi-blue-fg">)</span>
    meta <span class="ansi-blue-fg">=</span> _model_meta<span class="ansi-blue-fg">[</span>arch<span class="ansi-blue-fg">]</span>
    learn <span class="ansi-blue-fg">=</span> LMLearner<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> model<span class="ansi-blue-fg">,</span> loss_func<span class="ansi-blue-fg">=</span>CrossEntropyLossFlat<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> splitter<span class="ansi-blue-fg">=</span>meta<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'split_lm'</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
    url <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'url_bwd'</span> <span class="ansi-green-fg">if</span> backwards <span class="ansi-green-fg">else</span> <span class="ansi-blue-fg">'url'</span>
    <span class="ansi-green-fg">if</span> pretrained <span class="ansi-green-fg">or</span> pretrained_fnames<span class="ansi-blue-fg">:</span>
        <span class="ansi-green-fg">if</span> pretrained_fnames <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
            fnames <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>learn<span class="ansi-blue-fg">.</span>path<span class="ansi-blue-fg">/</span>learn<span class="ansi-blue-fg">.</span>model_dir<span class="ansi-blue-fg">/</span><span class="ansi-blue-fg">f'{fn}.{ext}'</span> <span class="ansi-green-fg">for</span> fn<span class="ansi-blue-fg">,</span>ext <span class="ansi-green-fg">in</span> zip<span class="ansi-blue-fg">(</span>pretrained_fnames<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'pth'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'pkl'</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
        <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
            <span class="ansi-green-fg">if</span> url <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">in</span> meta<span class="ansi-blue-fg">:</span>
                warn<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"There are no pretrained weights for that architecture yet!"</span><span class="ansi-blue-fg">)</span>
                <span class="ansi-green-fg">return</span> learn
            model_path <span class="ansi-blue-fg">=</span> untar_data<span class="ansi-blue-fg">(</span>meta<span class="ansi-blue-fg">[</span>url<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">,</span> c_key<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'model'</span><span class="ansi-blue-fg">)</span>
            <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span> fnames <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>list<span class="ansi-blue-fg">(</span>model_path<span class="ansi-blue-fg">.</span>glob<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f'*.{ext}'</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">for</span> ext <span class="ansi-green-fg">in</span> <span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">'pth'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'pkl'</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span>
            <span class="ansi-green-fg">except</span> IndexError<span class="ansi-blue-fg">:</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f'The model in {model_path} is incomplete, download again'</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">;</span> <span class="ansi-green-fg">raise</span>
        learn <span class="ansi-blue-fg">=</span> learn<span class="ansi-blue-fg">.</span>load_pretrained<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>fnames<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">return</span> learn
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/text/learner.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> language_model_learner(dls, AWD_LSTM)</span></code></pre></div>
</div>
</section>
<section id="단계-6" class="level3">
<h3 class="anchored" data-anchor-id="단계-6">3단계</h3>
<div class="cell" data-outputid="b4c464bd-6907-41fa-fc65-c74113478de6" data-execution_count="73">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>1.926327</td>
      <td>0.851078</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.030813</td>
      <td>0.366239</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.636483</td>
      <td>0.251018</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.478914</td>
      <td>0.209533</td>
      <td>00:15</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.431652</td>
      <td>0.190482</td>
      <td>00:15</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</section>
<section id="단계-7" class="level3">
<h3 class="anchored" data-anchor-id="단계-7">4단계</h3>
<div class="cell" data-outputid="88806b13-2592-4466-b355-f381c7f3540d" data-execution_count="74">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>lrnr.predict(<span class="st">'h e'</span>,n_words<span class="op">=</span><span class="dv">30</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>'h e l l o ? h e l l o ! h e l l o ! h e l l o ! h e l l o ? ?'</code></pre>
</div>
</div>
</section>
</section>
<section id="gan-intro" class="level2">
<h2 class="anchored" data-anchor-id="gan-intro">GAN intro</h2>
<p><code>-</code> 저자: 이안굿펠로우 (이름이 특이함. 좋은친구..) - 천재임 - 지도교수가 요수아 벤지오</p>
<p><code>-</code> 논문 NIPS, 저는 이 논문 읽고 소름돋았어요.. - https://arxiv.org/abs/1406.2661 (현재시점, 38751회 인용되었음 <span class="math inline">\(\to\)</span> 48978회 인용..)</p>
<p><code>-</code> 최근 10년간 머신러닝 분야에서 가장 혁신적인 아이디어이다. (얀르쿤, 2014년 시점..)</p>
<p><code>-</code> 무슨내용? 생성모형</p>
<section id="생성모형이란-쉬운-설명" class="level3">
<h3 class="anchored" data-anchor-id="생성모형이란-쉬운-설명">생성모형이란? (쉬운 설명)</h3>
<blockquote class="blockquote">
<p>만들수 없다면 이해하지 못한 것이다, 리처드 파인만 (천재 물리학자)</p>
</blockquote>
<p><code>-</code> 사진속에 들어있는 동물이 개인지 고양이인지 맞출수 있는 기계와 개와 고양이를 그릴수 있는 기계중 어떤것이 더 시각적보에 대한 이해가 깊다고 볼수 있는가?</p>
<p><code>-</code> 진정으로 인공지능이 이미지를 이해했다면, 이미지를 만들수도 있어야 한다. <span class="math inline">\(\to\)</span> 이미지를 생성하는 모형을 만들어보자 <span class="math inline">\(\to\)</span> 성공</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/1/1f/Woman_1.jpg" class="img-fluid"></p>
<section id="gan의-응용분야" class="level4">
<h4 class="anchored" data-anchor-id="gan의-응용분야">GAN의 응용분야</h4>
<p><code>-</code> 내가 찍은 사진이 피카소의 화풍으로 표현된다면? - https://www.lgsl.kr/sto/stories/60/ALMA2020070001</p>
<p><code>-</code> 퀸의 라이브에이드가 4k로 나온다면?</p>
<p><code>-</code> 1920년대 서울의 모습이 칼라로 복원된다면?</p>
<p><code>-</code> 딥페이크: 유명인의 가짜 포르노, 가짜뉴스, 협박(거짓기소)</p>
<p><code>-</code> 게임영상 (파이널판타지)</p>
<p><code>-</code> 거북이의 커버..</p>
<p><code>-</code> 너무 많아요…..</p>
</section>
</section>
<section id="생성모형이란-통계학과-버전의-설명" class="level3">
<h3 class="anchored" data-anchor-id="생성모형이란-통계학과-버전의-설명">생성모형이란? 통계학과 버전의 설명</h3>
<blockquote class="blockquote">
<p>제한된 정보만으로 어떤 문제를 풀 때, 그 과정에서 원래의 문제보다 일반적인 문제를 풀지 말고, 가능한 원래의 문제를 직접 풀어야한다. 배프닉 (SVM 창시자)</p>
</blockquote>
<p><code>-</code> 이미지 <span class="math inline">\(\boldsymbol{x}\)</span>가 주어졌을 경우 라벨을 <span class="math inline">\(y\)</span>라고 하자.</p>
<p><code>-</code> 이미지를 보고 라벨을 맞추는 일은 <span class="math inline">\(p(y| \boldsymbol{x})\)</span>에 관심이 있다.</p>
<p><code>-</code> 이미지를 생성하는 일은 <span class="math inline">\(p(\boldsymbol{x},y)\)</span>에 관심이 있는것이다.</p>
<p>y의 평균적인 확률이 나올떄 x로 y 를 예측할 수 있다고 한단</p>
<p><code>-</code> 데이터의 생성확률 <span class="math inline">\(p(\boldsymbol{x},y)\)</span>을 알면 클래스의 사후확률 <span class="math inline">\(p(y|\boldsymbol{x})\)</span>를 알 수 있음. (아래의 수식 참고) 하지만 역은 불가능</p>
<p><span class="math display">\[p(y|x) = \frac{p(x,y)}{p(x)} = \frac{p(x,y)}{\sum_{y}p(x,y)} \]</span></p>
<ul>
<li>즉 이미지를 생성하는일은 분류문제보다 더 어려운 일이라 해석가능</li>
</ul>
<p>분류할 수 았다는게 생성할 수 있다는 건 아니니까</p>
<p><code>-</code> 따라서 배프닉의 원리에 의하면 식별적 분류가 생성적 분류보다 바람직한 접근법이라 할 수 있음.</p>
<p><code>-</code> 하지만 다양한 현실문제에서 생성모형이 유용할때가 많다.</p>
</section>
<section id="gan의-원리" class="level3">
<h3 class="anchored" data-anchor-id="gan의-원리">GAN의 원리</h3>
<p><code>-</code> GAN은 생성모형중 하나임</p>
<p><code>-</code> GAN의 원리는 경찰과 위조지폐범이 서로 선의의(?) 경쟁을 통하여 서로 발전하는 모형으로 설명할 수 있다.</p>
<blockquote class="blockquote">
<p>The generative model can be thought of as analogous to a team of counterfeiters, trying to produce fake currency and use it without detection, while the discriminative model is analogous to the police, trying to detect the counterfeit currency. Competition in this game drives both teams to improve their methods until the counterfeits are indistiguishable from the genuine articles.</p>
</blockquote>
<p><code>-</code> 서로 적대적인(adversarial) 네트워크(network)를 동시에 학습시켜 가짜이미지를 만든다(generate)</p>
<p><code>-</code> 무식한 상황극..</p>
<blockquote class="blockquote">
<p>위조범: 가짜돈을 만들어서 부자가 되어야지! (가짜돈을 그림)</p>
</blockquote>
<blockquote class="blockquote">
<p>경찰: (위조범이 만든 돈을 보고) 이건 가짜다!</p>
</blockquote>
<blockquote class="blockquote">
<p>위조범: 걸렸군.. 더 정교하게 만들어야지..</p>
</blockquote>
<blockquote class="blockquote">
<p>경찰: 이건 진짠가?… –&gt; 상사에게 혼남. 그것도 구분못하냐고</p>
</blockquote>
<blockquote class="blockquote">
<p>위조범: 더 정교하게 만들자..</p>
</blockquote>
<blockquote class="blockquote">
<p>경찰: 더 판별능력을 업그레이드 하자!</p>
</blockquote>
<blockquote class="blockquote">
<p>반복..</p>
</blockquote>
<p><code>-</code> 굉장히 우수한 경찰조차도 진짜와 가짜를 구분하지 못할때(=진짜 이미지를 0.5의 확률로만 진짜라고 말할때 = 가짜 이미지를 0.5의 확률로만 가짜라고 말할때) 학습을 멈춘다.</p>
</section>
</section>
<section id="gan-실습" class="level2">
<h2 class="anchored" data-anchor-id="gan-실습">GAN 실습</h2>
<section id="단계-8" class="level3">
<h3 class="anchored" data-anchor-id="단계-8">1단계</h3>
<div class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>path <span class="op">=</span> untar_data(URLs.MNIST_SAMPLE)</span></code></pre></div>
</div>
<div class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>DataBlock??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Init signature:</span>
DataBlock<span class="ansi-blue-fg">(</span>
    blocks<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dl_type<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    getters<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    n_inp<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    item_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    batch_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    <span class="ansi-blue-fg">*</span><span class="ansi-blue-fg">,</span>
    get_items<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    splitter<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    get_y<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    get_x<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>        
<span class="ansi-green-fg">class</span> DataBlock<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"Generic container to quickly build `Datasets` and `DataLoaders`"</span>
    get_x<span class="ansi-blue-fg">=</span>get_items<span class="ansi-blue-fg">=</span>splitter<span class="ansi-blue-fg">=</span>get_y <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">None</span>
    blocks<span class="ansi-blue-fg">,</span>dl_type <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>TransformBlock<span class="ansi-blue-fg">,</span>TransformBlock<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>TfmdDL
    _methods <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'get_items splitter get_y get_x'</span><span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
    _msg <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">"If you wanted to compose several transforms in your getter don't forget to wrap them in a `Pipeline`."</span>
    <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> blocks<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> dl_type<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> getters<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> n_inp<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> item_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> batch_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        blocks <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>blocks <span class="ansi-green-fg">if</span> blocks <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> blocks<span class="ansi-blue-fg">)</span>
        blocks <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">if</span> callable<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> b <span class="ansi-green-fg">for</span> b <span class="ansi-green-fg">in</span> blocks<span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>type_tfms <span class="ansi-blue-fg">=</span> blocks<span class="ansi-blue-fg">.</span>attrgot<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'type_tfms'</span><span class="ansi-blue-fg">,</span> L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>default_item_tfms  <span class="ansi-blue-fg">=</span> _merge_tfms<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>blocks<span class="ansi-blue-fg">.</span>attrgot<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'item_tfms'</span><span class="ansi-blue-fg">,</span>  L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>default_batch_tfms <span class="ansi-blue-fg">=</span> _merge_tfms<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>blocks<span class="ansi-blue-fg">.</span>attrgot<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'batch_tfms'</span><span class="ansi-blue-fg">,</span> L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">for</span> b <span class="ansi-green-fg">in</span> blocks<span class="ansi-blue-fg">:</span>
            <span class="ansi-green-fg">if</span> getattr<span class="ansi-blue-fg">(</span>b<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'dl_type'</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>dl_type <span class="ansi-blue-fg">=</span> b<span class="ansi-blue-fg">.</span>dl_type
        <span class="ansi-green-fg">if</span> dl_type <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> self<span class="ansi-blue-fg">.</span>dl_type <span class="ansi-blue-fg">=</span> dl_type
        self<span class="ansi-blue-fg">.</span>dataloaders <span class="ansi-blue-fg">=</span> delegates<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dl_type<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>dataloaders<span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>dls_kwargs <span class="ansi-blue-fg">=</span> merge<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>blocks<span class="ansi-blue-fg">.</span>attrgot<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'dls_kwargs'</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">}</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>n_inp <span class="ansi-blue-fg">=</span> ifnone<span class="ansi-blue-fg">(</span>n_inp<span class="ansi-blue-fg">,</span> max<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> len<span class="ansi-blue-fg">(</span>blocks<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>getters <span class="ansi-blue-fg">=</span> ifnone<span class="ansi-blue-fg">(</span>getters<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">[</span>noop<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">*</span>len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>type_tfms<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>get_x<span class="ansi-blue-fg">:</span>
            <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>get_x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">!=</span> self<span class="ansi-blue-fg">.</span>n_inp<span class="ansi-blue-fg">:</span>
                <span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f'get_x contains {len(L(self.get_x))} functions, but must contain {self.n_inp} (one for each input)\n{self._msg}'</span><span class="ansi-blue-fg">)</span>
            self<span class="ansi-blue-fg">.</span>getters<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span>self<span class="ansi-blue-fg">.</span>n_inp<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>get_x<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>get_y<span class="ansi-blue-fg">:</span>
            n_targs <span class="ansi-blue-fg">=</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>getters<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">-</span> self<span class="ansi-blue-fg">.</span>n_inp
            <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>get_y<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">!=</span> n_targs<span class="ansi-blue-fg">:</span>
                <span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f'get_y contains {len(L(self.get_y))} functions, but must contain {n_targs} (one for each target)\n{self._msg}'</span><span class="ansi-blue-fg">)</span>
            self<span class="ansi-blue-fg">.</span>getters<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>n_inp<span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>get_y<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">if</span> kwargs<span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f'invalid keyword arguments: {", ".join(kwargs.keys())}'</span><span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>new<span class="ansi-blue-fg">(</span>item_tfms<span class="ansi-blue-fg">,</span> batch_tfms<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">def</span> _combine_type_tfms<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span> <span class="ansi-green-fg">return</span> L<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>getters<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>type_tfms<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>map_zip<span class="ansi-blue-fg">(</span>
        <span class="ansi-green-fg">lambda</span> g<span class="ansi-blue-fg">,</span>tt<span class="ansi-blue-fg">:</span> <span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">.</span>fs <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">,</span> Pipeline<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">else</span> L<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> tt<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">def</span> new<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> item_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> batch_tfms<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        self<span class="ansi-blue-fg">.</span>item_tfms  <span class="ansi-blue-fg">=</span> _merge_tfms<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>default_item_tfms<span class="ansi-blue-fg">,</span>  item_tfms<span class="ansi-blue-fg">)</span>
        self<span class="ansi-blue-fg">.</span>batch_tfms <span class="ansi-blue-fg">=</span> _merge_tfms<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>default_batch_tfms<span class="ansi-blue-fg">,</span> batch_tfms<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> self
    <span class="ansi-blue-fg">@</span>classmethod
    <span class="ansi-green-fg">def</span> from_columns<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> blocks<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> getters<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> get_items<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        <span class="ansi-green-fg">if</span> getters <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> getters <span class="ansi-blue-fg">=</span> L<span class="ansi-blue-fg">(</span>ItemGetter<span class="ansi-blue-fg">(</span>i<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">2</span> <span class="ansi-green-fg">if</span> blocks <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> len<span class="ansi-blue-fg">(</span>L<span class="ansi-blue-fg">(</span>blocks<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        get_items <span class="ansi-blue-fg">=</span> _zip <span class="ansi-green-fg">if</span> get_items <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">else</span> compose<span class="ansi-blue-fg">(</span>get_items<span class="ansi-blue-fg">,</span> _zip<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">(</span>blocks<span class="ansi-blue-fg">=</span>blocks<span class="ansi-blue-fg">,</span> getters<span class="ansi-blue-fg">=</span>getters<span class="ansi-blue-fg">,</span> get_items<span class="ansi-blue-fg">=</span>get_items<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">def</span> datasets<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        self<span class="ansi-blue-fg">.</span>source <span class="ansi-blue-fg">=</span> source                     <span class="ansi-blue-fg">;</span> pv<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f"Collecting items from {source}"</span><span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">)</span>
        items <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>get_items <span class="ansi-green-fg">or</span> noop<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>source<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">;</span> pv<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f"Found {len(items)} items"</span><span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">)</span>
        splits <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>splitter <span class="ansi-green-fg">or</span> RandomSplitter<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">)</span>
        pv<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f"{len(splits)} datasets of sizes {','.join([str(len(s)) for s in splits])}"</span><span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> Datasets<span class="ansi-blue-fg">(</span>items<span class="ansi-blue-fg">,</span> tfms<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>_combine_type_tfms<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> splits<span class="ansi-blue-fg">=</span>splits<span class="ansi-blue-fg">,</span> dl_type<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>dl_type<span class="ansi-blue-fg">,</span> n_inp<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>n_inp<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span>verbose<span class="ansi-blue-fg">)</span>
    <span class="ansi-green-fg">def</span> dataloaders<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">,</span> path<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'.'</span><span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        dsets <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>datasets<span class="ansi-blue-fg">(</span>source<span class="ansi-blue-fg">,</span> verbose<span class="ansi-blue-fg">=</span>verbose<span class="ansi-blue-fg">)</span>
        kwargs <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">{</span><span class="ansi-blue-fg">**</span>self<span class="ansi-blue-fg">.</span>dls_kwargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'verbose'</span><span class="ansi-blue-fg">:</span> verbose<span class="ansi-blue-fg">}</span>
        <span class="ansi-green-fg">return</span> dsets<span class="ansi-blue-fg">.</span>dataloaders<span class="ansi-blue-fg">(</span>path<span class="ansi-blue-fg">=</span>path<span class="ansi-blue-fg">,</span> after_item<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>item_tfms<span class="ansi-blue-fg">,</span> after_batch<span class="ansi-blue-fg">=</span>self<span class="ansi-blue-fg">.</span>batch_tfms<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
    _docs <span class="ansi-blue-fg">=</span> dict<span class="ansi-blue-fg">(</span>new<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">"Create a new `DataBlock` with other `item_tfms` and `batch_tfms`"</span><span class="ansi-blue-fg">,</span>
                 datasets<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">"Create a `Datasets` object from `source`"</span><span class="ansi-blue-fg">,</span>
                 dataloaders<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">"Create a `DataLoaders` object from `source`"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>           ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/data/block.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>     
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>TransformBlock</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>fastai.data.block.TransformBlock</code></pre>
</div>
</div>
<div class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>ImageBlock</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>&lt;function fastai.vision.data.ImageBlock(cls=&lt;class 'fastai.vision.core.PILImage'&gt;)&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>generate_noise</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>&lt;function fastai.vision.gan.generate_noise(fn, size=100)&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>dblock <span class="op">=</span> DataBlock(blocks<span class="op">=</span>(TransformBlock,ImageBlock),</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>          get_x <span class="op">=</span> generate_noise,</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>          get_items<span class="op">=</span>get_image_files,</span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>          item_tfms<span class="op">=</span>Resize(<span class="dv">32</span>))</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>dls <span class="op">=</span> dblock.dataloaders(path) </span></code></pre></div>
</div>
<div class="cell" data-outputid="f186b17a-866e-4411-943e-77b8f1ea3b09" data-execution_count="80">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>dls.show_batch()</span></code></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-72-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="단계-9" class="level3">
<h3 class="anchored" data-anchor-id="단계-9">2단계</h3>
<div class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>basic_generator??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
basic_generator<span class="ansi-blue-fg">(</span>
    out_size<span class="ansi-blue-fg">,</span>
    n_channels<span class="ansi-blue-fg">,</span>
    in_sz<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">,</span>
    n_features<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span>
    n_extra_layers<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>
    ks<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span>
    stride<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    padding<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    ndim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span>
    norm_type<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>NormType<span class="ansi-blue-fg">.</span>Batch<span class="ansi-blue-fg">:</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    bn_1st<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    act_cls<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span><span class="ansi-green-fg">class</span> <span class="ansi-blue-fg">'torch.nn.modules.activation.ReLU'</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    transpose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    init<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'auto'</span><span class="ansi-blue-fg">,</span>
    xtra<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    bias_std<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.01</span><span class="ansi-blue-fg">,</span>
    dilation<span class="ansi-blue-fg">:</span> Union<span class="ansi-blue-fg">[</span>int<span class="ansi-blue-fg">,</span> Tuple<span class="ansi-blue-fg">[</span>int<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    groups<span class="ansi-blue-fg">:</span> int <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    padding_mode<span class="ansi-blue-fg">:</span> str <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'zeros'</span><span class="ansi-blue-fg">,</span>
    device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>ConvLayer<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">def</span> basic_generator<span class="ansi-blue-fg">(</span>out_size<span class="ansi-blue-fg">,</span> n_channels<span class="ansi-blue-fg">,</span> in_sz<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">,</span> n_features<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span> n_extra_layers<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"A basic generator from `in_sz` to images `n_channels` x `out_size` x `out_size`."</span>
    cur_size<span class="ansi-blue-fg">,</span> cur_ftrs <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> n_features<span class="ansi-blue-fg">//</span><span class="ansi-cyan-fg">2</span>
    <span class="ansi-green-fg">while</span> cur_size <span class="ansi-blue-fg">&lt;</span> out_size<span class="ansi-blue-fg">:</span>  cur_size <span class="ansi-blue-fg">*=</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">;</span> cur_ftrs <span class="ansi-blue-fg">*=</span> <span class="ansi-cyan-fg">2</span>
    layers <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>AddChannels<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> ConvLayer<span class="ansi-blue-fg">(</span>in_sz<span class="ansi-blue-fg">,</span> cur_ftrs<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> transpose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
    cur_size <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">4</span>
    <span class="ansi-green-fg">while</span> cur_size <span class="ansi-blue-fg">&lt;</span> out_size <span class="ansi-blue-fg">//</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">:</span>
        layers<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>ConvLayer<span class="ansi-blue-fg">(</span>cur_ftrs<span class="ansi-blue-fg">,</span> cur_ftrs<span class="ansi-blue-fg">//</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> transpose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        cur_ftrs <span class="ansi-blue-fg">//=</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">;</span> cur_size <span class="ansi-blue-fg">*=</span> <span class="ansi-cyan-fg">2</span>
    layers <span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">[</span>ConvLayer<span class="ansi-blue-fg">(</span>cur_ftrs<span class="ansi-blue-fg">,</span> cur_ftrs<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> transpose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> _ <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>n_extra_layers<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
    layers <span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">[</span>nn<span class="ansi-blue-fg">.</span>ConvTranspose2d<span class="ansi-blue-fg">(</span>cur_ftrs<span class="ansi-blue-fg">,</span> n_channels<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> nn<span class="ansi-blue-fg">.</span>Tanh<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
    <span class="ansi-green-fg">return</span> nn<span class="ansi-blue-fg">.</span>Sequential<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>layers<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/vision/gan.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>basic_critic??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
basic_critic<span class="ansi-blue-fg">(</span>
    in_size<span class="ansi-blue-fg">,</span>
    n_channels<span class="ansi-blue-fg">,</span>
    n_features<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span>
    n_extra_layers<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span>
    norm_type<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>NormType<span class="ansi-blue-fg">.</span>Batch<span class="ansi-blue-fg">:</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    ks<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span>
    stride<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    padding<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    ndim<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span>
    bn_1st<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    act_cls<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span><span class="ansi-green-fg">class</span> <span class="ansi-blue-fg">'torch.nn.modules.activation.ReLU'</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    transpose<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    init<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'auto'</span><span class="ansi-blue-fg">,</span>
    xtra<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    bias_std<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.01</span><span class="ansi-blue-fg">,</span>
    dilation<span class="ansi-blue-fg">:</span> Union<span class="ansi-blue-fg">[</span>int<span class="ansi-blue-fg">,</span> Tuple<span class="ansi-blue-fg">[</span>int<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    groups<span class="ansi-blue-fg">:</span> int <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span>
    padding_mode<span class="ansi-blue-fg">:</span> str <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">'zeros'</span><span class="ansi-blue-fg">,</span>
    device<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
<span class="ansi-blue-fg">@</span>delegates<span class="ansi-blue-fg">(</span>ConvLayer<span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">def</span> basic_critic<span class="ansi-blue-fg">(</span>in_size<span class="ansi-blue-fg">,</span> n_channels<span class="ansi-blue-fg">,</span> n_features<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">64</span><span class="ansi-blue-fg">,</span> n_extra_layers<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span> norm_type<span class="ansi-blue-fg">=</span>NormType<span class="ansi-blue-fg">.</span>Batch<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
    <span class="ansi-blue-fg">"A basic critic for images `n_channels` x `in_size` x `in_size`."</span>
    layers <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span>ConvLayer<span class="ansi-blue-fg">(</span>n_channels<span class="ansi-blue-fg">,</span> n_features<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> norm_type<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
    cur_size<span class="ansi-blue-fg">,</span> cur_ftrs <span class="ansi-blue-fg">=</span> in_size<span class="ansi-blue-fg">//</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> n_features
    layers <span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">[</span>ConvLayer<span class="ansi-blue-fg">(</span>cur_ftrs<span class="ansi-blue-fg">,</span> cur_ftrs<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> norm_type<span class="ansi-blue-fg">=</span>norm_type<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">for</span> _ <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>n_extra_layers<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
    <span class="ansi-green-fg">while</span> cur_size <span class="ansi-blue-fg">&gt;</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">:</span>
        layers<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>ConvLayer<span class="ansi-blue-fg">(</span>cur_ftrs<span class="ansi-blue-fg">,</span> cur_ftrs<span class="ansi-blue-fg">*</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> norm_type<span class="ansi-blue-fg">=</span>norm_type<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
        cur_ftrs <span class="ansi-blue-fg">*=</span> <span class="ansi-cyan-fg">2</span> <span class="ansi-blue-fg">;</span> cur_size <span class="ansi-blue-fg">//=</span> <span class="ansi-cyan-fg">2</span>
    init <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">.</span>get<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'init'</span><span class="ansi-blue-fg">,</span> nn<span class="ansi-blue-fg">.</span>init<span class="ansi-blue-fg">.</span>kaiming_normal_<span class="ansi-blue-fg">)</span>
    layers <span class="ansi-blue-fg">+=</span> <span class="ansi-blue-fg">[</span>init_default<span class="ansi-blue-fg">(</span>nn<span class="ansi-blue-fg">.</span>Conv2d<span class="ansi-blue-fg">(</span>cur_ftrs<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> padding<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> init<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> Flatten<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span>
    <span class="ansi-green-fg">return</span> nn<span class="ansi-blue-fg">.</span>Sequential<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>layers<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/vision/gan.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>counterfeiter <span class="op">=</span> basic_generator(<span class="dv">32</span>,n_channels<span class="op">=</span><span class="dv">3</span>,n_extra_layers<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>police <span class="op">=</span> basic_critic(<span class="dv">32</span>,n_channels<span class="op">=</span><span class="dv">3</span>,n_extra_layers<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<ul>
<li>32는 사이즈</li>
<li>채널은 컬러이면 3이지만 이건 흑백이라도 3으로 표현해봄</li>
</ul>
<div class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>GANLearner.wgan??</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
GANLearner<span class="ansi-blue-fg">.</span>wgan<span class="ansi-blue-fg">(</span>
    dls<span class="ansi-blue-fg">,</span>
    generator<span class="ansi-blue-fg">,</span>
    critic<span class="ansi-blue-fg">,</span>
    switcher<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    clip<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.01</span><span class="ansi-blue-fg">,</span>
    switch_eval<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    gen_first<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    show_img<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    cbs<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    metrics<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    loss_func<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    opt_func<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function Adam at <span class="ansi-cyan-fg">0x7fcb70042550</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    lr<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.001</span><span class="ansi-blue-fg">,</span>
    splitter<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>function trainable_params at <span class="ansi-cyan-fg">0x7fcb79d04940</span><span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    path<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    model_dir<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'models'</span><span class="ansi-blue-fg">,</span>
    wd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    wd_bn_bias<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span>
    train_bn<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span>
    moms<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.85</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0.95</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Source:</span>   
    <span class="ansi-blue-fg">@</span>classmethod
    <span class="ansi-green-fg">def</span> wgan<span class="ansi-blue-fg">(</span>cls<span class="ansi-blue-fg">,</span> dls<span class="ansi-blue-fg">,</span> generator<span class="ansi-blue-fg">,</span> critic<span class="ansi-blue-fg">,</span> switcher<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> clip<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.01</span><span class="ansi-blue-fg">,</span> switch_eval<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
        <span class="ansi-blue-fg">"Create a WGAN from `data`, `generator` and `critic`."</span>
        <span class="ansi-green-fg">if</span> switcher <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span> switcher <span class="ansi-blue-fg">=</span> FixedGANSwitcher<span class="ansi-blue-fg">(</span>n_crit<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">,</span> n_gen<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>
        <span class="ansi-green-fg">return</span> cls<span class="ansi-blue-fg">(</span>dls<span class="ansi-blue-fg">,</span> generator<span class="ansi-blue-fg">,</span> critic<span class="ansi-blue-fg">,</span> _tk_mean<span class="ansi-blue-fg">,</span> _tk_diff<span class="ansi-blue-fg">,</span> switcher<span class="ansi-blue-fg">=</span>switcher<span class="ansi-blue-fg">,</span> clip<span class="ansi-blue-fg">=</span>clip<span class="ansi-blue-fg">,</span> switch_eval<span class="ansi-blue-fg">=</span>switch_eval<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/vision/gan.py
<span class="ansi-red-fg">Type:</span>      method
</pre>
</div>
</div>
</div>
<div class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>lrnr <span class="op">=</span> GANLearner.wgan(dls,counterfeiter,police) </span></code></pre></div>
</div>
</section>
<section id="단계-10" class="level3">
<h3 class="anchored" data-anchor-id="단계-10">3단계</h3>
<p><code>-</code> lrnr.fit(10) 진행</p>
<div class="cell" data-outputid="2e85733d-a1ff-4753-efb3-70a7ad590177" data-execution_count="92">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/csy/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/callback/core.py:51: UserWarning: You are shadowing an attribute (generator) that exists in the learner. Use `self.learn.generator` to avoid this
  warn(f"You are shadowing an attribute ({name}) that exists in the learner. Use `self.learn.{name}` to avoid this")
/home/csy/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/callback/core.py:51: UserWarning: You are shadowing an attribute (critic) that exists in the learner. Use `self.learn.critic` to avoid this
  warn(f"You are shadowing an attribute ({name}) that exists in the learner. Use `self.learn.{name}` to avoid this")
/home/csy/anaconda3/envs/csy/lib/python3.8/site-packages/fastai/callback/core.py:51: UserWarning: You are shadowing an attribute (gen_mode) that exists in the learner. Use `self.learn.gen_mode` to avoid this
  warn(f"You are shadowing an attribute ({name}) that exists in the learner. Use `self.learn.{name}` to avoid this")</code></pre>
</div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>gen_loss</th>
      <th>crit_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.543594</td>
      <td>0.420719</td>
      <td>0.420719</td>
      <td>-0.754515</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.578704</td>
      <td>0.376830</td>
      <td>0.376830</td>
      <td>-0.759121</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-0.581667</td>
      <td>0.335058</td>
      <td>0.335058</td>
      <td>-0.765852</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-0.581913</td>
      <td>0.350422</td>
      <td>0.350422</td>
      <td>-0.766256</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-0.576919</td>
      <td>0.239790</td>
      <td>0.239790</td>
      <td>-0.757070</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-0.568187</td>
      <td>0.165856</td>
      <td>0.165856</td>
      <td>-0.738596</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.561763</td>
      <td>0.312277</td>
      <td>0.312277</td>
      <td>-0.738768</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.545816</td>
      <td>0.312626</td>
      <td>0.312626</td>
      <td>-0.735054</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-0.530404</td>
      <td>0.315626</td>
      <td>0.315626</td>
      <td>-0.713279</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.552664</td>
      <td>0.292665</td>
      <td>0.292665</td>
      <td>-0.719266</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-outputid="c7ae6d00-3a38-4d74-9cdd-d4a653989c4c" data-execution_count="93">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>lrnr.show_results()</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-79-output-2.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> lrnr.fit(10) 추가로 진행 // 총20회</p>
<div class="cell" data-outputid="7e5084df-075f-40f2-9a2d-44408e9d74ef" data-execution_count="94">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>gen_loss</th>
      <th>crit_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.534434</td>
      <td>0.329432</td>
      <td>0.329432</td>
      <td>-0.738360</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.491044</td>
      <td>0.241687</td>
      <td>0.241687</td>
      <td>-0.282900</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-0.430823</td>
      <td>0.247032</td>
      <td>0.247032</td>
      <td>-0.631827</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-0.509287</td>
      <td>0.228638</td>
      <td>0.228638</td>
      <td>-0.702186</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-0.541639</td>
      <td>0.306787</td>
      <td>0.306787</td>
      <td>-0.737486</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-0.490239</td>
      <td>0.270219</td>
      <td>0.270219</td>
      <td>-0.686973</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.456657</td>
      <td>0.370165</td>
      <td>0.370165</td>
      <td>-0.651278</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.375928</td>
      <td>0.254674</td>
      <td>0.254674</td>
      <td>-0.463629</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-0.505262</td>
      <td>0.241540</td>
      <td>0.241540</td>
      <td>-0.706440</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.511837</td>
      <td>0.264010</td>
      <td>0.264010</td>
      <td>-0.717528</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-outputid="90c60e35-858d-41e4-a70a-c17fdf333beb" data-execution_count="95">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>lrnr.show_results()</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-81-output-2.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> lrnr.fit(10) 추가로 진행 // 총30회</p>
<div class="cell" data-outputid="27504e08-5427-4f6d-8898-30953e8cb374" data-execution_count="96">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>gen_loss</th>
      <th>crit_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.389076</td>
      <td>0.203898</td>
      <td>0.203898</td>
      <td>-0.610006</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.404953</td>
      <td>0.248211</td>
      <td>0.248211</td>
      <td>-0.564691</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-0.399689</td>
      <td>0.157126</td>
      <td>0.157126</td>
      <td>-0.475484</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-0.412959</td>
      <td>0.160083</td>
      <td>0.160083</td>
      <td>-0.628447</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-0.419133</td>
      <td>0.140253</td>
      <td>0.140253</td>
      <td>-0.315640</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-0.412665</td>
      <td>0.360084</td>
      <td>0.360084</td>
      <td>-0.504751</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.419645</td>
      <td>0.331901</td>
      <td>0.331901</td>
      <td>-0.627747</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.393825</td>
      <td>0.099620</td>
      <td>0.099620</td>
      <td>-0.479805</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-0.383802</td>
      <td>0.332651</td>
      <td>0.332651</td>
      <td>-0.485545</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.329964</td>
      <td>0.066743</td>
      <td>0.066743</td>
      <td>-0.331843</td>
      <td>00:04</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-outputid="5f08d96d-dc87-45b6-9556-c16695667714" data-execution_count="97">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>lrnr.show_results()</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-83-output-2.png" class="img-fluid"></p>
</div>
</div>
<p><code>-</code> lrnr.fit(10) 추가로 진행 // 총 60회</p>
<div class="cell" data-outputid="27504e08-5427-4f6d-8898-30953e8cb374" data-execution_count="98">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>lrnr.fit(<span class="dv">30</span>)</span></code></pre></div>
<div class="cell-output cell-output-display">

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>gen_loss</th>
      <th>crit_loss</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.280188</td>
      <td>0.083489</td>
      <td>0.083489</td>
      <td>-0.421842</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.211743</td>
      <td>0.066232</td>
      <td>0.066232</td>
      <td>-0.485185</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>2</td>
      <td>-0.548622</td>
      <td>0.439374</td>
      <td>0.439374</td>
      <td>-0.729976</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>3</td>
      <td>-0.184136</td>
      <td>0.166024</td>
      <td>0.166024</td>
      <td>-0.196536</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-0.180048</td>
      <td>0.283176</td>
      <td>0.283176</td>
      <td>-0.343643</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-0.082062</td>
      <td>-0.111767</td>
      <td>-0.111767</td>
      <td>-0.232821</td>
      <td>00:06</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.134064</td>
      <td>-0.252754</td>
      <td>-0.252754</td>
      <td>-0.056792</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.024693</td>
      <td>-0.019944</td>
      <td>-0.019944</td>
      <td>-0.060462</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>8</td>
      <td>-0.067052</td>
      <td>-0.176633</td>
      <td>-0.176633</td>
      <td>-0.087246</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>9</td>
      <td>-0.051849</td>
      <td>0.077216</td>
      <td>0.077216</td>
      <td>-0.063890</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>10</td>
      <td>-0.062414</td>
      <td>0.576616</td>
      <td>0.576616</td>
      <td>0.007565</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>11</td>
      <td>-0.028339</td>
      <td>-0.177623</td>
      <td>-0.177623</td>
      <td>-0.165999</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>12</td>
      <td>-0.285967</td>
      <td>0.256777</td>
      <td>0.256777</td>
      <td>-0.486597</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>13</td>
      <td>-0.040034</td>
      <td>0.200722</td>
      <td>0.200722</td>
      <td>-0.002714</td>
      <td>00:05</td>
    </tr>
    <tr>
      <td>14</td>
      <td>-0.082319</td>
      <td>-0.218245</td>
      <td>-0.218245</td>
      <td>-0.076548</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>15</td>
      <td>-0.126090</td>
      <td>-0.120631</td>
      <td>-0.120631</td>
      <td>-0.311712</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>16</td>
      <td>-0.120472</td>
      <td>0.024194</td>
      <td>0.024194</td>
      <td>-0.165129</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>17</td>
      <td>-0.213207</td>
      <td>0.447029</td>
      <td>0.447029</td>
      <td>-0.441171</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>18</td>
      <td>-0.104892</td>
      <td>0.076353</td>
      <td>0.076353</td>
      <td>-0.305898</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>19</td>
      <td>-0.077636</td>
      <td>-0.229590</td>
      <td>-0.229590</td>
      <td>-0.206540</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>20</td>
      <td>-0.037347</td>
      <td>-0.169197</td>
      <td>-0.169197</td>
      <td>-0.070061</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>21</td>
      <td>-0.063813</td>
      <td>-0.283316</td>
      <td>-0.283316</td>
      <td>0.009801</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>22</td>
      <td>-0.037806</td>
      <td>-0.101751</td>
      <td>-0.101751</td>
      <td>-0.020896</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>23</td>
      <td>-0.057209</td>
      <td>-0.012665</td>
      <td>-0.012665</td>
      <td>-0.095574</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>24</td>
      <td>-0.036946</td>
      <td>0.090177</td>
      <td>0.090177</td>
      <td>-0.049521</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>25</td>
      <td>-0.050363</td>
      <td>-0.206716</td>
      <td>-0.206716</td>
      <td>-0.035576</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>26</td>
      <td>-0.047856</td>
      <td>0.052171</td>
      <td>0.052171</td>
      <td>-0.017636</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>27</td>
      <td>-0.009292</td>
      <td>-0.027788</td>
      <td>-0.027788</td>
      <td>-0.003629</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>28</td>
      <td>-0.032223</td>
      <td>-0.223866</td>
      <td>-0.223866</td>
      <td>-0.011261</td>
      <td>00:04</td>
    </tr>
    <tr>
      <td>29</td>
      <td>-0.028316</td>
      <td>-0.006388</td>
      <td>-0.006388</td>
      <td>-0.024545</td>
      <td>00:05</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="cell" data-outputid="5f08d96d-dc87-45b6-9556-c16695667714" data-execution_count="99">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>lrnr.show_results()</span></code></pre></div>
<div class="cell-output cell-output-display">

</div>
<div class="cell-output cell-output-display">
<p><img src="2022-09-14-ml_2w_files/figure-html/cell-85-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="단계-없음" class="level3">
<h3 class="anchored" data-anchor-id="단계-없음">4단계 (없음)</h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>